<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-type" content="text/html; charset=ISO-8859-1" />
<link rel="stylesheet" href="./robodoc.css" type="text/css" />
<title>./src/json_module.f90</title>
<!-- Source: ./src/json_module.f90 -->
<!-- Generated with ROBODoc Version 4.99.38 (Jun 13 2014) -->
</head>
<body>
<div id="logo">
<a name="robo_top_of_doc">jsonfortran</a>
</div> <!-- logo -->
<div id="navigation">
<a class="menuitem" href="./toc_index.html#top">Table of Contents</a>
<a class="menuitem" href="./robo_sourcefiles.html#top">Sourcefiles</a>
<a class="menuitem" href="./masterindex.html#top">Index</a>
<a class="menuitem" href="./robo_classes.html#top">Classes</a>
<a class="menuitem" href="./robo_functions.html#top">Functions</a>
<a class="menuitem" href="./robo_modules.html#top">Modules</a>
<a class="menuitem" href="./robo_unittests.html#top">Unittest</a>
</div> <!-- navigation -->
<div id="content">
<hr />
<a name="JSON2fjson5fmodule"></a>
<a name="robo0"></a><h2>JSON/json_module [ Modules ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="./robo_modules.html#robo_top_of_doc">Modules</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_module</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    JSON-FORTRAN: A Fortran 2008 JSON (JavaScript Object Notation) API.
</pre>
<p class="item_name">NOTES</p>
<pre>    -Based on fson by Joseph A. Levin (see License below)
        -The original F95 code was split into four files:
            fson_path_m.f95, fson_string_m.f95, fson_value_m.f95, fson.f95
        -The code has been extensively modified and combined into this 
            one module (<a href="#robo_top_of_doc">json_module.f90</a>).
        -Some Fortran 2003/2008 features are now used 
            (e.g., allocatable strings, associate, newunit, generic, class, 
            and abstract interface)
    -The headers in this file follow the ROBODoc conventions.
            Compile with: robodoc --src ./ --doc ./doc --multidoc --html 
                                  --tabsize 4 --ignore_case_when_linking 
                                  --syntaxcolors --source_line_numbers --index
</pre>
<p class="item_name">HISTORY</p>
<pre>    Joseph A. Levin : March 2012
    Jacob Williams : 2/8/2013 : Extensive modifications to the original code.
</pre>
<p class="item_name">SEE ALSO</p>
<pre>    [1] <a href="http://github.com/jacobwilliams/json-fortran">http://github.com/jacobwilliams/json-fortran</a> [json-fortran development site]
    [2] <a href="http://jacobwilliams.github.io/json-fortran">http://jacobwilliams.github.io/json-fortran</a> [json-fortran online documentation]
    [3] <a href="http://www.json.org/">http://www.json.org/</a> [JSON website]
    [4] <a href="http://jsonlint.com/">http://jsonlint.com/</a> [JSON validator]
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    -------------------------------------------------------------------------------------
    json-fortran License:

    JSON-FORTRAN: A Fortran 2008 JSON API
    <a href="http://github.com/jacobwilliams/json-fortran">http://github.com/jacobwilliams/json-fortran</a>

    Copyright (c) 2014, Jacob Williams
    All rights reserved.

    Redistribution and use in source and binary forms, with or without modification,
    are permitted provided that the following conditions are met:

    * Redistributions of source code must retain the above copyright notice, this
      list of conditions and the following disclaimer.

    * Redistributions in binary form must reproduce the above copyright notice, this
      list of conditions and the following disclaimer in the documentation and/or
      other materials provided with the distribution.

    * The names of its contributors may not be used to endorse or promote products 
      derived from this software without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
    ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
    WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
    DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
    ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
    (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
    LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
    ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

    -------------------------------------------------------------------------------------
    Original FSON License:

    <a href="http://github.com/josephalevin/fson">http://github.com/josephalevin/fson</a> [FSON code retrieved on 12/2/2013]

    Copyright (c) 2012 Joseph A. Levin

    Permission is hereby granted, free of charge, to any person obtaining a copy of this
    software and associated documentation files (the "Software"), to deal in the Software
    without restriction, including without limitation the rights to use, copy, modify, merge,
    publish, distribute, sublicense, and/or sell copies of the Software, and to permit
    persons to whom the Software is furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all copies or
    substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,
    INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR
    PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
    LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT
    OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
    DEALINGS IN THE SOFTWARE.
</pre>

<hr />
<a name="json5fmodule2fdestroy5fjson5fdata5fnon5fpolymorphic"></a>
<a name="robo2"></a><h2>json_module/destroy_json_data_non_polymorphic [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>destroy_json_data_non_polymorphic</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%destroy()
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Destroy the nonpolymorphic data type.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">442 </span>    subroutine <strong>destroy_json_data_non_polymorphic</strong><span class="sign">(</span>me<span class="sign">)</span>
<span class="line_number">443 </span>
<span class="line_number">444 </span>    implicit none
<span class="line_number">445 </span>
<span class="line_number">446 </span>    class<span class="sign">(</span>json_data_non_polymorphic<span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">447 </span>
<span class="line_number">448 </span>    me<span class="sign">%</span>var_type <span class="sign">=</span> 0
<span class="line_number">449 </span>
<span class="line_number">450 </span>    if <span class="sign">(</span>allocated<span class="sign">(</span>me<span class="sign">%</span>log_value<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>me<span class="sign">%</span>log_value<span class="sign">)</span>
<span class="line_number">451 </span>    if <span class="sign">(</span>allocated<span class="sign">(</span>me<span class="sign">%</span>int_value<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>me<span class="sign">%</span>int_value<span class="sign">)</span>
<span class="line_number">452 </span>    if <span class="sign">(</span>allocated<span class="sign">(</span>me<span class="sign">%</span>dbl_value<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>me<span class="sign">%</span>dbl_value<span class="sign">)</span>
<span class="line_number">453 </span>    if <span class="sign">(</span>allocated<span class="sign">(</span>me<span class="sign">%</span>str_value<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>me<span class="sign">%</span>str_value<span class="sign">)</span>
<span class="line_number">454 </span>
<span class="line_number">455 </span>    end subroutine <strong>destroy_json_data_non_polymorphic</strong>
</pre>

<hr />
<a name="json5fmodule2fdestroy5fjson5ffile"></a>
<a name="robo3"></a><h2>json_module/destroy_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>destroy_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%destroy()
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Destroy the JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/9/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">475 </span>    subroutine <strong>destroy_json_file</strong><span class="sign">(</span>me<span class="sign">)</span>
<span class="line_number">476 </span>    
<span class="line_number">477 </span>    implicit none
<span class="line_number">478 </span>
<span class="line_number">479 </span>    class<span class="sign">(</span><a href="#robo21">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">480 </span>
<span class="line_number">481 </span>    if <span class="sign">(</span>associated<span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">)</span><span class="sign">)</span> call <a href="#robo57">json_value_destroy</a><span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">)</span>
<span class="line_number">482 </span>
<span class="line_number">483 </span>    end subroutine <strong>destroy_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fescape5fstring"></a>
<a name="robo4"></a><h2>json_module/escape_string [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>escape_string</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Add the escape characters to a string for adding to JSON.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/21/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1873 </span>    subroutine <strong>escape_string</strong><span class="sign">(</span>str_in<span class="sign">,</span> str_out<span class="sign">)</span>
<span class="line_number">1874 </span>
<span class="line_number">1875 </span>    implicit none
<span class="line_number">1876 </span>
<span class="line_number">1877 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>              <span class="sign">:</span><span class="sign">:</span> str_in
<span class="line_number">1878 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> str_out
<span class="line_number">1879 </span>
<span class="line_number">1880 </span>    integer <span class="sign">:</span><span class="sign">:</span> i
<span class="line_number">1881 </span>    character<span class="sign">(</span>len<span class="sign">=</span>1<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> c
<span class="line_number">1882 </span>
<span class="line_number">1883 </span>    str_out <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">1884 </span>
<span class="line_number">1885 </span>    <span class="sign">!</span>go through the string and look for special characters<span class="sign">:</span>
<span class="line_number">1886 </span>    do i<span class="sign">=</span>1<span class="sign">,</span>len<span class="sign">(</span>str_in<span class="sign">)</span>
<span class="line_number">1887 </span>
<span class="line_number">1888 </span>        c <span class="sign">=</span> str_in<span class="sign">(</span>i<span class="sign">:</span>i<span class="sign">)</span>    <span class="sign">!</span>get next character in the input string
<span class="line_number">1889 </span>             
<span class="line_number">1890 </span>        select case<span class="sign">(</span>c<span class="sign">)</span>
<span class="line_number">1891 </span>        case<span class="sign">(</span>quotation_mark<span class="sign">,</span>backslash<span class="sign">,</span>slash<span class="sign">)</span>
<span class="line_number">1892 </span>            str_out <span class="sign">=</span> str_out<span class="sign">/</span><span class="sign">/</span>backslash<span class="sign">/</span><span class="sign">/</span>c
<span class="line_number">1893 </span>        case<span class="sign">(</span>bspace<span class="sign">)</span>
<span class="line_number">1894 </span>            str_out <span class="sign">=</span> str_out<span class="sign">/</span><span class="sign">/</span><span class="squote">'\b'</span>
<span class="line_number">1895 </span>        case<span class="sign">(</span>formfeed<span class="sign">)</span>
<span class="line_number">1896 </span>            str_out <span class="sign">=</span> str_out<span class="sign">/</span><span class="sign">/</span><span class="squote">'\f'</span>
<span class="line_number">1897 </span>        case<span class="sign">(</span>newline<span class="sign">)</span>
<span class="line_number">1898 </span>            str_out <span class="sign">=</span> str_out<span class="sign">/</span><span class="sign">/</span><span class="squote">'\n'</span>
<span class="line_number">1899 </span>        case<span class="sign">(</span>carriage_return<span class="sign">)</span>
<span class="line_number">1900 </span>            str_out <span class="sign">=</span> str_out<span class="sign">/</span><span class="sign">/</span><span class="squote">'\r'</span>
<span class="line_number">1901 </span>        case<span class="sign">(</span>horizontal_tab<span class="sign">)</span>
<span class="line_number">1902 </span>            str_out <span class="sign">=</span> str_out<span class="sign">/</span><span class="sign">/</span><span class="squote">'\t'</span>
<span class="line_number">1903 </span>        case default
<span class="line_number">1904 </span>            str_out <span class="sign">=</span> str_out<span class="sign">/</span><span class="sign">/</span>c
<span class="line_number">1905 </span>        end select
<span class="line_number">1906 </span>
<span class="line_number">1907 </span>    end do
<span class="line_number">1908 </span>
<span class="line_number">1909 </span>    end subroutine <strong>escape_string</strong>
</pre>

<hr />
<a name="json5fmodule2fget5fby5findex"></a>
<a name="robo5"></a><h2>json_module/get_by_index [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_by_index</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Returns a child in the object given the index.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2042 </span>    subroutine <strong>get_by_index</strong><span class="sign">(</span>this<span class="sign">,</span> idx<span class="sign">,</span> p<span class="sign">)</span>
<span class="line_number">2043 </span>
<span class="line_number">2044 </span>    implicit none
<span class="line_number">2045 </span>
<span class="line_number">2046 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">2047 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                  <span class="sign">:</span><span class="sign">:</span> idx
<span class="line_number">2048 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer           <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">2049 </span>
<span class="line_number">2050 </span>    integer <span class="sign">:</span><span class="sign">:</span> i
<span class="line_number">2051 </span>
<span class="line_number">2052 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">2053 </span>
<span class="line_number">2054 </span>        nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2055 </span>
<span class="line_number">2056 </span>        if <span class="sign">(</span>associated<span class="sign">(</span>this<span class="sign">%</span>children<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2057 </span>
<span class="line_number">2058 </span>            p <span class="sign">=</span><span class="sign">&gt;</span> this<span class="sign">%</span>children
<span class="line_number">2059 </span>
<span class="line_number">2060 </span>            do i <span class="sign">=</span> 1<span class="sign">,</span> idx <span class="sign">-</span> 1
<span class="line_number">2061 </span>
<span class="line_number">2062 </span>                if <span class="sign">(</span>associated<span class="sign">(</span>p<span class="sign">%</span>next<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2063 </span>                    p <span class="sign">=</span><span class="sign">&gt;</span> p<span class="sign">%</span>next
<span class="line_number">2064 </span>                else
<span class="line_number">2065 </span>                    call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>get_by_index</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">2066 </span>                                         <span class="squote">' p%next is not associated.'</span><span class="sign">)</span>
<span class="line_number">2067 </span>                    return
<span class="line_number">2068 </span>                end if
<span class="line_number">2069 </span>
<span class="line_number">2070 </span>            end do
<span class="line_number">2071 </span>
<span class="line_number">2072 </span>        else
<span class="line_number">2073 </span>
<span class="line_number">2074 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>get_by_index</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">2075 </span>                                 <span class="squote">' this%children is not associated.'</span><span class="sign">)</span>
<span class="line_number">2076 </span>
<span class="line_number">2077 </span>        end if
<span class="line_number">2078 </span>
<span class="line_number">2079 </span>    end if
<span class="line_number">2080 </span>
<span class="line_number">2081 </span>    end subroutine <strong>get_by_index</strong>
</pre>

<hr />
<a name="json5fmodule2fget5fby5fname5fchars"></a>
<a name="robo6"></a><h2>json_module/get_by_name_chars [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_by_name_chars</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Returns a child in the object given the name string.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2095 </span>    subroutine <strong>get_by_name_chars</strong><span class="sign">(</span>this<span class="sign">,</span> name<span class="sign">,</span> p<span class="sign">)</span>
<span class="line_number">2096 </span>
<span class="line_number">2097 </span>    implicit none
<span class="line_number">2098 </span>
<span class="line_number">2099 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">2100 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>         <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">2101 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer            <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">2102 </span>
<span class="line_number">2103 </span>    integer <span class="sign">:</span><span class="sign">:</span> i
<span class="line_number">2104 </span>
<span class="line_number">2105 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">2106 </span>
<span class="line_number">2107 </span>        if <span class="sign">(</span>associated<span class="sign">(</span>this<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2108 </span>
<span class="line_number">2109 </span>            nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2110 </span>
<span class="line_number">2111 </span>            if <span class="sign">(</span>this<span class="sign">%</span>data<span class="sign">%</span>var_type<span class="sign">=</span><span class="sign">=</span>json_object<span class="sign">)</span> then
<span class="line_number">2112 </span>                do i<span class="sign">=</span>1<span class="sign">,</span> <a href="#robo55">json_value_count</a><span class="sign">(</span>this<span class="sign">)</span>
<span class="line_number">2113 </span>                    call <a href="#robo58">json_value_get</a><span class="sign">(</span>this<span class="sign">,</span> i<span class="sign">,</span> p<span class="sign">)</span>
<span class="line_number">2114 </span>                    if <span class="sign">(</span>allocated<span class="sign">(</span>p<span class="sign">%</span>name<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2115 </span>                        if <span class="sign">(</span>p<span class="sign">%</span>name <span class="sign">=</span><span class="sign">=</span> name<span class="sign">)</span> return
<span class="line_number">2116 </span>                    end if
<span class="line_number">2117 </span>                end do
<span class="line_number">2118 </span>            end if
<span class="line_number">2119 </span>
<span class="line_number">2120 </span>            <span class="sign">!</span>did not find anything<span class="sign">:</span>
<span class="line_number">2121 </span>            nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2122 </span>
<span class="line_number">2123 </span>        else
<span class="line_number">2124 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>get_by_name_chars</strong>: pointer is not associated.'</span><span class="sign">)</span>
<span class="line_number">2125 </span>        end if
<span class="line_number">2126 </span>
<span class="line_number">2127 </span>    end if
<span class="line_number">2128 </span>
<span class="line_number">2129 </span>    end subroutine <strong>get_by_name_chars</strong>
</pre>

<hr />
<a name="json5fmodule2fget5fchar5fvec5ffrom5fjson5ffile"></a>
<a name="robo7"></a><h2>json_module/get_char_vec_from_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_char_vec_from_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%get(path,vec)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a char vector from a JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/19/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">948 </span>    subroutine <strong>get_char_vec_from_json_file</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">949 </span>
<span class="line_number">950 </span>    implicit none
<span class="line_number">951 </span>
<span class="line_number">952 </span>    class<span class="sign">(</span><a href="#robo21">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span>                         <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">953 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                            <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">954 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> vec
<span class="line_number">955 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                           <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">956 </span>
<span class="line_number">957 </span>    call <a href="#robo22">json_get</a><span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">958 </span>
<span class="line_number">959 </span>    end subroutine <strong>get_char_vec_from_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fget5fchars5ffrom5fjson5ffile"></a>
<a name="robo8"></a><h2>json_module/get_chars_from_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_chars_from_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%get(path,val)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a character string from a json file.
    Note: val is an allocatable character string.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/9/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">917 </span>    subroutine <strong>get_chars_from_json_file</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> val<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">918 </span>
<span class="line_number">919 </span>    implicit none
<span class="line_number">920 </span>
<span class="line_number">921 </span>    class<span class="sign">(</span><a href="#robo21">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span>              <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">922 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                 <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">923 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">924 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">925 </span>
<span class="line_number">926 </span>    call <a href="#robo22">json_get</a><span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> value<span class="sign">=</span>val<span class="sign">,</span> found<span class="sign">=</span>found<span class="sign">)</span>
<span class="line_number">927 </span>
<span class="line_number">928 </span>    end subroutine <strong>get_chars_from_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fget5fcurrent5fline5ffrom5ffile"></a>
<a name="robo9"></a><h2>json_module/get_current_line_from_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_current_line_from_file</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Rewind the file to the beginning of the current line, and return this line.
    The file is assumed to be opened.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3593 </span>    subroutine <strong>get_current_line_from_file</strong><span class="sign">(</span>iunit<span class="sign">,</span>line<span class="sign">)</span>
<span class="line_number">3594 </span>    
<span class="line_number">3595 </span>    implicit none
<span class="line_number">3596 </span>    
<span class="line_number">3597 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> iunit
<span class="line_number">3598 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> line
<span class="line_number">3599 </span>    
<span class="line_number">3600 </span>    integer<span class="sign">,</span>parameter           <span class="sign">:</span><span class="sign">:</span> n_chunk <span class="sign">=</span> 256      <span class="sign">!</span>chunk size <span class="sign">[</span>arbitrary<span class="sign">]</span>
<span class="line_number">3601 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>parameter  <span class="sign">:</span><span class="sign">:</span> nfmt <span class="sign">=</span> <span class="squote">'(A256)'</span>    <span class="sign">!</span>corresponding format statement
<span class="line_number">3602 </span>    
<span class="line_number">3603 </span>    character<span class="sign">(</span>len<span class="sign">=</span>n_chunk<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> chunk
<span class="line_number">3604 </span>    integer <span class="sign">:</span><span class="sign">:</span> istat<span class="sign">,</span>isize
<span class="line_number">3605 </span>    
<span class="line_number">3606 </span>    <span class="sign">!</span>initialize<span class="sign">:</span>
<span class="line_number">3607 </span>    line <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">3608 </span>
<span class="line_number">3609 </span>    <span class="sign">!</span>rewind to beginning of the current record<span class="sign">:</span>
<span class="line_number">3610 </span>    backspace<span class="sign">(</span>iunit<span class="sign">,</span> iostat<span class="sign">=</span>istat<span class="sign">)</span>
<span class="line_number">3611 </span>
<span class="line_number">3612 </span>    <span class="sign">!</span>loop to read in all the characters in the current record<span class="sign">.</span>
<span class="line_number">3613 </span>    <span class="sign">!</span><span class="sign">[</span>the line is read in chunks until the end of the line is reached<span class="sign">]</span>
<span class="line_number">3614 </span>    if <span class="sign">(</span>istat<span class="sign">=</span><span class="sign">=</span>0<span class="sign">)</span> then
<span class="line_number">3615 </span>        do
<span class="line_number">3616 </span>            read<span class="sign">(</span>iunit<span class="sign">,</span>fmt<span class="sign">=</span>nfmt<span class="sign">,</span>advance<span class="sign">=</span><span class="squote">'NO'</span><span class="sign">,</span>size<span class="sign">=</span>isize<span class="sign">,</span>iostat<span class="sign">=</span>istat<span class="sign">)</span> chunk
<span class="line_number">3617 </span>            if <span class="sign">(</span>istat<span class="sign">=</span><span class="sign">=</span>0<span class="sign">)</span> then            
<span class="line_number">3618 </span>                line <span class="sign">=</span> line<span class="sign">/</span><span class="sign">/</span>chunk
<span class="line_number">3619 </span>            else
<span class="line_number">3620 </span>                if <span class="sign">(</span>isize<span class="sign">&gt;</span>0<span class="sign">)</span> line <span class="sign">=</span> line<span class="sign">/</span><span class="sign">/</span>chunk<span class="sign">(</span>1<span class="sign">:</span>isize<span class="sign">)</span>
<span class="line_number">3621 </span>                exit
<span class="line_number">3622 </span>            end if
<span class="line_number">3623 </span>        end do
<span class="line_number">3624 </span>    end if
<span class="line_number">3625 </span>    
<span class="line_number">3626 </span>    end subroutine <strong>get_current_line_from_file</strong>
</pre>

<hr />
<a name="json5fmodule2fget5fdouble5ffrom5fjson5ffile"></a>
<a name="robo10"></a><h2>json_module/get_double_from_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_double_from_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%get(path,val,found)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a double from a JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/9/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">792 </span>    subroutine <strong>get_double_from_json_file</strong> <span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> val<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">793 </span>
<span class="line_number">794 </span>    implicit none
<span class="line_number">795 </span>
<span class="line_number">796 </span>    class<span class="sign">(</span><a href="#robo21">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">797 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>     <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">798 </span>    real<span class="sign">(</span>wp<span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>            <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">799 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional    <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">800 </span>
<span class="line_number">801 </span>    call <a href="#robo22">json_get</a><span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> value<span class="sign">=</span>val<span class="sign">,</span> found<span class="sign">=</span>found<span class="sign">)</span>
<span class="line_number">802 </span>
<span class="line_number">803 </span>    end subroutine <strong>get_double_from_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fget5fdouble5fvec5ffrom5fjson5ffile"></a>
<a name="robo11"></a><h2>json_module/get_double_vec_from_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_double_vec_from_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%get(path,vec,found)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a double vector from a JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/19/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">823 </span>    subroutine <strong>get_double_vec_from_json_file</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">824 </span>    
<span class="line_number">825 </span>    implicit none
<span class="line_number">826 </span>
<span class="line_number">827 </span>    class<span class="sign">(</span><a href="#robo21">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span>                  <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">828 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                     <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">829 </span>    real<span class="sign">(</span>wp<span class="sign">)</span><span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>   <span class="sign">:</span><span class="sign">:</span> vec
<span class="line_number">830 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                    <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">831 </span>
<span class="line_number">832 </span>    call <a href="#robo22">json_get</a><span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">833 </span>
<span class="line_number">834 </span>    end subroutine <strong>get_double_vec_from_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fget5finteger5ffrom5fjson5ffile"></a>
<a name="robo12"></a><h2>json_module/get_integer_from_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_integer_from_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%get(path,val)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get an integer from a JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/9/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">730 </span>    subroutine <strong>get_integer_from_json_file</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> val<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">731 </span>
<span class="line_number">732 </span>    implicit none
<span class="line_number">733 </span>
<span class="line_number">734 </span>    class<span class="sign">(</span><a href="#robo21">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">735 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>       <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">736 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>               <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">737 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional      <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">738 </span>
<span class="line_number">739 </span>    call <a href="#robo22">json_get</a><span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> value<span class="sign">=</span>val<span class="sign">,</span> found<span class="sign">=</span>found<span class="sign">)</span>
<span class="line_number">740 </span>
<span class="line_number">741 </span>    end subroutine <strong>get_integer_from_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fget5finteger5fvec5ffrom5fjson5ffile"></a>
<a name="robo13"></a><h2>json_module/get_integer_vec_from_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_integer_vec_from_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%get(path,vec)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get an integer vector from a JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/20/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">761 </span>    subroutine <strong>get_integer_vec_from_json_file</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">762 </span>
<span class="line_number">763 </span>    implicit none
<span class="line_number">764 </span>
<span class="line_number">765 </span>    class<span class="sign">(</span><a href="#robo21">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span>                  <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">766 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                     <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">767 </span>    integer<span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> vec
<span class="line_number">768 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                    <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">769 </span>
<span class="line_number">770 </span>    call <a href="#robo22">json_get</a><span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">771 </span>
<span class="line_number">772 </span>    end subroutine <strong>get_integer_vec_from_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fget5flogical5ffrom5fjson5ffile"></a>
<a name="robo14"></a><h2>json_module/get_logical_from_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_logical_from_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%get(path,val,found)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get an logical from a JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/9/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">854 </span>    subroutine <strong>get_logical_from_json_file</strong><span class="sign">(</span>me<span class="sign">,</span>path<span class="sign">,</span>val<span class="sign">,</span>found<span class="sign">)</span>
<span class="line_number">855 </span>
<span class="line_number">856 </span>    implicit none
<span class="line_number">857 </span>
<span class="line_number">858 </span>    class<span class="sign">(</span><a href="#robo21">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">859 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>     <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">860 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>             <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">861 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional    <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">862 </span>
<span class="line_number">863 </span>    call <a href="#robo22">json_get</a><span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> value<span class="sign">=</span>val<span class="sign">,</span> found<span class="sign">=</span>found<span class="sign">)</span>
<span class="line_number">864 </span>
<span class="line_number">865 </span>    end subroutine <strong>get_logical_from_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fget5flogical5fvec5ffrom5fjson5ffile"></a>
<a name="robo15"></a><h2>json_module/get_logical_vec_from_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_logical_vec_from_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%get(path,vec)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a logical vector from a JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/20/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">885 </span>    subroutine <strong>get_logical_vec_from_json_file</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">886 </span>
<span class="line_number">887 </span>    implicit none
<span class="line_number">888 </span>
<span class="line_number">889 </span>    class<span class="sign">(</span><a href="#robo21">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span>                 <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">890 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                    <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">891 </span>    logical<span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>   <span class="sign">:</span><span class="sign">:</span> vec
<span class="line_number">892 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                   <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">893 </span>    
<span class="line_number">894 </span>    call <a href="#robo22">json_get</a><span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">895 </span>
<span class="line_number">896 </span>    end subroutine <strong>get_logical_vec_from_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fget5fobject5ffrom5fjson5ffile"></a>
<a name="robo16"></a><h2>json_module/get_object_from_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_object_from_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%get(path,p,found)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a pointer to an object from a JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 2/3/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">699 </span>    subroutine <strong>get_object_from_json_file</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> p<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">700 </span>    
<span class="line_number">701 </span>    implicit none
<span class="line_number">702 </span>
<span class="line_number">703 </span>    class<span class="sign">(</span><a href="#robo21">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span>          <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">704 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>             <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">705 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">706 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional            <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">707 </span>
<span class="line_number">708 </span>    call <a href="#robo24">json_get_by_path</a><span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> p<span class="sign">=</span>p<span class="sign">,</span> found<span class="sign">=</span>found<span class="sign">)</span>
<span class="line_number">709 </span>
<span class="line_number">710 </span>    end subroutine <strong>get_object_from_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2finteger5fto5fstring"></a>
<a name="robo17"></a><h2>json_module/integer_to_string [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>integer_to_string</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Convert an integer to a string.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/4/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">4547 </span>    subroutine <strong>integer_to_string</strong><span class="sign">(</span>ival<span class="sign">,</span>str<span class="sign">)</span>
<span class="line_number">4548 </span>
<span class="line_number">4549 </span>    implicit none
<span class="line_number">4550 </span>
<span class="line_number">4551 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>           <span class="sign">:</span><span class="sign">:</span> ival
<span class="line_number">4552 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> str
<span class="line_number">4553 </span>
<span class="line_number">4554 </span>    integer <span class="sign">:</span><span class="sign">:</span> istat
<span class="line_number">4555 </span>
<span class="line_number">4556 </span>    write<span class="sign">(</span>str<span class="sign">,</span>fmt<span class="sign">=</span>int_fmt<span class="sign">,</span>iostat<span class="sign">=</span>istat<span class="sign">)</span> ival
<span class="line_number">4557 </span>
<span class="line_number">4558 </span>    if <span class="sign">(</span>istat<span class="sign">=</span><span class="sign">=</span>0<span class="sign">)</span> then
<span class="line_number">4559 </span>        str <span class="sign">=</span> adjustl<span class="sign">(</span>str<span class="sign">)</span>
<span class="line_number">4560 </span>    else
<span class="line_number">4561 </span>        str <span class="sign">=</span> repeat<span class="sign">(</span><span class="squote">'*'</span><span class="sign">,</span>len<span class="sign">(</span>str<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">4562 </span>    end if
<span class="line_number">4563 </span>
<span class="line_number">4564 </span>    end subroutine <strong>integer_to_string</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fcheck5ffor5ferrors"></a>
<a name="robo18"></a><h2>json_module/json_check_for_errors [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_check_for_errors</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Retrieve error code from the module.
    This should be called after <a href="#robo35">json_parse</a> to check for errors.
    If an error is thrown, before using the module again, <a href="#robo34">json_initialize</a>
    should be called to clean up before it is used again.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    type(<a href="#robo21">json_file</a>) :: json
    logical :: status_ok
    character(len=:),allocatable :: error_msg
    call json%load_file(filename='myfile.json')
    call <strong>json_check_for_errors</strong>(status_ok, error_msg)
    if (.not. status_ok) then
        write(*,*) 'Error: '//error_msg
        call <a href="#robo19">json_clear_exceptions</a>()
        call json%destroy()
    end if
</pre>
<p class="item_name">SEE ALSO</p>
<pre>    <a href="#robo20">json_failed</a>
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/4/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1081 </span>    subroutine <strong>json_check_for_errors</strong><span class="sign">(</span>status_ok<span class="sign">,</span> error_msg<span class="sign">)</span>
<span class="line_number">1082 </span>
<span class="line_number">1083 </span>    implicit none
<span class="line_number">1084 </span>
<span class="line_number">1085 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> status_ok
<span class="line_number">1086 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> error_msg
<span class="line_number">1087 </span>
<span class="line_number">1088 </span>    status_ok <span class="sign">=</span> <span class="sign">.</span>not<span class="sign">.</span> exception_thrown
<span class="line_number">1089 </span>
<span class="line_number">1090 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> status_ok<span class="sign">)</span> then
<span class="line_number">1091 </span>        if <span class="sign">(</span>allocated<span class="sign">(</span>err_message<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1092 </span>            error_msg <span class="sign">=</span> err_message
<span class="line_number">1093 </span>        else
<span class="line_number">1094 </span>            error_msg <span class="sign">=</span> <span class="squote">'Unknown Error'</span>
<span class="line_number">1095 </span>        end if
<span class="line_number">1096 </span>    else
<span class="line_number">1097 </span>        error_msg <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">1098 </span>    end if
<span class="line_number">1099 </span>
<span class="line_number">1100 </span>    end subroutine <strong>json_check_for_errors</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fclear5fexceptions"></a>
<a name="robo19"></a><h2>json_module/json_clear_exceptions [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_clear_exceptions</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Clear exceptions in the JSON module.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/4/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1008 </span>    subroutine <strong>json_clear_exceptions</strong><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">1009 </span>
<span class="line_number">1010 </span>    implicit none
<span class="line_number">1011 </span>
<span class="line_number">1012 </span>    <span class="sign">!</span>clear the flag and message<span class="sign">:</span>
<span class="line_number">1013 </span>    exception_thrown <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">1014 </span>    err_message <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">1015 </span>
<span class="line_number">1016 </span>    end subroutine <strong>json_clear_exceptions</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5ffailed"></a>
<a name="robo20"></a><h2>json_module/json_failed [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_failed</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Logical function to indicate if an exception has been thrown.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    type(<a href="#robo21">json_file</a>) :: json
    logical :: status_ok
    character(len=:),allocatable :: error_msg
    call json%load_file(filename='myfile.json')
    if (<strong>json_failed</strong>()) then
        call <a href="#robo18">json_check_for_errors</a>(status_ok, error_msg)
        write(*,*) 'Error: '//error_msg
        call <a href="#robo19">json_clear_exceptions</a>()
        call json%destroy()
    end if
</pre>
<p class="item_name">SEE ALSO</p>
<pre>    <a href="#robo18">json_check_for_errors</a>
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/5/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1132 </span>    function <strong>json_failed</strong><span class="sign">(</span><span class="sign">)</span> result<span class="sign">(</span>failed<span class="sign">)</span>
<span class="line_number">1133 </span>
<span class="line_number">1134 </span>    implicit none
<span class="line_number">1135 </span>
<span class="line_number">1136 </span>    logical <span class="sign">:</span><span class="sign">:</span> failed
<span class="line_number">1137 </span>
<span class="line_number">1138 </span>    failed <span class="sign">=</span> exception_thrown
<span class="line_number">1139 </span>
<span class="line_number">1140 </span>    end function <strong>json_failed</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5ffile"></a>
<a name="robo21"></a><h2>json_module/json_file [ Classes ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_classes.html#robo_top_of_doc">Classes</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_file</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>  The <strong>json_file</strong> is the main public class that is
    used to open a file and get data from it.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    type(<strong>json_file</strong>) :: json
    integer :: ival
    real(wp) :: rval
    character(len=:),allocatable :: cval
    logical :: found
    call json%load_file(filename='myfile.json')
    call json%print_file()
    call json%get('var.i',ival,found)
    call json%get('var.r(3)',rval,found)
    call json%get('var.c',cval,found)
    call json%destroy()
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/9/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">221 </span>        private
<span class="line_number">222 </span>
<span class="line_number">223 </span>        type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> p <span class="sign">=</span><span class="sign">&gt;</span> null<span class="sign">(</span><span class="sign">)</span>    <span class="sign">!</span>the JSON structure read from the file
<span class="line_number">224 </span>
<span class="line_number">225 </span>        contains
<span class="line_number">226 </span>
<span class="line_number">227 </span>        procedure<span class="sign">,</span>public <span class="sign">:</span><span class="sign">:</span> load_file   <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo62">load_json_file</a>
<span class="line_number">228 </span>        procedure<span class="sign">,</span>public <span class="sign">:</span><span class="sign">:</span> print_file  <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo66">print_json_file</a>
<span class="line_number">229 </span>        procedure<span class="sign">,</span>public <span class="sign">:</span><span class="sign">:</span> destroy     <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo3">destroy_json_file</a>
<span class="line_number">230 </span>        procedure<span class="sign">,</span>public <span class="sign">:</span><span class="sign">:</span> move        <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo63">move_pointer_in_json_file</a>
<span class="line_number">231 </span>        procedure<span class="sign">,</span>public <span class="sign">:</span><span class="sign">:</span> info        <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo77">variable_info_in_file</a>
<span class="line_number">232 </span>
<span class="line_number">233 </span>        generic<span class="sign">,</span>public <span class="sign">:</span><span class="sign">:</span> get <span class="sign">=</span><span class="sign">&gt;</span> get_pointer<span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">234 </span>                                 get_integer<span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">235 </span>                                 get_double<span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">236 </span>                                 get_logical<span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">237 </span>                                 get_chars<span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">238 </span>                                 get_double_vec<span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">239 </span>                                 get_char_vec<span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">240 </span>                                 get_integer_vec<span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">241 </span>                                 get_logical_vec
<span class="line_number">242 </span>
<span class="line_number">243 </span>        <span class="sign">!</span>scalars<span class="sign">:</span>
<span class="line_number">244 </span>        procedure <span class="sign">:</span><span class="sign">:</span> get_pointer        <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo16">get_object_from_json_file</a>
<span class="line_number">245 </span>        procedure <span class="sign">:</span><span class="sign">:</span> get_integer        <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo12">get_integer_from_json_file</a>
<span class="line_number">246 </span>        procedure <span class="sign">:</span><span class="sign">:</span> get_double         <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo10">get_double_from_json_file</a>
<span class="line_number">247 </span>        procedure <span class="sign">:</span><span class="sign">:</span> get_logical        <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo14">get_logical_from_json_file</a>
<span class="line_number">248 </span>        procedure <span class="sign">:</span><span class="sign">:</span> get_chars          <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo8">get_chars_from_json_file</a>
<span class="line_number">249 </span>
<span class="line_number">250 </span>        <span class="sign">!</span>vectors<span class="sign">:</span>
<span class="line_number">251 </span>        procedure <span class="sign">:</span><span class="sign">:</span> get_integer_vec    <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo13">get_integer_vec_from_json_file</a>
<span class="line_number">252 </span>        procedure <span class="sign">:</span><span class="sign">:</span> get_double_vec     <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo11">get_double_vec_from_json_file</a>
<span class="line_number">253 </span>        procedure <span class="sign">:</span><span class="sign">:</span> get_logical_vec    <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo15">get_logical_vec_from_json_file</a>
<span class="line_number">254 </span>        procedure <span class="sign">:</span><span class="sign">:</span> get_char_vec       <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo7">get_char_vec_from_json_file</a>
</pre>

<hr />
<a name="json5fmodule2fjson5fget"></a>
<a name="robo22"></a><h2>json_module/json_get [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get data from a <a href="#robo44">json_value</a> linked list.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">338 </span>    interface <strong>json_get</strong>
<span class="line_number">339 </span>        module procedure <span class="sign">:</span><span class="sign">:</span> <a href="#robo24">json_get_by_path</a>
<span class="line_number">340 </span>        module procedure <span class="sign">:</span><span class="sign">:</span> <a href="#robo29">json_get_integer</a><span class="sign">,</span> <a href="#robo30">json_get_integer_vec</a>
<span class="line_number">341 </span>        module procedure <span class="sign">:</span><span class="sign">:</span> <a href="#robo27">json_get_double</a><span class="sign">,</span>  <a href="#robo28">json_get_double_vec</a>
<span class="line_number">342 </span>        module procedure <span class="sign">:</span><span class="sign">:</span> <a href="#robo31">json_get_logical</a><span class="sign">,</span> <a href="#robo32">json_get_logical_vec</a>
<span class="line_number">343 </span>        module procedure <span class="sign">:</span><span class="sign">:</span> <a href="#robo26">json_get_chars</a><span class="sign">,</span>   <a href="#robo25">json_get_char_vec</a>
<span class="line_number">344 </span>        module procedure <span class="sign">:</span><span class="sign">:</span> <a href="#robo23">json_get_array</a>
<span class="line_number">345 </span>    end interface <strong>json_get</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fget5farray"></a>
<a name="robo23"></a><h2>json_module/json_get_array [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_array</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get an array from a <a href="#robo44">json_value</a>.
    This routine calls the user-supplied array_callback subroutine
        for each element in the array.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3402 </span>    subroutine <strong>json_get_array</strong><span class="sign">(</span>this<span class="sign">,</span> path<span class="sign">,</span> array_callback<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">3403 </span>
<span class="line_number">3404 </span>    implicit none
<span class="line_number">3405 </span>
<span class="line_number">3406 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">3407 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">3408 </span>    procedure<span class="sign">(</span>array_callback_func<span class="sign">)</span>       <span class="sign">:</span><span class="sign">:</span> array_callback
<span class="line_number">3409 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional         <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">3410 </span>
<span class="line_number">3411 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> element<span class="sign">,</span>p
<span class="line_number">3412 </span>    integer <span class="sign">:</span><span class="sign">:</span> i<span class="sign">,</span> count
<span class="line_number">3413 </span>
<span class="line_number">3414 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">3415 </span>
<span class="line_number">3416 </span>        nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">3417 </span>
<span class="line_number">3418 </span>        <span class="sign">!</span> resolve the path to the value
<span class="line_number">3419 </span>        if <span class="sign">(</span>present<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3420 </span>            call <a href="#robo24">json_get_by_path</a><span class="sign">(</span>this<span class="sign">=</span>this<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> p<span class="sign">=</span>p<span class="sign">)</span>
<span class="line_number">3421 </span>        else
<span class="line_number">3422 </span>            p <span class="sign">=</span><span class="sign">&gt;</span> this
<span class="line_number">3423 </span>        end if
<span class="line_number">3424 </span>
<span class="line_number">3425 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3426 </span>
<span class="line_number">3427 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_array</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3428 </span>                                 <span class="squote">' Unable to resolve path: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">3429 </span>
<span class="line_number">3430 </span>        else
<span class="line_number">3431 </span>
<span class="line_number">3432 </span>            <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> p<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3433 </span>                select case <span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>var_type<span class="sign">)</span>
<span class="line_number">3434 </span>                case <span class="sign">(</span>json_array<span class="sign">)</span>
<span class="line_number">3435 </span>                    count <span class="sign">=</span> <a href="#robo55">json_value_count</a><span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">3436 </span>                    do i <span class="sign">=</span> 1<span class="sign">,</span> count
<span class="line_number">3437 </span>                        call <a href="#robo58">json_value_get</a><span class="sign">(</span>p<span class="sign">,</span> i<span class="sign">,</span> element<span class="sign">)</span>
<span class="line_number">3438 </span>                        call array_callback<span class="sign">(</span>element<span class="sign">,</span> i<span class="sign">,</span> count<span class="sign">)</span>
<span class="line_number">3439 </span>                    end do
<span class="line_number">3440 </span>                case default
<span class="line_number">3441 </span>                    call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_array</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3442 </span>                                         <span class="squote">' Resolved value is not an array. '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">3443 </span>                end select
<span class="line_number">3444 </span>            <span class="sign">!</span>end associate
<span class="line_number">3445 </span>
<span class="line_number">3446 </span>            <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">3447 </span>            if <span class="sign">(</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span>       nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">3448 </span>            if <span class="sign">(</span>associated<span class="sign">(</span>element<span class="sign">)</span><span class="sign">)</span> nullify<span class="sign">(</span>element<span class="sign">)</span>
<span class="line_number">3449 </span>
<span class="line_number">3450 </span>        end if
<span class="line_number">3451 </span>
<span class="line_number">3452 </span>        if <span class="sign">(</span>exception_thrown<span class="sign">)</span> then
<span class="line_number">3453 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3454 </span>                found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">3455 </span>                call <a href="#robo19">json_clear_exceptions</a><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3456 </span>            end if
<span class="line_number">3457 </span>        else
<span class="line_number">3458 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">3459 </span>        end if
<span class="line_number">3460 </span>
<span class="line_number">3461 </span>    else
<span class="line_number">3462 </span>        if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">3463 </span>    end if
<span class="line_number">3464 </span>
<span class="line_number">3465 </span>    end subroutine <strong>json_get_array</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fget5fby5fpath"></a>
<a name="robo24"></a><h2>json_module/json_get_by_path [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_by_path</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Returns the <a href="#robo44">json_value</a> pointer given the path string.
</pre>
<p class="item_name">NOTES</p>
<pre>     $         root
     @         this
     .         child object member
     [] or ()  child array element
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2481 </span>    subroutine <strong>json_get_by_path</strong><span class="sign">(</span>this<span class="sign">,</span> path<span class="sign">,</span> p<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">2482 </span>
<span class="line_number">2483 </span>    implicit none
<span class="line_number">2484 </span>
<span class="line_number">2485 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>     <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">2486 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>             <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">2487 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">2488 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional            <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">2489 </span>
<span class="line_number">2490 </span>    integer <span class="sign">:</span><span class="sign">:</span> i<span class="sign">,</span> length<span class="sign">,</span> child_i
<span class="line_number">2491 </span>    character<span class="sign">(</span>len<span class="sign">=</span>1<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> c
<span class="line_number">2492 </span>    logical <span class="sign">:</span><span class="sign">:</span> array
<span class="line_number">2493 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> tmp
<span class="line_number">2494 </span>
<span class="line_number">2495 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">2496 </span>
<span class="line_number">2497 </span>        nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2498 </span>
<span class="line_number">2499 </span>        <span class="sign">!</span> default to assuming relative to this
<span class="line_number">2500 </span>        p <span class="sign">=</span><span class="sign">&gt;</span> this
<span class="line_number">2501 </span>
<span class="line_number">2502 </span>        child_i <span class="sign">=</span> 1
<span class="line_number">2503 </span>
<span class="line_number">2504 </span>        array <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2505 </span>
<span class="line_number">2506 </span>        length <span class="sign">=</span> len_trim<span class="sign">(</span>path<span class="sign">)</span>
<span class="line_number">2507 </span>
<span class="line_number">2508 </span>        do i<span class="sign">=</span>1<span class="sign">,</span> length
<span class="line_number">2509 </span>
<span class="line_number">2510 </span>            c <span class="sign">=</span> path<span class="sign">(</span>i<span class="sign">:</span>i<span class="sign">)</span>
<span class="line_number">2511 </span>
<span class="line_number">2512 </span>            select case <span class="sign">(</span>c<span class="sign">)</span>
<span class="line_number">2513 </span>            case <span class="sign">(</span><span class="squote">'$'</span><span class="sign">)</span>
<span class="line_number">2514 </span>
<span class="line_number">2515 </span>                <span class="sign">!</span> root
<span class="line_number">2516 </span>                do while <span class="sign">(</span>associated <span class="sign">(</span>p <span class="sign">%</span> parent<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2517 </span>                    p <span class="sign">=</span><span class="sign">&gt;</span> p <span class="sign">%</span> parent
<span class="line_number">2518 </span>                end do
<span class="line_number">2519 </span>                child_i <span class="sign">=</span> i <span class="sign">+</span> 1
<span class="line_number">2520 </span>
<span class="line_number">2521 </span>            case <span class="sign">(</span><span class="squote">'@'</span><span class="sign">)</span>
<span class="line_number">2522 </span>
<span class="line_number">2523 </span>                <span class="sign">!</span> this
<span class="line_number">2524 </span>                p <span class="sign">=</span><span class="sign">&gt;</span> this
<span class="line_number">2525 </span>                child_i <span class="sign">=</span> i <span class="sign">+</span> 1
<span class="line_number">2526 </span>
<span class="line_number">2527 </span>            case <span class="sign">(</span><span class="squote">'.'</span><span class="sign">)</span>
<span class="line_number">2528 </span>
<span class="line_number">2529 </span>                <span class="sign">!</span> get child member from p
<span class="line_number">2530 </span>                if <span class="sign">(</span>child_i <span class="sign">&lt;</span> i<span class="sign">)</span> then
<span class="line_number">2531 </span>                    nullify<span class="sign">(</span>tmp<span class="sign">)</span>
<span class="line_number">2532 </span>                    call <a href="#robo58">json_value_get</a><span class="sign">(</span>p<span class="sign">,</span> path<span class="sign">(</span>child_i<span class="sign">:</span>i<span class="sign">-</span>1<span class="sign">)</span><span class="sign">,</span> tmp<span class="sign">)</span>
<span class="line_number">2533 </span>                    p <span class="sign">=</span><span class="sign">&gt;</span> tmp
<span class="line_number">2534 </span>                    nullify<span class="sign">(</span>tmp<span class="sign">)</span>
<span class="line_number">2535 </span>                else
<span class="line_number">2536 </span>                    child_i <span class="sign">=</span> i <span class="sign">+</span> 1
<span class="line_number">2537 </span>                    cycle
<span class="line_number">2538 </span>                end if
<span class="line_number">2539 </span>
<span class="line_number">2540 </span>                if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2541 </span>                    call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_by_path</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">2542 </span>                                         <span class="squote">' Error getting child member.'</span><span class="sign">)</span>
<span class="line_number">2543 </span>                    exit
<span class="line_number">2544 </span>                end if
<span class="line_number">2545 </span>
<span class="line_number">2546 </span>                child_i <span class="sign">=</span> i<span class="sign">+</span>1
<span class="line_number">2547 </span>
<span class="line_number">2548 </span>            case <span class="sign">(</span><span class="squote">'['</span><span class="sign">,</span><span class="squote">'('</span><span class="sign">)</span>
<span class="line_number">2549 </span>
<span class="line_number">2550 </span>                <span class="sign">!</span><span class="sign">.</span><span class="sign">.</span><span class="sign">.</span><span class="sign">.</span>Modified to allow for <span class="squote">'var[3]'</span> style syntax
<span class="line_number">2551 </span>                <span class="sign">!</span>Note<span class="sign">:</span> jmozmoz<span class="sign">/</span>fson has a slightly different version of this<span class="sign">.</span><span class="sign">.</span><span class="sign">.</span>
<span class="line_number">2552 </span>
<span class="line_number">2553 </span>                <span class="sign">!</span> start looking for the array element index
<span class="line_number">2554 </span>                array <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">2555 </span>
<span class="line_number">2556 </span>                <span class="sign">!</span> get child member from p
<span class="line_number">2557 </span>                if <span class="sign">(</span>child_i <span class="sign">&lt;</span> i<span class="sign">)</span> then
<span class="line_number">2558 </span>                    nullify<span class="sign">(</span>tmp<span class="sign">)</span>
<span class="line_number">2559 </span>                    call <a href="#robo58">json_value_get</a><span class="sign">(</span>p<span class="sign">,</span> path<span class="sign">(</span>child_i<span class="sign">:</span>i<span class="sign">-</span>1<span class="sign">)</span><span class="sign">,</span> tmp<span class="sign">)</span>
<span class="line_number">2560 </span>                    p <span class="sign">=</span><span class="sign">&gt;</span> tmp
<span class="line_number">2561 </span>                    nullify<span class="sign">(</span>tmp<span class="sign">)</span>
<span class="line_number">2562 </span>                else
<span class="line_number">2563 </span>                    child_i <span class="sign">=</span> i <span class="sign">+</span> 1
<span class="line_number">2564 </span>                    cycle
<span class="line_number">2565 </span>                end if
<span class="line_number">2566 </span>                if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2567 </span>                    call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_by_path</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">2568 </span>                                         <span class="squote">' Error getting array element'</span><span class="sign">)</span>
<span class="line_number">2569 </span>                    exit
<span class="line_number">2570 </span>                end if
<span class="line_number">2571 </span>                child_i <span class="sign">=</span> i <span class="sign">+</span> 1
<span class="line_number">2572 </span>
<span class="line_number">2573 </span>            case <span class="sign">(</span><span class="squote">']'</span><span class="sign">,</span><span class="squote">')'</span><span class="sign">)</span>
<span class="line_number">2574 </span>
<span class="line_number">2575 </span>                if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span>array<span class="sign">)</span> then
<span class="line_number">2576 </span>                    call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_by_path</strong>: Unexpected ]'</span><span class="sign">)</span>
<span class="line_number">2577 </span>                    exit
<span class="line_number">2578 </span>                end if
<span class="line_number">2579 </span>                array <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2580 </span>                child_i <span class="sign">=</span> <a href="#robo68">string_to_integer</a><span class="sign">(</span>path<span class="sign">(</span>child_i<span class="sign">:</span>i<span class="sign">-</span>1<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2581 </span>
<span class="line_number">2582 </span>                nullify<span class="sign">(</span>tmp<span class="sign">)</span>
<span class="line_number">2583 </span>                call <a href="#robo58">json_value_get</a><span class="sign">(</span>p<span class="sign">,</span> child_i<span class="sign">,</span> tmp<span class="sign">)</span>
<span class="line_number">2584 </span>                p <span class="sign">=</span><span class="sign">&gt;</span> tmp
<span class="line_number">2585 </span>                nullify<span class="sign">(</span>tmp<span class="sign">)</span>
<span class="line_number">2586 </span>
<span class="line_number">2587 </span>                child_i<span class="sign">=</span> i <span class="sign">+</span> 1
<span class="line_number">2588 </span>
<span class="line_number">2589 </span>            end select
<span class="line_number">2590 </span>
<span class="line_number">2591 </span>        end do
<span class="line_number">2592 </span>
<span class="line_number">2593 </span>        if <span class="sign">(</span>exception_thrown<span class="sign">)</span> then
<span class="line_number">2594 </span>
<span class="line_number">2595 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2596 </span>                found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2597 </span>                call <a href="#robo19">json_clear_exceptions</a><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">2598 </span>            end if
<span class="line_number">2599 </span>
<span class="line_number">2600 </span>        else
<span class="line_number">2601 </span>
<span class="line_number">2602 </span>            <span class="sign">!</span> grab the last child if present in the path
<span class="line_number">2603 </span>            if <span class="sign">(</span>child_i <span class="sign">&lt;</span><span class="sign">=</span> length<span class="sign">)</span> then
<span class="line_number">2604 </span>                nullify<span class="sign">(</span>tmp<span class="sign">)</span>
<span class="line_number">2605 </span>                call <a href="#robo58">json_value_get</a><span class="sign">(</span>p<span class="sign">,</span> path<span class="sign">(</span>child_i<span class="sign">:</span>i<span class="sign">-</span>1<span class="sign">)</span><span class="sign">,</span> tmp<span class="sign">)</span>
<span class="line_number">2606 </span>                p <span class="sign">=</span><span class="sign">&gt;</span> tmp
<span class="line_number">2607 </span>                nullify<span class="sign">(</span>tmp<span class="sign">)</span>
<span class="line_number">2608 </span>            end if
<span class="line_number">2609 </span>            if <span class="sign">(</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2610 </span>                if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>    <span class="sign">!</span>everything seems to be ok
<span class="line_number">2611 </span>            else
<span class="line_number">2612 </span>                call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_by_path</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">2613 </span>                                     <span class="squote">' variable not found: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2614 </span>                if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2615 </span>                    found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2616 </span>                    call <a href="#robo19">json_clear_exceptions</a><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">2617 </span>                end if
<span class="line_number">2618 </span>            end if
<span class="line_number">2619 </span>            
<span class="line_number">2620 </span>        end if
<span class="line_number">2621 </span>
<span class="line_number">2622 </span>    else
<span class="line_number">2623 </span>        if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2624 </span>    end if
<span class="line_number">2625 </span>
<span class="line_number">2626 </span>    end subroutine <strong>json_get_by_path</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fget5fchar5fvec"></a>
<a name="robo25"></a><h2>json_module/json_get_char_vec [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_char_vec</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a char vector from a JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 5/14/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3338 </span>    subroutine <strong>json_get_char_vec</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">3339 </span>
<span class="line_number">3340 </span>    implicit none
<span class="line_number">3341 </span>
<span class="line_number">3342 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                    <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">3343 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                            <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">3344 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> vec
<span class="line_number">3345 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                           <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">3346 </span>
<span class="line_number">3347 </span>    logical <span class="sign">:</span><span class="sign">:</span> initialized
<span class="line_number">3348 </span>
<span class="line_number">3349 </span>    initialized <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">3350 </span>
<span class="line_number">3351 </span>    if <span class="sign">(</span>allocated<span class="sign">(</span>vec<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>vec<span class="sign">)</span>
<span class="line_number">3352 </span>
<span class="line_number">3353 </span>    <span class="sign">!</span>the callback function is called for each element of the array<span class="sign">:</span>
<span class="line_number">3354 </span>    call <a href="#robo22">json_get</a><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> array_callback<span class="sign">=</span>get_chars_from_array<span class="sign">,</span> found<span class="sign">=</span>found<span class="sign">)</span>
<span class="line_number">3355 </span>
<span class="line_number">3356 </span>    contains
<span class="line_number">3357 </span>
<span class="line_number">3358 </span>        <span class="sign">!</span> callback function for chars
<span class="line_number">3359 </span>        subroutine get_chars_from_array<span class="sign">(</span>element<span class="sign">,</span> i<span class="sign">,</span> count<span class="sign">)</span>
<span class="line_number">3360 </span>        
<span class="line_number">3361 </span>        implicit none
<span class="line_number">3362 </span>
<span class="line_number">3363 </span>        type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> element
<span class="line_number">3364 </span>        integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                   <span class="sign">:</span><span class="sign">:</span> i        <span class="sign">!</span>index
<span class="line_number">3365 </span>        integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                   <span class="sign">:</span><span class="sign">:</span> count    <span class="sign">!</span>size of array
<span class="line_number">3366 </span>
<span class="line_number">3367 </span>        character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable <span class="sign">:</span><span class="sign">:</span> cval
<span class="line_number">3368 </span>
<span class="line_number">3369 </span>        <span class="sign">!</span>size the output array<span class="sign">:</span>
<span class="line_number">3370 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> initialized<span class="sign">)</span> then
<span class="line_number">3371 </span>            allocate<span class="sign">(</span>vec<span class="sign">(</span>count<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">3372 </span>            initialized <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">3373 </span>        end if
<span class="line_number">3374 </span>
<span class="line_number">3375 </span>        <span class="sign">!</span>populate the elements<span class="sign">:</span>
<span class="line_number">3376 </span>        call <a href="#robo22">json_get</a><span class="sign">(</span>element<span class="sign">,</span> value<span class="sign">=</span>cval<span class="sign">)</span>
<span class="line_number">3377 </span>        if <span class="sign">(</span>allocated<span class="sign">(</span>cval<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3378 </span>            vec<span class="sign">(</span>i<span class="sign">)</span> <span class="sign">=</span> cval
<span class="line_number">3379 </span>            deallocate<span class="sign">(</span>cval<span class="sign">)</span>
<span class="line_number">3380 </span>        else
<span class="line_number">3381 </span>            vec<span class="sign">(</span>i<span class="sign">)</span> <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">3382 </span>        end if
<span class="line_number">3383 </span>
<span class="line_number">3384 </span>        end subroutine get_chars_from_array
<span class="line_number">3385 </span>
<span class="line_number">3386 </span>    end subroutine <strong>json_get_char_vec</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fget5fchars"></a>
<a name="robo26"></a><h2>json_module/json_get_chars [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_chars</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a character string from a <a href="#robo44">json_value</a>.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3124 </span>    subroutine <strong>json_get_chars</strong><span class="sign">(</span>this<span class="sign">,</span> path<span class="sign">,</span> value<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">3125 </span>
<span class="line_number">3126 </span>    implicit none
<span class="line_number">3127 </span>
<span class="line_number">3128 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>         <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">3129 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional        <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">3130 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> value
<span class="line_number">3131 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">3132 </span>
<span class="line_number">3133 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">3134 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable <span class="sign">:</span><span class="sign">:</span> s<span class="sign">,</span>pre<span class="sign">,</span>post
<span class="line_number">3135 </span>    integer <span class="sign">:</span><span class="sign">:</span> j<span class="sign">,</span>jprev<span class="sign">,</span>n
<span class="line_number">3136 </span>    character<span class="sign">(</span>len<span class="sign">=</span>1<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> c
<span class="line_number">3137 </span>
<span class="line_number">3138 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">3139 </span>
<span class="line_number">3140 </span>        nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">3141 </span>
<span class="line_number">3142 </span>        if <span class="sign">(</span>present<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3143 </span>            call <a href="#robo24">json_get_by_path</a><span class="sign">(</span>this<span class="sign">=</span>this<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> p<span class="sign">=</span>p<span class="sign">)</span>
<span class="line_number">3144 </span>        else
<span class="line_number">3145 </span>            p <span class="sign">=</span><span class="sign">&gt;</span> this
<span class="line_number">3146 </span>        end if
<span class="line_number">3147 </span>
<span class="line_number">3148 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3149 </span>
<span class="line_number">3150 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_chars</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3151 </span>                                 <span class="squote">' Unable to resolve path: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">3152 </span>
<span class="line_number">3153 </span>        else
<span class="line_number">3154 </span>
<span class="line_number">3155 </span>            <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> p<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3156 </span>                select case <span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>var_type<span class="sign">)</span>
<span class="line_number">3157 </span>                case <span class="sign">(</span>json_string<span class="sign">)</span>
<span class="line_number">3158 </span>                    if <span class="sign">(</span>allocated<span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>str_value<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3159 </span>
<span class="line_number">3160 </span>                        <span class="sign">!</span>get the value as is<span class="sign">:</span>
<span class="line_number">3161 </span>                        s <span class="sign">=</span> p<span class="sign">%</span>data<span class="sign">%</span>str_value
<span class="line_number">3162 </span>
<span class="line_number">3163 </span>                        <span class="sign">!</span> Now<span class="sign">,</span> have to remove the escape characters<span class="sign">:</span>
<span class="line_number">3164 </span>                        <span class="sign">!</span>
<span class="line_number">3165 </span>                        <span class="sign">!</span> <span class="squote">'\"'</span>        quotation mark
<span class="line_number">3166 </span>                        <span class="sign">!</span> <span class="squote">'\\'</span>        reverse solidus
<span class="line_number">3167 </span>                        <span class="sign">!</span> <span class="squote">'\/'</span>        solidus
<span class="line_number">3168 </span>                        <span class="sign">!</span> <span class="squote">'\b'</span>        backspace
<span class="line_number">3169 </span>                        <span class="sign">!</span> <span class="squote">'\f'</span>        formfeed
<span class="line_number">3170 </span>                        <span class="sign">!</span> <span class="squote">'\n'</span>        newline <span class="sign">(</span>LF<span class="sign">)</span>
<span class="line_number">3171 </span>                        <span class="sign">!</span> <span class="squote">'\r'</span>        carriage return <span class="sign">(</span>CR<span class="sign">)</span>
<span class="line_number">3172 </span>                        <span class="sign">!</span> <span class="squote">'\t'</span>        horizontal tab
<span class="line_number">3173 </span>                        <span class="sign">!</span> <span class="squote">'\uXXXX'</span>    4 hexadecimal digits
<span class="line_number">3174 </span>                        <span class="sign">!</span>
<span class="line_number">3175 </span>
<span class="line_number">3176 </span>                        <span class="sign">!</span>initialize<span class="sign">:</span>
<span class="line_number">3177 </span>                        n <span class="sign">=</span> len<span class="sign">(</span>s<span class="sign">)</span>
<span class="line_number">3178 </span>                        j <span class="sign">=</span> 1
<span class="line_number">3179 </span>
<span class="line_number">3180 </span>                        do
<span class="line_number">3181 </span>
<span class="line_number">3182 </span>                            jprev <span class="sign">=</span> j                      <span class="sign">!</span>initialize
<span class="line_number">3183 </span>                            j <span class="sign">=</span> index<span class="sign">(</span>s<span class="sign">(</span>j<span class="sign">:</span>n<span class="sign">)</span><span class="sign">,</span>backslash<span class="sign">)</span>    <span class="sign">!</span>look for an escape character
<span class="line_number">3184 </span>
<span class="line_number">3185 </span>                            if <span class="sign">(</span>j<span class="sign">&gt;</span>0<span class="sign">)</span> then            <span class="sign">!</span>an escape character was found
<span class="line_number">3186 </span>                            
<span class="line_number">3187 </span>                                <span class="sign">!</span>index in full string of the escape character<span class="sign">:</span>
<span class="line_number">3188 </span>                                j <span class="sign">=</span> j <span class="sign">+</span> <span class="sign">(</span>jprev<span class="sign">-</span>1<span class="sign">)</span>   
<span class="line_number">3189 </span>
<span class="line_number">3190 </span>                                if <span class="sign">(</span>j<span class="sign">&lt;</span>n<span class="sign">)</span> then
<span class="line_number">3191 </span>
<span class="line_number">3192 </span>                                    <span class="sign">!</span>save the bit before the escape character<span class="sign">:</span>
<span class="line_number">3193 </span>                                    if <span class="sign">(</span>j<span class="sign">&gt;</span>1<span class="sign">)</span> then
<span class="line_number">3194 </span>                                        pre <span class="sign">=</span> s<span class="sign">(</span> 1 <span class="sign">:</span> j<span class="sign">-</span>1 <span class="sign">)</span>
<span class="line_number">3195 </span>                                    else
<span class="line_number">3196 </span>                                        pre <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">3197 </span>                                    end if
<span class="line_number">3198 </span>
<span class="line_number">3199 </span>                                    <span class="sign">!</span>character after the escape character<span class="sign">:</span>
<span class="line_number">3200 </span>                                    c <span class="sign">=</span> s<span class="sign">(</span> j<span class="sign">+</span>1 <span class="sign">:</span> j<span class="sign">+</span>1 <span class="sign">)</span>
<span class="line_number">3201 </span>
<span class="line_number">3202 </span>                                    select case <span class="sign">(</span>c<span class="sign">)</span>
<span class="line_number">3203 </span>                                    case<span class="sign">(</span>quotation_mark<span class="sign">,</span>backslash<span class="sign">,</span>slash<span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">3204 </span>                                         <span class="squote">'b'</span><span class="sign">,</span><span class="squote">'f'</span><span class="sign">,</span><span class="squote">'n'</span><span class="sign">,</span><span class="squote">'r'</span><span class="sign">,</span><span class="squote">'t'</span><span class="sign">)</span>
<span class="line_number">3205 </span>
<span class="line_number">3206 </span>                                        <span class="sign">!</span>save the bit after the escape characters<span class="sign">:</span>
<span class="line_number">3207 </span>                                        if <span class="sign">(</span>j<span class="sign">+</span>2<span class="sign">&lt;</span>n<span class="sign">)</span> then
<span class="line_number">3208 </span>                                            post <span class="sign">=</span> s<span class="sign">(</span>j<span class="sign">+</span>2<span class="sign">:</span>n<span class="sign">)</span>
<span class="line_number">3209 </span>                                        else
<span class="line_number">3210 </span>                                            post <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">3211 </span>                                        end if
<span class="line_number">3212 </span>
<span class="line_number">3213 </span>                                        select case<span class="sign">(</span>c<span class="sign">)</span>
<span class="line_number">3214 </span>                                        case<span class="sign">(</span>quotation_mark<span class="sign">,</span>backslash<span class="sign">,</span>slash<span class="sign">)</span>
<span class="line_number">3215 </span>                                            <span class="sign">!</span>use c as is
<span class="line_number">3216 </span>                                        case<span class="sign">(</span><span class="squote">'b'</span><span class="sign">)</span>
<span class="line_number">3217 </span>                                            c <span class="sign">=</span> bspace
<span class="line_number">3218 </span>                                        case<span class="sign">(</span><span class="squote">'f'</span><span class="sign">)</span>
<span class="line_number">3219 </span>                                            c <span class="sign">=</span> formfeed
<span class="line_number">3220 </span>                                        case<span class="sign">(</span><span class="squote">'n'</span><span class="sign">)</span>
<span class="line_number">3221 </span>                                            c <span class="sign">=</span> newline
<span class="line_number">3222 </span>                                        case<span class="sign">(</span><span class="squote">'r'</span><span class="sign">)</span>
<span class="line_number">3223 </span>                                            c <span class="sign">=</span> carriage_return
<span class="line_number">3224 </span>                                        case<span class="sign">(</span><span class="squote">'t'</span><span class="sign">)</span>
<span class="line_number">3225 </span>                                            c <span class="sign">=</span> horizontal_tab
<span class="line_number">3226 </span>                                        end select
<span class="line_number">3227 </span>
<span class="line_number">3228 </span>                                        s <span class="sign">=</span> pre<span class="sign">/</span><span class="sign">/</span>c<span class="sign">/</span><span class="sign">/</span>post
<span class="line_number">3229 </span>
<span class="line_number">3230 </span>                                        n <span class="sign">=</span> n<span class="sign">-</span>1    <span class="sign">!</span>backslash character has been 
<span class="line_number">3231 </span>                                                   <span class="sign">!</span> removed from the string
<span class="line_number">3232 </span>
<span class="line_number">3233 </span>                                    case<span class="sign">(</span><span class="squote">'u'</span><span class="sign">)</span>    <span class="sign">!</span>expecting 4 hexadecimal digits after 
<span class="line_number">3234 </span>                                                 <span class="sign">!</span> the escape character    <span class="sign">[</span><span class="sign">\</span>uXXXX<span class="sign">]</span>
<span class="line_number">3235 </span>
<span class="line_number">3236 </span>                                        <span class="sign">!</span>for now<span class="sign">,</span> we are just printing them as is
<span class="line_number">3237 </span>                                        <span class="sign">!</span><span class="sign">[</span>not checking to see if it is a valid hex value<span class="sign">]</span>
<span class="line_number">3238 </span>
<span class="line_number">3239 </span>                                        if <span class="sign">(</span>j<span class="sign">+</span>5<span class="sign">&lt;</span><span class="sign">=</span>n<span class="sign">)</span> then
<span class="line_number">3240 </span>                                            j<span class="sign">=</span>j<span class="sign">+</span>4
<span class="line_number">3241 </span>                                        else
<span class="line_number">3242 </span>                                            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="sign">&amp;</span>
<span class="line_number">3243 </span>                                                <span class="squote">'Error in <strong>json_get_chars</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3244 </span>                                                <span class="squote">' Invalid hexadecimal sequence'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3245 </span>                                                <span class="squote">' in string: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>c<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">3246 </span>                                            exit
<span class="line_number">3247 </span>                                        end if
<span class="line_number">3248 </span>
<span class="line_number">3249 </span>                                    case default
<span class="line_number">3250 </span>                                        <span class="sign">!</span>unknown escape character
<span class="line_number">3251 </span>                                        call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_chars</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3252 </span>                                                <span class="squote">' unknown escape sequence in string "'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3253 </span>                                                trim<span class="sign">(</span>s<span class="sign">)</span><span class="sign">/</span><span class="sign">/</span><span class="squote">'" ['</span><span class="sign">/</span><span class="sign">/</span>backslash<span class="sign">/</span><span class="sign">/</span>c<span class="sign">/</span><span class="sign">/</span><span class="squote">']'</span><span class="sign">)</span>
<span class="line_number">3254 </span>                                        exit
<span class="line_number">3255 </span>                                    end select
<span class="line_number">3256 </span>
<span class="line_number">3257 </span>                                    j<span class="sign">=</span>j<span class="sign">+</span>1    <span class="sign">!</span>go to the next character
<span class="line_number">3258 </span>
<span class="line_number">3259 </span>                                    if <span class="sign">(</span>j<span class="sign">&gt;</span><span class="sign">=</span>n<span class="sign">)</span> exit    <span class="sign">!</span>finished
<span class="line_number">3260 </span>
<span class="line_number">3261 </span>                                else
<span class="line_number">3262 </span>                                    <span class="sign">!</span>an escape character is the last character in 
<span class="line_number">3263 </span>                                    <span class="sign">!</span> the string <span class="sign">[</span>this may not be valid syntax<span class="sign">,</span> 
<span class="line_number">3264 </span>                                    <span class="sign">!</span> but just keep it<span class="sign">]</span>
<span class="line_number">3265 </span>                                    exit
<span class="line_number">3266 </span>                                end if
<span class="line_number">3267 </span>
<span class="line_number">3268 </span>                            else
<span class="line_number">3269 </span>                                exit    <span class="sign">!</span>no more escape characters in the string
<span class="line_number">3270 </span>                            end if
<span class="line_number">3271 </span>
<span class="line_number">3272 </span>                        end do
<span class="line_number">3273 </span>
<span class="line_number">3274 </span>                        if <span class="sign">(</span>exception_thrown<span class="sign">)</span> then
<span class="line_number">3275 </span>                            if <span class="sign">(</span>allocated<span class="sign">(</span>value<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>value<span class="sign">)</span>
<span class="line_number">3276 </span>                        else
<span class="line_number">3277 </span>                            value <span class="sign">=</span> s
<span class="line_number">3278 </span>                        end if
<span class="line_number">3279 </span>
<span class="line_number">3280 </span>                    else
<span class="line_number">3281 </span>                        call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_chars</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3282 </span>                                             <span class="squote">' p%data%value not allocated'</span><span class="sign">)</span>
<span class="line_number">3283 </span>                    end if
<span class="line_number">3284 </span>
<span class="line_number">3285 </span>                <span class="sign">!</span>class default
<span class="line_number">3286 </span>                case default
<span class="line_number">3287 </span>
<span class="line_number">3288 </span>                    call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_chars</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3289 </span>                                         <span class="squote">' Unable to resolve value to characters: '</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3290 </span>                                         trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">3291 </span>
<span class="line_number">3292 </span>                    <span class="sign">!</span> Note<span class="sign">:</span> for the other cases<span class="sign">,</span> we could do val to string conversions<span class="sign">.</span>
<span class="line_number">3293 </span>
<span class="line_number">3294 </span>                end select
<span class="line_number">3295 </span>            <span class="sign">!</span>end associate
<span class="line_number">3296 </span>
<span class="line_number">3297 </span>        end if
<span class="line_number">3298 </span>
<span class="line_number">3299 </span>        if <span class="sign">(</span>allocated<span class="sign">(</span>value<span class="sign">)</span> <span class="sign">.</span>and<span class="sign">.</span> <span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">3300 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">3301 </span>        else
<span class="line_number">3302 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3303 </span>                found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">3304 </span>                call <a href="#robo19">json_clear_exceptions</a><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3305 </span>            end if
<span class="line_number">3306 </span>        end if
<span class="line_number">3307 </span>
<span class="line_number">3308 </span>        <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">3309 </span>        if <span class="sign">(</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span> nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">3310 </span>        if <span class="sign">(</span>allocated<span class="sign">(</span>s<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>s<span class="sign">)</span>
<span class="line_number">3311 </span>        if <span class="sign">(</span>allocated<span class="sign">(</span>pre<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>pre<span class="sign">)</span>
<span class="line_number">3312 </span>        if <span class="sign">(</span>allocated<span class="sign">(</span>post<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>post<span class="sign">)</span>
<span class="line_number">3313 </span>
<span class="line_number">3314 </span>    else
<span class="line_number">3315 </span>
<span class="line_number">3316 </span>        value <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">3317 </span>        found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">3318 </span>
<span class="line_number">3319 </span>    end if
<span class="line_number">3320 </span>
<span class="line_number">3321 </span>    end subroutine <strong>json_get_chars</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fget5fdouble"></a>
<a name="robo27"></a><h2>json_module/json_get_double [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_double</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a double value from an <a href="#robo44">json_value</a>.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2856 </span>    subroutine <strong>json_get_double</strong><span class="sign">(</span>this<span class="sign">,</span> path<span class="sign">,</span> value<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">2857 </span>
<span class="line_number">2858 </span>    implicit none
<span class="line_number">2859 </span>
<span class="line_number">2860 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer       <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">2861 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span> optional      <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">2862 </span>    real<span class="sign">(</span>wp<span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>            <span class="sign">:</span><span class="sign">:</span> value
<span class="line_number">2863 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional    <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">2864 </span>
<span class="line_number">2865 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">2866 </span>
<span class="line_number">2867 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">2868 </span>
<span class="line_number">2869 </span>        nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2870 </span>
<span class="line_number">2871 </span>        if <span class="sign">(</span>present<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2872 </span>            call <a href="#robo24">json_get_by_path</a><span class="sign">(</span>this<span class="sign">=</span>this<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> p<span class="sign">=</span>p<span class="sign">)</span>
<span class="line_number">2873 </span>        else
<span class="line_number">2874 </span>            p <span class="sign">=</span><span class="sign">&gt;</span> this
<span class="line_number">2875 </span>        end if
<span class="line_number">2876 </span>
<span class="line_number">2877 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2878 </span>
<span class="line_number">2879 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_double</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">2880 </span>                                 <span class="squote">' Unable to resolve path: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2881 </span>
<span class="line_number">2882 </span>        else
<span class="line_number">2883 </span>
<span class="line_number">2884 </span>            <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> p<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">2885 </span>                select case <span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>var_type<span class="sign">)</span>
<span class="line_number">2886 </span>                case <span class="sign">(</span>json_integer<span class="sign">)</span>
<span class="line_number">2887 </span>                    value <span class="sign">=</span> p<span class="sign">%</span>data<span class="sign">%</span>int_value
<span class="line_number">2888 </span>                case <span class="sign">(</span>json_real<span class="sign">)</span>
<span class="line_number">2889 </span>                    value <span class="sign">=</span> p<span class="sign">%</span>data<span class="sign">%</span>dbl_value
<span class="line_number">2890 </span>                case <span class="sign">(</span>json_logical<span class="sign">)</span>
<span class="line_number">2891 </span>                    if <span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>log_value<span class="sign">)</span> then
<span class="line_number">2892 </span>                        value <span class="sign">=</span> 1<span class="sign">.</span>0_wp
<span class="line_number">2893 </span>                    else
<span class="line_number">2894 </span>                        value <span class="sign">=</span> 0<span class="sign">.</span>0_wp
<span class="line_number">2895 </span>                    end if
<span class="line_number">2896 </span>                case default
<span class="line_number">2897 </span>                    call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_double</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">2898 </span>                                         <span class="squote">' Unable to resolve value to double: '</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">2899 </span>                                         trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2900 </span>                end select
<span class="line_number">2901 </span>            <span class="sign">!</span>end associate
<span class="line_number">2902 </span>
<span class="line_number">2903 </span>            nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2904 </span>
<span class="line_number">2905 </span>        end if
<span class="line_number">2906 </span>
<span class="line_number">2907 </span>        if <span class="sign">(</span>exception_thrown<span class="sign">)</span> then
<span class="line_number">2908 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2909 </span>                found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2910 </span>                call <a href="#robo19">json_clear_exceptions</a><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">2911 </span>            end if
<span class="line_number">2912 </span>        else
<span class="line_number">2913 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">2914 </span>        end if
<span class="line_number">2915 </span>
<span class="line_number">2916 </span>    else
<span class="line_number">2917 </span>
<span class="line_number">2918 </span>        value <span class="sign">=</span> 0<span class="sign">.</span>0_wp
<span class="line_number">2919 </span>        if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2920 </span>
<span class="line_number">2921 </span>    end if
<span class="line_number">2922 </span>
<span class="line_number">2923 </span>    end subroutine <strong>json_get_double</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fget5fdouble5fvec"></a>
<a name="robo28"></a><h2>json_module/json_get_double_vec [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_double_vec</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a double vector from a JSON value.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 5/14/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2940 </span>    subroutine <strong>json_get_double_vec</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">2941 </span>
<span class="line_number">2942 </span>    implicit none
<span class="line_number">2943 </span>
<span class="line_number">2944 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer                       <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">2945 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                     <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">2946 </span>    real<span class="sign">(</span>wp<span class="sign">)</span><span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> vec
<span class="line_number">2947 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                    <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">2948 </span>
<span class="line_number">2949 </span>    logical <span class="sign">:</span><span class="sign">:</span> initialized
<span class="line_number">2950 </span>
<span class="line_number">2951 </span>    initialized <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2952 </span>
<span class="line_number">2953 </span>    if <span class="sign">(</span>allocated<span class="sign">(</span>vec<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>vec<span class="sign">)</span>
<span class="line_number">2954 </span>
<span class="line_number">2955 </span>    <span class="sign">!</span>the callback function is called for each element of the array<span class="sign">:</span>
<span class="line_number">2956 </span>    call <a href="#robo22">json_get</a><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> array_callback<span class="sign">=</span>get_double_from_array<span class="sign">,</span> found<span class="sign">=</span>found<span class="sign">)</span>
<span class="line_number">2957 </span>
<span class="line_number">2958 </span>    contains
<span class="line_number">2959 </span>
<span class="line_number">2960 </span>        <span class="sign">!</span> callback function for double
<span class="line_number">2961 </span>        subroutine get_double_from_array<span class="sign">(</span>element<span class="sign">,</span> i<span class="sign">,</span> count<span class="sign">)</span>
<span class="line_number">2962 </span>        implicit none
<span class="line_number">2963 </span>
<span class="line_number">2964 </span>        type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>     <span class="sign">:</span><span class="sign">:</span> element
<span class="line_number">2965 </span>        integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                      <span class="sign">:</span><span class="sign">:</span> i        <span class="sign">!</span>index
<span class="line_number">2966 </span>        integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                      <span class="sign">:</span><span class="sign">:</span> count    <span class="sign">!</span>size of array
<span class="line_number">2967 </span>
<span class="line_number">2968 </span>        <span class="sign">!</span>size the output array<span class="sign">:</span>
<span class="line_number">2969 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> initialized<span class="sign">)</span> then
<span class="line_number">2970 </span>            allocate<span class="sign">(</span>vec<span class="sign">(</span>count<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2971 </span>            initialized <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">2972 </span>        end if
<span class="line_number">2973 </span>
<span class="line_number">2974 </span>        <span class="sign">!</span>populate the elements<span class="sign">:</span>
<span class="line_number">2975 </span>        call <a href="#robo22">json_get</a><span class="sign">(</span>element<span class="sign">,</span> value<span class="sign">=</span>vec<span class="sign">(</span>i<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2976 </span>
<span class="line_number">2977 </span>        end subroutine get_double_from_array
<span class="line_number">2978 </span>
<span class="line_number">2979 </span>    end subroutine <strong>json_get_double_vec</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fget5finteger"></a>
<a name="robo29"></a><h2>json_module/json_get_integer [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_integer</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get an integer value from an <a href="#robo44">json_value</a>.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2719 </span>    subroutine <strong>json_get_integer</strong><span class="sign">(</span>this<span class="sign">,</span> path<span class="sign">,</span> value<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">2720 </span>
<span class="line_number">2721 </span>    implicit none
<span class="line_number">2722 </span>
<span class="line_number">2723 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">2724 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>optional            <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">2725 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>                  <span class="sign">:</span><span class="sign">:</span> value
<span class="line_number">2726 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional         <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">2727 </span>
<span class="line_number">2728 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">2729 </span>
<span class="line_number">2730 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">2731 </span>
<span class="line_number">2732 </span>        nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2733 </span>        if <span class="sign">(</span>present<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2734 </span>            call <a href="#robo24">json_get_by_path</a><span class="sign">(</span>this<span class="sign">=</span>this<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> p<span class="sign">=</span>p<span class="sign">)</span>
<span class="line_number">2735 </span>        else
<span class="line_number">2736 </span>            p <span class="sign">=</span><span class="sign">&gt;</span> this
<span class="line_number">2737 </span>        end if
<span class="line_number">2738 </span>
<span class="line_number">2739 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2740 </span>
<span class="line_number">2741 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_integer</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">2742 </span>                                 <span class="squote">' Unable to resolve path: '</span><span class="sign">/</span><span class="sign">/</span> trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2743 </span>
<span class="line_number">2744 </span>        else
<span class="line_number">2745 </span>
<span class="line_number">2746 </span>            <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> p<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">2747 </span>                select case<span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>var_type<span class="sign">)</span>
<span class="line_number">2748 </span>                case <span class="sign">(</span>json_integer<span class="sign">)</span>
<span class="line_number">2749 </span>                    value <span class="sign">=</span> p<span class="sign">%</span>data<span class="sign">%</span>int_value
<span class="line_number">2750 </span>                case <span class="sign">(</span>json_real<span class="sign">)</span>
<span class="line_number">2751 </span>                    value <span class="sign">=</span> int<span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>dbl_value<span class="sign">)</span>
<span class="line_number">2752 </span>                case <span class="sign">(</span>json_logical<span class="sign">)</span>
<span class="line_number">2753 </span>                    if <span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>log_value<span class="sign">)</span> then
<span class="line_number">2754 </span>                        value <span class="sign">=</span> 1
<span class="line_number">2755 </span>                    else
<span class="line_number">2756 </span>                        value <span class="sign">=</span> 0
<span class="line_number">2757 </span>                    end if
<span class="line_number">2758 </span>                case default
<span class="line_number">2759 </span>                    call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in get_integer:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">2760 </span>                                         <span class="squote">' Unable to resolve value to integer: '</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">2761 </span>                                         trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2762 </span>                end select
<span class="line_number">2763 </span>            <span class="sign">!</span>end associate
<span class="line_number">2764 </span>
<span class="line_number">2765 </span>            nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2766 </span>
<span class="line_number">2767 </span>        end if
<span class="line_number">2768 </span>
<span class="line_number">2769 </span>        if <span class="sign">(</span>exception_thrown<span class="sign">)</span> then
<span class="line_number">2770 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2771 </span>                found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2772 </span>                call <a href="#robo19">json_clear_exceptions</a><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">2773 </span>            end if
<span class="line_number">2774 </span>        else
<span class="line_number">2775 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">2776 </span>        end if
<span class="line_number">2777 </span>
<span class="line_number">2778 </span>    else
<span class="line_number">2779 </span>
<span class="line_number">2780 </span>        value <span class="sign">=</span> 0
<span class="line_number">2781 </span>        if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2782 </span>
<span class="line_number">2783 </span>    end if
<span class="line_number">2784 </span>
<span class="line_number">2785 </span>    end subroutine <strong>json_get_integer</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fget5finteger5fvec"></a>
<a name="robo30"></a><h2>json_module/json_get_integer_vec [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_integer_vec</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get an integer vector from a JSON value.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 5/14/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2802 </span>    subroutine <strong>json_get_integer_vec</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">2803 </span>
<span class="line_number">2804 </span>    implicit none
<span class="line_number">2805 </span>
<span class="line_number">2806 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer                       <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">2807 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                     <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">2808 </span>    integer<span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> vec
<span class="line_number">2809 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                    <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">2810 </span>
<span class="line_number">2811 </span>    logical <span class="sign">:</span><span class="sign">:</span> initialized
<span class="line_number">2812 </span>
<span class="line_number">2813 </span>    initialized <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2814 </span>
<span class="line_number">2815 </span>    if <span class="sign">(</span>allocated<span class="sign">(</span>vec<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>vec<span class="sign">)</span>
<span class="line_number">2816 </span>
<span class="line_number">2817 </span>    <span class="sign">!</span>the callback function is called for each element of the array<span class="sign">:</span>
<span class="line_number">2818 </span>    call <a href="#robo22">json_get</a><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> array_callback<span class="sign">=</span>get_int_from_array<span class="sign">,</span> found<span class="sign">=</span>found<span class="sign">)</span>
<span class="line_number">2819 </span>
<span class="line_number">2820 </span>    contains
<span class="line_number">2821 </span>
<span class="line_number">2822 </span>        <span class="sign">!</span> callback function for integer
<span class="line_number">2823 </span>        subroutine get_int_from_array<span class="sign">(</span>element<span class="sign">,</span> i<span class="sign">,</span> count<span class="sign">)</span>
<span class="line_number">2824 </span>        implicit none
<span class="line_number">2825 </span>
<span class="line_number">2826 </span>        type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>     <span class="sign">:</span><span class="sign">:</span> element
<span class="line_number">2827 </span>        integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                      <span class="sign">:</span><span class="sign">:</span> i        <span class="sign">!</span>index
<span class="line_number">2828 </span>        integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                      <span class="sign">:</span><span class="sign">:</span> count    <span class="sign">!</span>size of array
<span class="line_number">2829 </span>
<span class="line_number">2830 </span>        <span class="sign">!</span>size the output array<span class="sign">:</span>
<span class="line_number">2831 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> initialized<span class="sign">)</span> then
<span class="line_number">2832 </span>            allocate<span class="sign">(</span>vec<span class="sign">(</span>count<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2833 </span>            initialized <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">2834 </span>        end if
<span class="line_number">2835 </span>
<span class="line_number">2836 </span>        <span class="sign">!</span>populate the elements<span class="sign">:</span>
<span class="line_number">2837 </span>        call <a href="#robo22">json_get</a><span class="sign">(</span>element<span class="sign">,</span> value<span class="sign">=</span>vec<span class="sign">(</span>i<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2838 </span>
<span class="line_number">2839 </span>        end subroutine get_int_from_array
</pre>

<hr />
<a name="json5fmodule2fjson5fget5flogical"></a>
<a name="robo31"></a><h2>json_module/json_get_logical [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_logical</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a logical value from an <a href="#robo44">json_value</a>.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2993 </span>    subroutine <strong>json_get_logical</strong><span class="sign">(</span>this<span class="sign">,</span> path<span class="sign">,</span> value<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">2994 </span>
<span class="line_number">2995 </span>    implicit none
<span class="line_number">2996 </span>
<span class="line_number">2997 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">2998 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>optional           <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">2999 </span>    logical                             <span class="sign">:</span><span class="sign">:</span> value
<span class="line_number">3000 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional        <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">3001 </span>
<span class="line_number">3002 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">3003 </span>
<span class="line_number">3004 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">3005 </span>
<span class="line_number">3006 </span>        nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">3007 </span>
<span class="line_number">3008 </span>        if <span class="sign">(</span>present<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3009 </span>            call <a href="#robo24">json_get_by_path</a><span class="sign">(</span>this<span class="sign">=</span>this<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> p<span class="sign">=</span>p<span class="sign">)</span>
<span class="line_number">3010 </span>        else
<span class="line_number">3011 </span>            p <span class="sign">=</span><span class="sign">&gt;</span> this
<span class="line_number">3012 </span>        end if
<span class="line_number">3013 </span>
<span class="line_number">3014 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3015 </span>
<span class="line_number">3016 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_logical</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3017 </span>                                 <span class="squote">' Unable to resolve path: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">3018 </span>
<span class="line_number">3019 </span>        else
<span class="line_number">3020 </span>
<span class="line_number">3021 </span>            <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> p<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3022 </span>                select case <span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>var_type<span class="sign">)</span>
<span class="line_number">3023 </span>                case <span class="sign">(</span>json_integer<span class="sign">)</span>
<span class="line_number">3024 </span>                    value <span class="sign">=</span> <span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>int_value <span class="sign">&gt;</span> 0<span class="sign">)</span>
<span class="line_number">3025 </span>                case <span class="sign">(</span>json_logical<span class="sign">)</span>
<span class="line_number">3026 </span>                    value <span class="sign">=</span> p<span class="sign">%</span>data <span class="sign">%</span> log_value
<span class="line_number">3027 </span>                case default
<span class="line_number">3028 </span>                    call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_logical</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3029 </span>                                         <span class="squote">' Unable to resolve value to logical: '</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3030 </span>                                         trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">3031 </span>                end select
<span class="line_number">3032 </span>            <span class="sign">!</span>end associate
<span class="line_number">3033 </span>
<span class="line_number">3034 </span>            nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">3035 </span>
<span class="line_number">3036 </span>        end if
<span class="line_number">3037 </span>
<span class="line_number">3038 </span>        if <span class="sign">(</span>exception_thrown<span class="sign">)</span> then
<span class="line_number">3039 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3040 </span>                found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">3041 </span>                call <a href="#robo19">json_clear_exceptions</a><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3042 </span>            end if
<span class="line_number">3043 </span>        else
<span class="line_number">3044 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">3045 </span>        end if
<span class="line_number">3046 </span>
<span class="line_number">3047 </span>    else
<span class="line_number">3048 </span>
<span class="line_number">3049 </span>        value <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">3050 </span>        if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">3051 </span>
<span class="line_number">3052 </span>    end if
<span class="line_number">3053 </span>
<span class="line_number">3054 </span>    end subroutine <strong>json_get_logical</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fget5flogical5fvec"></a>
<a name="robo32"></a><h2>json_module/json_get_logical_vec [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_logical_vec</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a logical vector from a JSON value.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 5/14/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3071 </span>    subroutine <strong>json_get_logical_vec</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">3072 </span>
<span class="line_number">3073 </span>    implicit none
<span class="line_number">3074 </span>
<span class="line_number">3075 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>            <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">3076 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                    <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">3077 </span>    logical<span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>   <span class="sign">:</span><span class="sign">:</span> vec
<span class="line_number">3078 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                   <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">3079 </span>
<span class="line_number">3080 </span>    logical <span class="sign">:</span><span class="sign">:</span> initialized
<span class="line_number">3081 </span>
<span class="line_number">3082 </span>    initialized <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">3083 </span>
<span class="line_number">3084 </span>    if <span class="sign">(</span>allocated<span class="sign">(</span>vec<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>vec<span class="sign">)</span>
<span class="line_number">3085 </span>
<span class="line_number">3086 </span>    <span class="sign">!</span>the callback function is called for each element of the array<span class="sign">:</span>
<span class="line_number">3087 </span>    call <a href="#robo22">json_get</a><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> array_callback<span class="sign">=</span>get_logical_from_array<span class="sign">,</span> found<span class="sign">=</span>found<span class="sign">)</span>
<span class="line_number">3088 </span>
<span class="line_number">3089 </span>    contains
<span class="line_number">3090 </span>
<span class="line_number">3091 </span>        <span class="sign">!</span> callback function for logical
<span class="line_number">3092 </span>        subroutine get_logical_from_array<span class="sign">(</span>element<span class="sign">,</span> i<span class="sign">,</span> count<span class="sign">)</span>
<span class="line_number">3093 </span>        implicit none
<span class="line_number">3094 </span>
<span class="line_number">3095 </span>        type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> element
<span class="line_number">3096 </span>        integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                   <span class="sign">:</span><span class="sign">:</span> i        <span class="sign">!</span>index
<span class="line_number">3097 </span>        integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                   <span class="sign">:</span><span class="sign">:</span> count    <span class="sign">!</span>size of array
<span class="line_number">3098 </span>
<span class="line_number">3099 </span>        <span class="sign">!</span>size the output array<span class="sign">:</span>
<span class="line_number">3100 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> initialized<span class="sign">)</span> then
<span class="line_number">3101 </span>            allocate<span class="sign">(</span>vec<span class="sign">(</span>count<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">3102 </span>            initialized <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">3103 </span>        end if
<span class="line_number">3104 </span>
<span class="line_number">3105 </span>        <span class="sign">!</span>populate the elements<span class="sign">:</span>
<span class="line_number">3106 </span>        call <a href="#robo22">json_get</a><span class="sign">(</span>element<span class="sign">,</span> value<span class="sign">=</span>vec<span class="sign">(</span>i<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">3107 </span>
<span class="line_number">3108 </span>        end subroutine get_logical_from_array
<span class="line_number">3109 </span>
<span class="line_number">3110 </span>    end subroutine <strong>json_get_logical_vec</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5finfo"></a>
<a name="robo33"></a><h2>json_module/json_info [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_info</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%info(path,found,var_type,n_children)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Returns information about a <a href="#robo44">json_value</a>
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 2/13/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">668 </span>    subroutine <strong>json_info</strong><span class="sign">(</span>p<span class="sign">,</span>var_type<span class="sign">,</span>n_children<span class="sign">)</span>
<span class="line_number">669 </span>
<span class="line_number">670 </span>    implicit none
<span class="line_number">671 </span>
<span class="line_number">672 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer        <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">673 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional    <span class="sign">:</span><span class="sign">:</span> var_type
<span class="line_number">674 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional    <span class="sign">:</span><span class="sign">:</span> n_children
<span class="line_number">675 </span>        
<span class="line_number">676 </span>    if <span class="sign">(</span>present<span class="sign">(</span>var_type<span class="sign">)</span><span class="sign">)</span>    var_type <span class="sign">=</span> p<span class="sign">%</span>data<span class="sign">%</span>var_type        <span class="sign">!</span>variable type
<span class="line_number">677 </span>    if <span class="sign">(</span>present<span class="sign">(</span>n_children<span class="sign">)</span><span class="sign">)</span>  n_children <span class="sign">=</span> <a href="#robo55">json_value_count</a><span class="sign">(</span>p<span class="sign">)</span>  <span class="sign">!</span>number of children
<span class="line_number">678 </span>    
<span class="line_number">679 </span>    end subroutine <strong>json_info</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5finitialize"></a>
<a name="robo34"></a><h2>json_module/json_initialize [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_initialize</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Initialize the module.
    Should be called before the routines are used.
    It can also be called after using the module and encountering exceptions.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/4/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">978 </span>    subroutine <strong>json_initialize</strong><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">979 </span>
<span class="line_number">980 </span>    implicit none
<span class="line_number">981 </span>
<span class="line_number">982 </span>    <span class="sign">!</span>clear any errors from previous runs<span class="sign">:</span>
<span class="line_number">983 </span>    call <a href="#robo19">json_clear_exceptions</a><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">984 </span>
<span class="line_number">985 </span>    <span class="sign">!</span>Just in case<span class="sign">,</span> clear these global variables also<span class="sign">:</span>
<span class="line_number">986 </span>    pushed_index <span class="sign">=</span> 0
<span class="line_number">987 </span>    pushed_char <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">988 </span>    char_count <span class="sign">=</span> 0
<span class="line_number">989 </span>    line_count <span class="sign">=</span> 1
<span class="line_number">990 </span>
<span class="line_number">991 </span>    end subroutine <strong>json_initialize</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fparse"></a>
<a name="robo35"></a><h2>json_module/json_parse [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_parse</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Parse the JSON file and populate the <a href="#robo44">json_value</a> tree.
</pre>
<p class="item_name">NOTES</p>
<pre>    When calling this routine, any exceptions thrown from previous
        calls will automatically be cleared.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3483 </span>    subroutine <strong>json_parse</strong><span class="sign">(</span>file<span class="sign">,</span> p<span class="sign">,</span> unit<span class="sign">)</span>
<span class="line_number">3484 </span>
<span class="line_number">3485 </span>    implicit none
<span class="line_number">3486 </span>
<span class="line_number">3487 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> file
<span class="line_number">3488 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer    <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">3489 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional <span class="sign">:</span><span class="sign">:</span> unit
<span class="line_number">3490 </span>
<span class="line_number">3491 </span>    integer <span class="sign">:</span><span class="sign">:</span> iunit<span class="sign">,</span> istat
<span class="line_number">3492 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable <span class="sign">:</span><span class="sign">:</span> line<span class="sign">,</span> arrow_str
<span class="line_number">3493 </span>    character<span class="sign">(</span>len<span class="sign">=</span>10<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> line_str<span class="sign">,</span> char_str
<span class="line_number">3494 </span>    logical <span class="sign">:</span><span class="sign">:</span> is_open
<span class="line_number">3495 </span>
<span class="line_number">3496 </span>    <span class="sign">!</span>clean any exceptions and initialize<span class="sign">:</span>
<span class="line_number">3497 </span>    call <a href="#robo34">json_initialize</a><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3498 </span>
<span class="line_number">3499 </span>    if <span class="sign">(</span>present<span class="sign">(</span>unit<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3500 </span>        
<span class="line_number">3501 </span>        iunit <span class="sign">=</span> unit   
<span class="line_number">3502 </span>        
<span class="line_number">3503 </span>        <span class="sign">!</span>check to see if the file is already open
<span class="line_number">3504 </span>        <span class="sign">!</span> if it is<span class="sign">,</span> then use it<span class="sign">,</span> otherwise open the file<span class="sign">.</span>
<span class="line_number">3505 </span>        inquire<span class="sign">(</span>unit<span class="sign">=</span>iunit<span class="sign">,</span> opened<span class="sign">=</span>is_open<span class="sign">,</span> iostat<span class="sign">=</span>istat<span class="sign">)</span>
<span class="line_number">3506 </span>        if <span class="sign">(</span>istat<span class="sign">=</span><span class="sign">=</span>0 <span class="sign">.</span>and<span class="sign">.</span> <span class="sign">.</span>not<span class="sign">.</span> is_open<span class="sign">)</span> then
<span class="line_number">3507 </span>           <span class="sign">!</span> open the file
<span class="line_number">3508 </span>            open <span class="sign">(</span>  unit        <span class="sign">=</span> iunit<span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">3509 </span>                    file        <span class="sign">=</span> file<span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">3510 </span>                    status      <span class="sign">=</span> <span class="squote">'OLD'</span><span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">3511 </span>                    action      <span class="sign">=</span> <span class="squote">'READ'</span><span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">3512 </span>                    form        <span class="sign">=</span> <span class="squote">'FORMATTED'</span><span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">3513 </span>                    position    <span class="sign">=</span> <span class="squote">'REWIND'</span><span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">3514 </span>                    iostat      <span class="sign">=</span> istat<span class="sign">)</span>
<span class="line_number">3515 </span>        end if
<span class="line_number">3516 </span>        
<span class="line_number">3517 </span>    else
<span class="line_number">3518 </span>    
<span class="line_number">3519 </span>        <span class="sign">!</span> open the file with a new unit number<span class="sign">:</span>
<span class="line_number">3520 </span>        open <span class="sign">(</span>  newunit     <span class="sign">=</span> iunit<span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">3521 </span>                file        <span class="sign">=</span> file<span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">3522 </span>                status      <span class="sign">=</span> <span class="squote">'OLD'</span><span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">3523 </span>                action      <span class="sign">=</span> <span class="squote">'READ'</span><span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">3524 </span>                form        <span class="sign">=</span> <span class="squote">'FORMATTED'</span><span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">3525 </span>                position    <span class="sign">=</span> <span class="squote">'REWIND'</span><span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">3526 </span>                iostat      <span class="sign">=</span> istat<span class="sign">)</span>
<span class="line_number">3527 </span>    
<span class="line_number">3528 </span>    end if
<span class="line_number">3529 </span>
<span class="line_number">3530 </span>    if <span class="sign">(</span>istat<span class="sign">=</span><span class="sign">=</span>0<span class="sign">)</span> then
<span class="line_number">3531 </span>
<span class="line_number">3532 </span>        <span class="sign">!</span> create the value and associate the pointer
<span class="line_number">3533 </span>        call <a href="#robo56">json_value_create</a><span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">3534 </span>
<span class="line_number">3535 </span>        <span class="sign">!</span>add the file name as the name of the overall structure<span class="sign">:</span>
<span class="line_number">3536 </span>        p<span class="sign">%</span>name <span class="sign">=</span> trim<span class="sign">(</span>file<span class="sign">)</span>
<span class="line_number">3537 </span>
<span class="line_number">3538 </span>        <span class="sign">!</span> parse as a value
<span class="line_number">3539 </span>        call <a href="#robo65">parse_value</a><span class="sign">(</span>unit <span class="sign">=</span> iunit<span class="sign">,</span> value <span class="sign">=</span> p<span class="sign">)</span>
<span class="line_number">3540 </span>
<span class="line_number">3541 </span>        <span class="sign">!</span>
<span class="line_number">3542 </span>        <span class="sign">!</span>  If there was an error reading the file<span class="sign">,</span> then
<span class="line_number">3543 </span>        <span class="sign">!</span>   can print the line where the error occurred<span class="sign">:</span>
<span class="line_number">3544 </span>        <span class="sign">!</span>
<span class="line_number">3545 </span>        if <span class="sign">(</span>exception_thrown<span class="sign">)</span> then
<span class="line_number">3546 </span>        
<span class="line_number">3547 </span>            call <a href="#robo9">get_current_line_from_file</a><span class="sign">(</span>iunit<span class="sign">,</span>line<span class="sign">)</span>
<span class="line_number">3548 </span>            
<span class="line_number">3549 </span>            <span class="sign">!</span>the counters for the current line and the last character read<span class="sign">:</span>
<span class="line_number">3550 </span>            call <a href="#robo17">integer_to_string</a><span class="sign">(</span>line_count<span class="sign">,</span> line_str<span class="sign">)</span>
<span class="line_number">3551 </span>            call <a href="#robo17">integer_to_string</a><span class="sign">(</span>char_count<span class="sign">,</span> char_str<span class="sign">)</span>
<span class="line_number">3552 </span>            
<span class="line_number">3553 </span>            <span class="sign">!</span>draw the arrow string that points to the current character<span class="sign">:</span>
<span class="line_number">3554 </span>            arrow_str <span class="sign">=</span> repeat<span class="sign">(</span><span class="squote">'-'</span><span class="sign">,</span>max<span class="sign">(</span> 0<span class="sign">,</span> char_count <span class="sign">-</span> 1<span class="sign">)</span> <span class="sign">)</span><span class="sign">/</span><span class="sign">/</span><span class="squote">'^'</span>
<span class="line_number">3555 </span>
<span class="line_number">3556 </span>            <span class="sign">!</span>create the error message<span class="sign">:</span>
<span class="line_number">3557 </span>            err_message <span class="sign">=</span> err_message<span class="sign">/</span><span class="sign">/</span>newline<span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3558 </span>                           <span class="squote">'line: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>adjustl<span class="sign">(</span>line_str<span class="sign">)</span><span class="sign">)</span><span class="sign">/</span><span class="sign">/</span><span class="squote">', '</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3559 </span>                           <span class="squote">'character: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>adjustl<span class="sign">(</span>char_str<span class="sign">)</span><span class="sign">)</span><span class="sign">/</span><span class="sign">/</span>newline<span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3560 </span>                           trim<span class="sign">(</span>line<span class="sign">)</span><span class="sign">/</span><span class="sign">/</span>newline<span class="sign">/</span><span class="sign">/</span>arrow_str
<span class="line_number">3561 </span>                                        
<span class="line_number">3562 </span>            if <span class="sign">(</span>allocated<span class="sign">(</span>line<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>line<span class="sign">)</span>
<span class="line_number">3563 </span>                        
<span class="line_number">3564 </span>        end if
<span class="line_number">3565 </span>
<span class="line_number">3566 </span>        <span class="sign">!</span> close the file
<span class="line_number">3567 </span>        close <span class="sign">(</span>iunit<span class="sign">,</span> iostat<span class="sign">=</span>istat<span class="sign">)</span>
<span class="line_number">3568 </span>
<span class="line_number">3569 </span>    else
<span class="line_number">3570 </span>
<span class="line_number">3571 </span>        call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_parse</strong>: Error opening file: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>file<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">3572 </span>
<span class="line_number">3573 </span>    end if
<span class="line_number">3574 </span>
<span class="line_number">3575 </span>    end subroutine <strong>json_parse</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fprint"></a>
<a name="robo36"></a><h2>json_module/json_print [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_print</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Print the <a href="#robo44">json_value</a> to a file.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    type(<a href="#robo44">json_value</a>) :: p
    ...
    call <strong>json_print</strong>(p,'test.json')  !this is <a href="#robo38">json_print_2</a>
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">367 </span>    interface <strong>json_print</strong>
<span class="line_number">368 </span>        module procedure <span class="sign">:</span><span class="sign">:</span> <a href="#robo37">json_print_1</a>    <span class="sign">!</span>input is unit number
<span class="line_number">369 </span>        module procedure <span class="sign">:</span><span class="sign">:</span> <a href="#robo38">json_print_2</a>    <span class="sign">!</span>input is file name
<span class="line_number">370 </span>    end interface
</pre>

<hr />
<a name="json5fmodule2fjson5fprint5f1"></a>
<a name="robo37"></a><h2>json_module/json_print_1 [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_print_1</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Print the JSON structure to a file
    Input is the nonzero file unit (the file must already have been opened).
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams, 6/20/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2174 </span>    subroutine <strong>json_print_1</strong><span class="sign">(</span>me<span class="sign">,</span>iunit<span class="sign">)</span>
<span class="line_number">2175 </span>    
<span class="line_number">2176 </span>    implicit none
<span class="line_number">2177 </span>    
<span class="line_number">2178 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">2179 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> iunit                   <span class="sign">!</span>must be non<span class="sign">-</span>zero
<span class="line_number">2180 </span>    
<span class="line_number">2181 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable <span class="sign">:</span><span class="sign">:</span> dummy
<span class="line_number">2182 </span>    
<span class="line_number">2183 </span>    if <span class="sign">(</span>iunit<span class="sign">/</span><span class="sign">=</span>0<span class="sign">)</span> then
<span class="line_number">2184 </span>        call json_value_print<span class="sign">(</span>me<span class="sign">,</span>iunit<span class="sign">,</span>str<span class="sign">=</span>dummy<span class="sign">)</span>
<span class="line_number">2185 </span>    else
<span class="line_number">2186 </span>        call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <a href="#robo36">json_print</a>: iunit must be nonzero.'</span><span class="sign">)</span>
<span class="line_number">2187 </span>    end if
<span class="line_number">2188 </span>    
<span class="line_number">2189 </span>    end subroutine <strong>json_print_1</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fprint5f2"></a>
<a name="robo38"></a><h2>json_module/json_print_2 [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_print_2</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Print the JSON structure to a file.
    Input is the filename.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams, 12/23/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2206 </span>    subroutine <strong>json_print_2</strong><span class="sign">(</span>me<span class="sign">,</span>filename<span class="sign">)</span>
<span class="line_number">2207 </span>    
<span class="line_number">2208 </span>    implicit none
<span class="line_number">2209 </span>    
<span class="line_number">2210 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">2211 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> filename
<span class="line_number">2212 </span>    
<span class="line_number">2213 </span>    integer <span class="sign">:</span><span class="sign">:</span> iunit<span class="sign">,</span>istat
<span class="line_number">2214 </span>    
<span class="line_number">2215 </span>    open<span class="sign">(</span>newunit<span class="sign">=</span>iunit<span class="sign">,</span>file<span class="sign">=</span>filename<span class="sign">,</span>status<span class="sign">=</span><span class="squote">'REPLACE'</span><span class="sign">,</span>iostat<span class="sign">=</span>istat<span class="sign">)</span>
<span class="line_number">2216 </span>    if <span class="sign">(</span>istat<span class="sign">=</span><span class="sign">=</span>0<span class="sign">)</span> then
<span class="line_number">2217 </span>        call <a href="#robo36">json_print</a><span class="sign">(</span>me<span class="sign">,</span>iunit<span class="sign">)</span>
<span class="line_number">2218 </span>        close<span class="sign">(</span>iunit<span class="sign">,</span>iostat<span class="sign">=</span>istat<span class="sign">)</span>
<span class="line_number">2219 </span>    else
<span class="line_number">2220 </span>        call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <a href="#robo36">json_print</a>: could not open file: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>filename<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2221 </span>    end if
<span class="line_number">2222 </span>    
<span class="line_number">2223 </span>    end subroutine <strong>json_print_2</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fupdate"></a>
<a name="robo39"></a><h2>json_module/json_update [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_update</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    These are like <a href="#robo45">json_value_add</a>, except if a child with the same name is
     already present, then its value is simply updated.
    Note that currently, these only work for scalar variables.
    These routines can also change the variable's type (but an error will be 
     thrown if the existing variable is not a scalar).
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">320 </span>    interface <strong>json_update</strong>
<span class="line_number">321 </span>        module procedure <span class="sign">:</span><span class="sign">:</span> <a href="#robo42">json_update_logical</a><span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">322 </span>                            <a href="#robo43">json_update_real</a><span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">323 </span>                            <a href="#robo41">json_update_integer</a><span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">324 </span>                            <a href="#robo40">json_update_chars</a>
<span class="line_number">325 </span>    end interface <strong>json_update</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fupdate5fchars"></a>
<a name="robo40"></a><h2>json_module/json_update_chars [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_update_chars</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    If the child variable is present, and is a scalar, then update its value.
    If it is not present, then create it and set its value.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/6/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1473 </span>    subroutine <strong>json_update_chars</strong><span class="sign">(</span>p<span class="sign">,</span>name<span class="sign">,</span>val<span class="sign">,</span>found<span class="sign">)</span>
<span class="line_number">1474 </span>     
<span class="line_number">1475 </span>    implicit none
<span class="line_number">1476 </span>    
<span class="line_number">1477 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer   <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">1478 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1479 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1480 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>         <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">1481 </span>    
<span class="line_number">1482 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> p_var
<span class="line_number">1483 </span>    integer <span class="sign">:</span><span class="sign">:</span> var_type
<span class="line_number">1484 </span> 
<span class="line_number">1485 </span>    call <a href="#robo22">json_get</a><span class="sign">(</span>p<span class="sign">,</span>name<span class="sign">,</span>p_var<span class="sign">,</span>found<span class="sign">)</span>
<span class="line_number">1486 </span>    if <span class="sign">(</span>found<span class="sign">)</span> then
<span class="line_number">1487 </span>
<span class="line_number">1488 </span>        call <a href="#robo33">json_info</a><span class="sign">(</span>p_var<span class="sign">,</span>var_type<span class="sign">)</span>
<span class="line_number">1489 </span>        select case <span class="sign">(</span>var_type<span class="sign">)</span>
<span class="line_number">1490 </span>        case <span class="sign">(</span>json_null<span class="sign">,</span>json_logical<span class="sign">,</span>json_integer<span class="sign">,</span>json_real<span class="sign">,</span>json_string<span class="sign">)</span>
<span class="line_number">1491 </span>            call <a href="#robo76">to_string</a><span class="sign">(</span>p_var<span class="sign">,</span>val<span class="sign">)</span>    <span class="sign">!</span>update the value
<span class="line_number">1492 </span>        case default
<span class="line_number">1493 </span>            found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">1494 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_update_chars</strong>: '</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">1495 </span>                                 <span class="squote">'the variable is not a scalar value'</span><span class="sign">)</span>
<span class="line_number">1496 </span>        end select          
<span class="line_number">1497 </span>
<span class="line_number">1498 </span>    else
<span class="line_number">1499 </span>        call <a href="#robo45">json_value_add</a><span class="sign">(</span>p<span class="sign">,</span>name<span class="sign">,</span>val<span class="sign">)</span>   <span class="sign">!</span>add the new element
<span class="line_number">1500 </span>    end if
<span class="line_number">1501 </span>                     
<span class="line_number">1502 </span>    end subroutine <strong>json_update_chars</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fupdate5finteger"></a>
<a name="robo41"></a><h2>json_module/json_update_integer [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_update_integer</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    If the child variable is present, and is a scalar, then update its value.
    If it is not present, then create it and set its value.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/6/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1426 </span>    subroutine <strong>json_update_integer</strong><span class="sign">(</span>p<span class="sign">,</span>name<span class="sign">,</span>val<span class="sign">,</span>found<span class="sign">)</span>
<span class="line_number">1427 </span>
<span class="line_number">1428 </span>    implicit none
<span class="line_number">1429 </span>    
<span class="line_number">1430 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer   <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">1431 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1432 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>          <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1433 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>         <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">1434 </span>    
<span class="line_number">1435 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> p_var
<span class="line_number">1436 </span>    integer <span class="sign">:</span><span class="sign">:</span> var_type
<span class="line_number">1437 </span> 
<span class="line_number">1438 </span>    call <a href="#robo22">json_get</a><span class="sign">(</span>p<span class="sign">,</span>name<span class="sign">,</span>p_var<span class="sign">,</span>found<span class="sign">)</span>
<span class="line_number">1439 </span>    if <span class="sign">(</span>found<span class="sign">)</span> then
<span class="line_number">1440 </span>
<span class="line_number">1441 </span>        call <a href="#robo33">json_info</a><span class="sign">(</span>p_var<span class="sign">,</span>var_type<span class="sign">)</span>
<span class="line_number">1442 </span>        select case <span class="sign">(</span>var_type<span class="sign">)</span>
<span class="line_number">1443 </span>        case <span class="sign">(</span>json_null<span class="sign">,</span>json_logical<span class="sign">,</span>json_integer<span class="sign">,</span>json_real<span class="sign">,</span>json_string<span class="sign">)</span>
<span class="line_number">1444 </span>            call <a href="#robo71">to_integer</a><span class="sign">(</span>p_var<span class="sign">,</span>val<span class="sign">)</span>    <span class="sign">!</span>update the value
<span class="line_number">1445 </span>        case default
<span class="line_number">1446 </span>            found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">1447 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_update_integer</strong>: '</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">1448 </span>                                 <span class="squote">'the variable is not a scalar value'</span><span class="sign">)</span>
<span class="line_number">1449 </span>        end select          
<span class="line_number">1450 </span>
<span class="line_number">1451 </span>    else
<span class="line_number">1452 </span>        call <a href="#robo45">json_value_add</a><span class="sign">(</span>p<span class="sign">,</span>name<span class="sign">,</span>val<span class="sign">)</span>   <span class="sign">!</span>add the new element
<span class="line_number">1453 </span>    end if
<span class="line_number">1454 </span>                     
<span class="line_number">1455 </span>    end subroutine <strong>json_update_integer</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fupdate5flogical"></a>
<a name="robo42"></a><h2>json_module/json_update_logical [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_update_logical</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    If the child variable is present, and is a scalar, then update its value.
    If it is not present, then create it and set its value.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/6/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1332 </span>    subroutine <strong>json_update_logical</strong><span class="sign">(</span>p<span class="sign">,</span>name<span class="sign">,</span>val<span class="sign">,</span>found<span class="sign">)</span>
<span class="line_number">1333 </span>     
<span class="line_number">1334 </span>    implicit none
<span class="line_number">1335 </span>    
<span class="line_number">1336 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer   <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">1337 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1338 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>          <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1339 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>         <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">1340 </span>    
<span class="line_number">1341 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> p_var
<span class="line_number">1342 </span>    integer <span class="sign">:</span><span class="sign">:</span> var_type
<span class="line_number">1343 </span> 
<span class="line_number">1344 </span>    call <a href="#robo22">json_get</a><span class="sign">(</span>p<span class="sign">,</span>name<span class="sign">,</span>p_var<span class="sign">,</span>found<span class="sign">)</span>
<span class="line_number">1345 </span>    if <span class="sign">(</span>found<span class="sign">)</span> then
<span class="line_number">1346 </span>
<span class="line_number">1347 </span>        call <a href="#robo33">json_info</a><span class="sign">(</span>p_var<span class="sign">,</span>var_type<span class="sign">)</span>
<span class="line_number">1348 </span>        select case <span class="sign">(</span>var_type<span class="sign">)</span>
<span class="line_number">1349 </span>        case <span class="sign">(</span>json_null<span class="sign">,</span>json_logical<span class="sign">,</span>json_integer<span class="sign">,</span>json_real<span class="sign">,</span>json_string<span class="sign">)</span>
<span class="line_number">1350 </span>            call <a href="#robo72">to_logical</a><span class="sign">(</span>p_var<span class="sign">,</span>val<span class="sign">)</span>    <span class="sign">!</span>update the value
<span class="line_number">1351 </span>        case default
<span class="line_number">1352 </span>            found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">1353 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_update_logical</strong>: '</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">1354 </span>                                 <span class="squote">'the variable is not a scalar value'</span><span class="sign">)</span>
<span class="line_number">1355 </span>        end select          
<span class="line_number">1356 </span>
<span class="line_number">1357 </span>    else
<span class="line_number">1358 </span>        call <a href="#robo45">json_value_add</a><span class="sign">(</span>p<span class="sign">,</span>name<span class="sign">,</span>val<span class="sign">)</span>   <span class="sign">!</span>add the new element
<span class="line_number">1359 </span>    end if
<span class="line_number">1360 </span>                     
<span class="line_number">1361 </span>    end subroutine <strong>json_update_logical</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fupdate5freal"></a>
<a name="robo43"></a><h2>json_module/json_update_real [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_update_real</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    If the child variable is present, and is a scalar, then update its value.
    If it is not present, then create it and set its value.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/6/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1379 </span>    subroutine <strong>json_update_real</strong><span class="sign">(</span>p<span class="sign">,</span>name<span class="sign">,</span>val<span class="sign">,</span>found<span class="sign">)</span>
<span class="line_number">1380 </span>     
<span class="line_number">1381 </span>    implicit none
<span class="line_number">1382 </span>    
<span class="line_number">1383 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer   <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">1384 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1385 </span>    real<span class="sign">(</span>wp<span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>         <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1386 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>         <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">1387 </span>    
<span class="line_number">1388 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> p_var
<span class="line_number">1389 </span>    integer <span class="sign">:</span><span class="sign">:</span> var_type
<span class="line_number">1390 </span> 
<span class="line_number">1391 </span>    call <a href="#robo22">json_get</a><span class="sign">(</span>p<span class="sign">,</span>name<span class="sign">,</span>p_var<span class="sign">,</span>found<span class="sign">)</span>
<span class="line_number">1392 </span>    if <span class="sign">(</span>found<span class="sign">)</span> then
<span class="line_number">1393 </span>
<span class="line_number">1394 </span>        call <a href="#robo33">json_info</a><span class="sign">(</span>p_var<span class="sign">,</span>var_type<span class="sign">)</span>
<span class="line_number">1395 </span>        select case <span class="sign">(</span>var_type<span class="sign">)</span>
<span class="line_number">1396 </span>        case <span class="sign">(</span>json_null<span class="sign">,</span>json_logical<span class="sign">,</span>json_integer<span class="sign">,</span>json_real<span class="sign">,</span>json_string<span class="sign">)</span>
<span class="line_number">1397 </span>            call <a href="#robo75">to_real</a><span class="sign">(</span>p_var<span class="sign">,</span>val<span class="sign">)</span>    <span class="sign">!</span>update the value
<span class="line_number">1398 </span>        case default
<span class="line_number">1399 </span>            found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">1400 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_update_real</strong>: '</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">1401 </span>                                 <span class="squote">'the variable is not a scalar value'</span><span class="sign">)</span>
<span class="line_number">1402 </span>        end select          
<span class="line_number">1403 </span>
<span class="line_number">1404 </span>    else
<span class="line_number">1405 </span>        call <a href="#robo45">json_value_add</a><span class="sign">(</span>p<span class="sign">,</span>name<span class="sign">,</span>val<span class="sign">)</span>   <span class="sign">!</span>add the new element
<span class="line_number">1406 </span>    end if
<span class="line_number">1407 </span>                     
<span class="line_number">1408 </span>    end subroutine <strong>json_update_real</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue"></a>
<a name="robo44"></a><h2>json_module/json_value [ Classes ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_classes.html#robo_top_of_doc">Classes</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Type used to construct the linked-list json structure
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    type(<strong>json_value</strong>),pointer :: p
    call <a href="#robo56">json_value_create</a>(p) 
    call <a href="#robo74">to_object</a>(p) 
    call <a href="#robo45">json_value_add</a>(p,'year',1805)
    call <a href="#robo45">json_value_add</a>(p,'value',1.0_wp)
    call <a href="#robo36">json_print</a>(p,'test.json')
    call json_destroy(p)
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">174 </span>        type<span class="sign">,</span>public <span class="sign">:</span><span class="sign">:</span> <strong>json_value</strong>
<span class="line_number">175 </span>
<span class="line_number">176 </span>        <span class="sign">!</span>variable name<span class="sign">:</span>
<span class="line_number">177 </span>        character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">178 </span>
<span class="line_number">179 </span>        <span class="sign">!</span>the data for this variable<span class="sign">:</span>
<span class="line_number">180 </span>        type<span class="sign">(</span>json_data_non_polymorphic<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> data
<span class="line_number">181 </span>
<span class="line_number">182 </span>        <span class="sign">!</span>for the linked list<span class="sign">:</span>
<span class="line_number">183 </span>        type<span class="sign">(</span><strong>json_value</strong><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> previous <span class="sign">=</span><span class="sign">&gt;</span> null<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">184 </span>        type<span class="sign">(</span><strong>json_value</strong><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> next <span class="sign">=</span><span class="sign">&gt;</span> null<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">185 </span>        type<span class="sign">(</span><strong>json_value</strong><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> parent <span class="sign">=</span><span class="sign">&gt;</span> null<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">186 </span>        type<span class="sign">(</span><strong>json_value</strong><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> children <span class="sign">=</span><span class="sign">&gt;</span> null<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">187 </span>
<span class="line_number">188 </span>        end type <strong>json_value</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fadd"></a>
<a name="robo45"></a><h2>json_module/json_value_add [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_add</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Add objects to a linked list of json_values.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">297 </span>    interface <strong>json_value_add</strong>
<span class="line_number">298 </span>        module procedure <span class="sign">:</span><span class="sign">:</span> <a href="#robo50">json_value_add_member</a>
<span class="line_number">299 </span>        module procedure <span class="sign">:</span><span class="sign">:</span> <a href="#robo46">json_value_add_integer</a><span class="sign">,</span> <a href="#robo47">json_value_add_integer_vec</a>
<span class="line_number">300 </span>        module procedure <span class="sign">:</span><span class="sign">:</span> <a href="#robo51">json_value_add_real</a><span class="sign">,</span>    <a href="#robo52">json_value_add_real_vec</a>
<span class="line_number">301 </span>        module procedure <span class="sign">:</span><span class="sign">:</span> <a href="#robo48">json_value_add_logical</a><span class="sign">,</span> <a href="#robo49">json_value_add_logical_vec</a>
<span class="line_number">302 </span>        module procedure <span class="sign">:</span><span class="sign">:</span> <a href="#robo53">json_value_add_string</a><span class="sign">,</span>  <a href="#robo54">json_value_add_string_vec</a>
<span class="line_number">303 </span>    end interface <strong>json_value_add</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fadd5finteger"></a>
<a name="robo46"></a><h2>json_module/json_value_add_integer [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_add_integer</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Add an integer value to the structure.

    These routines are part of the public API that can be
        used to build a json structure using data.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/20/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1660 </span>    subroutine <strong>json_value_add_integer</strong><span class="sign">(</span>me<span class="sign">,</span> name<span class="sign">,</span> val<span class="sign">)</span>
<span class="line_number">1661 </span>
<span class="line_number">1662 </span>    implicit none
<span class="line_number">1663 </span>
<span class="line_number">1664 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer     <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">1665 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>   <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1666 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>            <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1667 </span>
<span class="line_number">1668 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> var
<span class="line_number">1669 </span>
<span class="line_number">1670 </span>    <span class="sign">!</span>create the variable<span class="sign">:</span>
<span class="line_number">1671 </span>    call <a href="#robo56">json_value_create</a><span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1672 </span>    call <a href="#robo71">to_integer</a><span class="sign">(</span>var<span class="sign">,</span>val<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">1673 </span>
<span class="line_number">1674 </span>    <span class="sign">!</span>add it<span class="sign">:</span>
<span class="line_number">1675 </span>    call <a href="#robo45">json_value_add</a><span class="sign">(</span>me<span class="sign">,</span> var<span class="sign">)</span>
<span class="line_number">1676 </span>
<span class="line_number">1677 </span>    <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">1678 </span>    nullify<span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1679 </span>
<span class="line_number">1680 </span>    end subroutine <strong>json_value_add_integer</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fadd5finteger5fvec"></a>
<a name="robo47"></a><h2>json_module/json_value_add_integer_vec [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_add_integer_vec</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Add an integer vector to the structure.

    These routines are part of the public API that can be
        used to build a json structure using data.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/20/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1700 </span>    subroutine <strong>json_value_add_integer_vec</strong><span class="sign">(</span>me<span class="sign">,</span> name<span class="sign">,</span> val<span class="sign">)</span>
<span class="line_number">1701 </span>
<span class="line_number">1702 </span>    implicit none
<span class="line_number">1703 </span>
<span class="line_number">1704 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer       <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">1705 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>     <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1706 </span>    integer<span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1707 </span>
<span class="line_number">1708 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> var
<span class="line_number">1709 </span>    integer <span class="sign">:</span><span class="sign">:</span> i    <span class="sign">!</span>counter
<span class="line_number">1710 </span>
<span class="line_number">1711 </span>    <span class="sign">!</span>create the variable as an array<span class="sign">:</span>
<span class="line_number">1712 </span>    call <a href="#robo56">json_value_create</a><span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1713 </span>    call <a href="#robo70">to_array</a><span class="sign">(</span>var<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">1714 </span>
<span class="line_number">1715 </span>    <span class="sign">!</span>populate the array<span class="sign">:</span>
<span class="line_number">1716 </span>    do i<span class="sign">=</span>1<span class="sign">,</span>size<span class="sign">(</span>val<span class="sign">)</span>
<span class="line_number">1717 </span>        call <a href="#robo45">json_value_add</a><span class="sign">(</span>var<span class="sign">,</span> <span class="squote">''</span><span class="sign">,</span> val<span class="sign">(</span>i<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">1718 </span>    end do
<span class="line_number">1719 </span>
<span class="line_number">1720 </span>    <span class="sign">!</span>add it<span class="sign">:</span>
<span class="line_number">1721 </span>    call <a href="#robo45">json_value_add</a><span class="sign">(</span>me<span class="sign">,</span> var<span class="sign">)</span>
<span class="line_number">1722 </span>
<span class="line_number">1723 </span>    <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">1724 </span>    nullify<span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1725 </span>
<span class="line_number">1726 </span>    end subroutine <strong>json_value_add_integer_vec</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fadd5flogical"></a>
<a name="robo48"></a><h2>json_module/json_value_add_logical [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_add_logical</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Add a logical value to the structure.

    These routines are part of the public API that can be
        used to build a json structure using data.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/20/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1746 </span>    subroutine <strong>json_value_add_logical</strong><span class="sign">(</span>me<span class="sign">,</span> name<span class="sign">,</span> val<span class="sign">)</span>
<span class="line_number">1747 </span>
<span class="line_number">1748 </span>    implicit none
<span class="line_number">1749 </span>
<span class="line_number">1750 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer   <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">1751 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1752 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>          <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1753 </span>
<span class="line_number">1754 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> var
<span class="line_number">1755 </span>
<span class="line_number">1756 </span>    <span class="sign">!</span>create the variable<span class="sign">:</span>
<span class="line_number">1757 </span>    call <a href="#robo56">json_value_create</a><span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1758 </span>    call <a href="#robo72">to_logical</a><span class="sign">(</span>var<span class="sign">,</span>val<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">1759 </span>
<span class="line_number">1760 </span>    <span class="sign">!</span>add it<span class="sign">:</span>
<span class="line_number">1761 </span>    call <a href="#robo45">json_value_add</a><span class="sign">(</span>me<span class="sign">,</span> var<span class="sign">)</span>
<span class="line_number">1762 </span>
<span class="line_number">1763 </span>    <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">1764 </span>    nullify<span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1765 </span>
<span class="line_number">1766 </span>    end subroutine <strong>json_value_add_logical</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fadd5flogical5fvec"></a>
<a name="robo49"></a><h2>json_module/json_value_add_logical_vec [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_add_logical_vec</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Add a logical vector to the structure.

    These routines are part of the public API that can be
        used to build a json structure using data.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/20/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1786 </span>    subroutine <strong>json_value_add_logical_vec</strong><span class="sign">(</span>me<span class="sign">,</span> name<span class="sign">,</span> val<span class="sign">)</span>
<span class="line_number">1787 </span>
<span class="line_number">1788 </span>    implicit none
<span class="line_number">1789 </span>
<span class="line_number">1790 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer       <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">1791 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>     <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1792 </span>    logical<span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1793 </span>
<span class="line_number">1794 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> var
<span class="line_number">1795 </span>    integer <span class="sign">:</span><span class="sign">:</span> i    <span class="sign">!</span>counter
<span class="line_number">1796 </span>
<span class="line_number">1797 </span>    <span class="sign">!</span>create the variable as an array<span class="sign">:</span>
<span class="line_number">1798 </span>    call <a href="#robo56">json_value_create</a><span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1799 </span>    call <a href="#robo70">to_array</a><span class="sign">(</span>var<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">1800 </span>
<span class="line_number">1801 </span>    <span class="sign">!</span>populate the array<span class="sign">:</span>
<span class="line_number">1802 </span>    do i<span class="sign">=</span>1<span class="sign">,</span>size<span class="sign">(</span>val<span class="sign">)</span>
<span class="line_number">1803 </span>        call <a href="#robo45">json_value_add</a><span class="sign">(</span>var<span class="sign">,</span> <span class="squote">''</span><span class="sign">,</span> val<span class="sign">(</span>i<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">1804 </span>    end do
<span class="line_number">1805 </span>
<span class="line_number">1806 </span>    <span class="sign">!</span>add it<span class="sign">:</span>
<span class="line_number">1807 </span>    call <a href="#robo45">json_value_add</a><span class="sign">(</span>me<span class="sign">,</span> var<span class="sign">)</span>
<span class="line_number">1808 </span>
<span class="line_number">1809 </span>    <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">1810 </span>    nullify<span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1811 </span>
<span class="line_number">1812 </span>    end subroutine <strong>json_value_add_logical_vec</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fadd5fmember"></a>
<a name="robo50"></a><h2>json_module/json_value_add_member [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_add_member</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Adds the member as a child of this.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1516 </span>    subroutine <strong>json_value_add_member</strong><span class="sign">(</span>this<span class="sign">,</span> member<span class="sign">)</span>
<span class="line_number">1517 </span>
<span class="line_number">1518 </span>    implicit none
<span class="line_number">1519 </span>
<span class="line_number">1520 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> this<span class="sign">,</span> member
<span class="line_number">1521 </span>
<span class="line_number">1522 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">1523 </span>
<span class="line_number">1524 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">1525 </span>
<span class="line_number">1526 </span>        nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">1527 </span>
<span class="line_number">1528 </span>        <span class="sign">!</span> associate the parent
<span class="line_number">1529 </span>        member <span class="sign">%</span> parent <span class="sign">=</span><span class="sign">&gt;</span> this
<span class="line_number">1530 </span>
<span class="line_number">1531 </span>        <span class="sign">!</span> add to linked list
<span class="line_number">1532 </span>        if <span class="sign">(</span>associated<span class="sign">(</span>this <span class="sign">%</span> children<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1533 </span>
<span class="line_number">1534 </span>            <span class="sign">!</span> get to the tail of the linked list
<span class="line_number">1535 </span>            p <span class="sign">=</span><span class="sign">&gt;</span> this <span class="sign">%</span> children
<span class="line_number">1536 </span>            do while <span class="sign">(</span>associated<span class="sign">(</span>p <span class="sign">%</span> next<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">1537 </span>                p <span class="sign">=</span><span class="sign">&gt;</span> p <span class="sign">%</span> next
<span class="line_number">1538 </span>            end do
<span class="line_number">1539 </span>
<span class="line_number">1540 </span>            p<span class="sign">%</span>next <span class="sign">=</span><span class="sign">&gt;</span> member
<span class="line_number">1541 </span>            member<span class="sign">%</span>previous <span class="sign">=</span><span class="sign">&gt;</span> p
<span class="line_number">1542 </span>
<span class="line_number">1543 </span>            nullify<span class="sign">(</span>p<span class="sign">)</span>    <span class="sign">!</span>cleanup
<span class="line_number">1544 </span>
<span class="line_number">1545 </span>        else
<span class="line_number">1546 </span>
<span class="line_number">1547 </span>            this<span class="sign">%</span>children <span class="sign">=</span><span class="sign">&gt;</span> member
<span class="line_number">1548 </span>            member<span class="sign">%</span>previous <span class="sign">=</span><span class="sign">&gt;</span> null<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">1549 </span>
<span class="line_number">1550 </span>        end if
<span class="line_number">1551 </span>
<span class="line_number">1552 </span>    end if
<span class="line_number">1553 </span>
<span class="line_number">1554 </span>    end subroutine <strong>json_value_add_member</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fadd5freal"></a>
<a name="robo51"></a><h2>json_module/json_value_add_real [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_add_real</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Add a real value to the structure.

    These routines are part of the public API that can be
        used to build a json structure using data.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/19/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1574 </span>    subroutine <strong>json_value_add_real</strong><span class="sign">(</span>me<span class="sign">,</span> name<span class="sign">,</span> val<span class="sign">)</span>
<span class="line_number">1575 </span>
<span class="line_number">1576 </span>    implicit none
<span class="line_number">1577 </span>
<span class="line_number">1578 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer   <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">1579 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1580 </span>    real<span class="sign">(</span>wp<span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>         <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1581 </span>
<span class="line_number">1582 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> var
<span class="line_number">1583 </span>
<span class="line_number">1584 </span>    <span class="sign">!</span>create the variable<span class="sign">:</span>
<span class="line_number">1585 </span>    call <a href="#robo56">json_value_create</a><span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1586 </span>    call <a href="#robo75">to_real</a><span class="sign">(</span>var<span class="sign">,</span>val<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">1587 </span>
<span class="line_number">1588 </span>    <span class="sign">!</span>add it<span class="sign">:</span>
<span class="line_number">1589 </span>    call <a href="#robo45">json_value_add</a><span class="sign">(</span>me<span class="sign">,</span> var<span class="sign">)</span>
<span class="line_number">1590 </span>
<span class="line_number">1591 </span>    <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">1592 </span>    nullify<span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1593 </span>
<span class="line_number">1594 </span>    end subroutine <strong>json_value_add_real</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fadd5freal5fvec"></a>
<a name="robo52"></a><h2>json_module/json_value_add_real_vec [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_add_real_vec</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Add a real vector to the structure.

    These routines are part of the public API that can be
        used to build a json structure using data.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/20/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1614 </span>    subroutine <strong>json_value_add_real_vec</strong><span class="sign">(</span>me<span class="sign">,</span> name<span class="sign">,</span> val<span class="sign">)</span>
<span class="line_number">1615 </span>
<span class="line_number">1616 </span>    implicit none
<span class="line_number">1617 </span>
<span class="line_number">1618 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer         <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">1619 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>       <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1620 </span>    real<span class="sign">(</span>wp<span class="sign">)</span><span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1621 </span>
<span class="line_number">1622 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> var
<span class="line_number">1623 </span>    integer <span class="sign">:</span><span class="sign">:</span> i
<span class="line_number">1624 </span>
<span class="line_number">1625 </span>    <span class="sign">!</span>create the variable as an array<span class="sign">:</span>
<span class="line_number">1626 </span>    call <a href="#robo56">json_value_create</a><span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1627 </span>    call <a href="#robo70">to_array</a><span class="sign">(</span>var<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">1628 </span>
<span class="line_number">1629 </span>    <span class="sign">!</span>populate the array<span class="sign">:</span>
<span class="line_number">1630 </span>    do i<span class="sign">=</span>1<span class="sign">,</span>size<span class="sign">(</span>val<span class="sign">)</span>
<span class="line_number">1631 </span>        call <a href="#robo45">json_value_add</a><span class="sign">(</span>var<span class="sign">,</span> <span class="squote">''</span><span class="sign">,</span> val<span class="sign">(</span>i<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">1632 </span>    end do
<span class="line_number">1633 </span>
<span class="line_number">1634 </span>    <span class="sign">!</span>add it<span class="sign">:</span>
<span class="line_number">1635 </span>    call <a href="#robo45">json_value_add</a><span class="sign">(</span>me<span class="sign">,</span> var<span class="sign">)</span>
<span class="line_number">1636 </span>
<span class="line_number">1637 </span>    <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">1638 </span>    nullify<span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1639 </span>
<span class="line_number">1640 </span>    end subroutine <strong>json_value_add_real_vec</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fadd5fstring"></a>
<a name="robo53"></a><h2>json_module/json_value_add_string [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_add_string</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Add a character string the structure.

    These routines are part of the public API that can be
        used to build a json structure using data.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/19/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1832 </span>    subroutine <strong>json_value_add_string</strong><span class="sign">(</span>me<span class="sign">,</span> name<span class="sign">,</span> val<span class="sign">)</span>
<span class="line_number">1833 </span>
<span class="line_number">1834 </span>    implicit none
<span class="line_number">1835 </span>
<span class="line_number">1836 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer   <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">1837 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1838 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1839 </span>
<span class="line_number">1840 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer        <span class="sign">:</span><span class="sign">:</span> var
<span class="line_number">1841 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable    <span class="sign">:</span><span class="sign">:</span> str
<span class="line_number">1842 </span>
<span class="line_number">1843 </span>    <span class="sign">!</span>add escape characters if necessary<span class="sign">:</span>
<span class="line_number">1844 </span>    call <a href="#robo4">escape_string</a><span class="sign">(</span>val<span class="sign">,</span> str<span class="sign">)</span>
<span class="line_number">1845 </span>
<span class="line_number">1846 </span>    <span class="sign">!</span>create the variable<span class="sign">:</span>
<span class="line_number">1847 </span>    call <a href="#robo56">json_value_create</a><span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1848 </span>    call <a href="#robo76">to_string</a><span class="sign">(</span>var<span class="sign">,</span>str<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">1849 </span>
<span class="line_number">1850 </span>    <span class="sign">!</span>add it<span class="sign">:</span>
<span class="line_number">1851 </span>    call <a href="#robo45">json_value_add</a><span class="sign">(</span>me<span class="sign">,</span> var<span class="sign">)</span>
<span class="line_number">1852 </span>
<span class="line_number">1853 </span>    <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">1854 </span>    nullify<span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1855 </span>
<span class="line_number">1856 </span>    end subroutine <strong>json_value_add_string</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fadd5fstring5fvec"></a>
<a name="robo54"></a><h2>json_module/json_value_add_string_vec [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_add_string_vec</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Add an array of character string to the structure.

    These routines are part of the public API that can be
        used to build a json structure using data.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/19/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1929 </span>    subroutine <strong>json_value_add_string_vec</strong><span class="sign">(</span>me<span class="sign">,</span> name<span class="sign">,</span> val<span class="sign">,</span> trim_str<span class="sign">,</span> adjustl_str<span class="sign">)</span>
<span class="line_number">1930 </span>
<span class="line_number">1931 </span>    implicit none
<span class="line_number">1932 </span>
<span class="line_number">1933 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer                <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">1934 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>              <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1935 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1936 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional              <span class="sign">:</span><span class="sign">:</span> trim_str
<span class="line_number">1937 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional              <span class="sign">:</span><span class="sign">:</span> adjustl_str
<span class="line_number">1938 </span>
<span class="line_number">1939 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> var
<span class="line_number">1940 </span>    integer <span class="sign">:</span><span class="sign">:</span> i
<span class="line_number">1941 </span>    logical <span class="sign">:</span><span class="sign">:</span> trim_string<span class="sign">,</span> adjustl_string
<span class="line_number">1942 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable <span class="sign">:</span><span class="sign">:</span> str
<span class="line_number">1943 </span>
<span class="line_number">1944 </span>    <span class="sign">!</span>if the string is to be trimmed or not<span class="sign">:</span>
<span class="line_number">1945 </span>    if <span class="sign">(</span>present<span class="sign">(</span>trim_str<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1946 </span>        trim_string <span class="sign">=</span> trim_str
<span class="line_number">1947 </span>    else
<span class="line_number">1948 </span>        trim_string <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">1949 </span>    end if
<span class="line_number">1950 </span>    if <span class="sign">(</span>present<span class="sign">(</span>adjustl_str<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1951 </span>        adjustl_string <span class="sign">=</span> adjustl_str
<span class="line_number">1952 </span>    else
<span class="line_number">1953 </span>        adjustl_string <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">1954 </span>    end if
<span class="line_number">1955 </span>
<span class="line_number">1956 </span>    <span class="sign">!</span>create the variable as an array<span class="sign">:</span>
<span class="line_number">1957 </span>    call <a href="#robo56">json_value_create</a><span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1958 </span>    call <a href="#robo70">to_array</a><span class="sign">(</span>var<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">1959 </span>
<span class="line_number">1960 </span>    <span class="sign">!</span>populate the array<span class="sign">:</span>
<span class="line_number">1961 </span>    do i<span class="sign">=</span>1<span class="sign">,</span>size<span class="sign">(</span>val<span class="sign">)</span>
<span class="line_number">1962 </span>
<span class="line_number">1963 </span>        <span class="sign">!</span>the string to write<span class="sign">:</span>
<span class="line_number">1964 </span>        str <span class="sign">=</span> val<span class="sign">(</span>i<span class="sign">)</span>
<span class="line_number">1965 </span>        if <span class="sign">(</span>adjustl_string<span class="sign">)</span> str <span class="sign">=</span> adjustl<span class="sign">(</span>str<span class="sign">)</span>
<span class="line_number">1966 </span>        if <span class="sign">(</span>trim_string<span class="sign">)</span>    str <span class="sign">=</span> trim<span class="sign">(</span>str<span class="sign">)</span>
<span class="line_number">1967 </span>
<span class="line_number">1968 </span>        <span class="sign">!</span>write it<span class="sign">:</span>
<span class="line_number">1969 </span>        call <a href="#robo45">json_value_add</a><span class="sign">(</span>var<span class="sign">,</span> <span class="squote">''</span><span class="sign">,</span> str<span class="sign">)</span>
<span class="line_number">1970 </span>
<span class="line_number">1971 </span>        <span class="sign">!</span>cleanup
<span class="line_number">1972 </span>        deallocate<span class="sign">(</span>str<span class="sign">)</span>
<span class="line_number">1973 </span>
<span class="line_number">1974 </span>    end do
<span class="line_number">1975 </span>
<span class="line_number">1976 </span>    <span class="sign">!</span>add it<span class="sign">:</span>
<span class="line_number">1977 </span>    call <a href="#robo45">json_value_add</a><span class="sign">(</span>me<span class="sign">,</span> var<span class="sign">)</span>
<span class="line_number">1978 </span>
<span class="line_number">1979 </span>    <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">1980 </span>    nullify<span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1981 </span>
<span class="line_number">1982 </span>    end subroutine <strong>json_value_add_string_vec</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fcount"></a>
<a name="robo55"></a><h2>json_module/json_value_count [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_count</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Count the number of children.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1996 </span>    function <strong>json_value_count</strong><span class="sign">(</span>this<span class="sign">)</span> result<span class="sign">(</span>count<span class="sign">)</span>
<span class="line_number">1997 </span>
<span class="line_number">1998 </span>    implicit none
<span class="line_number">1999 </span>
<span class="line_number">2000 </span>    integer <span class="sign">:</span><span class="sign">:</span> count
<span class="line_number">2001 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">2002 </span>
<span class="line_number">2003 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">2004 </span>
<span class="line_number">2005 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">2006 </span>
<span class="line_number">2007 </span>        count <span class="sign">=</span> 0
<span class="line_number">2008 </span>        
<span class="line_number">2009 </span>        if <span class="sign">(</span>associated<span class="sign">(</span>this<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2010 </span>
<span class="line_number">2011 </span>            if <span class="sign">(</span>associated<span class="sign">(</span>this<span class="sign">%</span>children<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2012 </span>
<span class="line_number">2013 </span>                p <span class="sign">=</span><span class="sign">&gt;</span> this<span class="sign">%</span>children
<span class="line_number">2014 </span>
<span class="line_number">2015 </span>                do while <span class="sign">(</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2016 </span>                    count <span class="sign">=</span> count <span class="sign">+</span> 1
<span class="line_number">2017 </span>                    p <span class="sign">=</span><span class="sign">&gt;</span> p<span class="sign">%</span>next
<span class="line_number">2018 </span>                end do
<span class="line_number">2019 </span>
<span class="line_number">2020 </span>                nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2021 </span>
<span class="line_number">2022 </span>            end if
<span class="line_number">2023 </span>            
<span class="line_number">2024 </span>        end if
<span class="line_number">2025 </span>        
<span class="line_number">2026 </span>    end if
<span class="line_number">2027 </span>
<span class="line_number">2028 </span>    end function <strong>json_value_count</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fcreate"></a>
<a name="robo56"></a><h2>json_module/json_value_create [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_create</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Allocate a <a href="#robo44">json_value</a> pointer variable.
    This should be called before adding data to it.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    type(<a href="#robo44">json_value</a>),pointer :: var
    call <strong>json_value_create</strong>(var)
    call <a href="#robo75">to_real</a>(var,1.0d0)
</pre>
<p class="item_name">NOTES</p>
<pre>    This routine does not check for exceptions.
    The pointer should not already be allocated.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1164 </span>    subroutine <strong>json_value_create</strong><span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">1165 </span>
<span class="line_number">1166 </span>    implicit none
<span class="line_number">1167 </span>
<span class="line_number">1168 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">1169 </span>
<span class="line_number">1170 </span>    nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">1171 </span>    allocate<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">1172 </span>
<span class="line_number">1173 </span>    end subroutine <strong>json_value_create</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fdestroy"></a>
<a name="robo57"></a><h2>json_module/json_value_destroy [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_destroy</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Destroy a <a href="#robo44">json_value</a> linked-list structure.
</pre>
<p class="item_name">NOTES</p>
<pre>    This routine does not check for exceptions.
    I believe the original version of this routine was not
        properly freeing the memory.  It has been rewritten.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/22/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1195 </span>    recursive subroutine <strong>json_value_destroy</strong><span class="sign">(</span>this<span class="sign">)</span>
<span class="line_number">1196 </span>
<span class="line_number">1197 </span>    implicit none
<span class="line_number">1198 </span>
<span class="line_number">1199 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">1200 </span>
<span class="line_number">1201 </span>    if <span class="sign">(</span>associated<span class="sign">(</span>this<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1202 </span>
<span class="line_number">1203 </span>        if <span class="sign">(</span>allocated<span class="sign">(</span>this<span class="sign">%</span>name<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>this<span class="sign">%</span>name<span class="sign">)</span>
<span class="line_number">1204 </span>
<span class="line_number">1205 </span>        call this<span class="sign">%</span>data<span class="sign">%</span>destroy<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">1206 </span>
<span class="line_number">1207 </span>        if <span class="sign">(</span>associated<span class="sign">(</span>this<span class="sign">%</span>children<span class="sign">)</span><span class="sign">)</span>    call <strong>json_value_destroy</strong><span class="sign">(</span>this<span class="sign">%</span>children<span class="sign">)</span>
<span class="line_number">1208 </span>
<span class="line_number">1209 </span>        if <span class="sign">(</span>associated<span class="sign">(</span>this<span class="sign">%</span>next<span class="sign">)</span><span class="sign">)</span>        call <strong>json_value_destroy</strong><span class="sign">(</span>this<span class="sign">%</span>next<span class="sign">)</span>
<span class="line_number">1210 </span>
<span class="line_number">1211 </span>        deallocate<span class="sign">(</span>this<span class="sign">)</span>
<span class="line_number">1212 </span>
<span class="line_number">1213 </span>        nullify<span class="sign">(</span>this<span class="sign">)</span>
<span class="line_number">1214 </span>
<span class="line_number">1215 </span>    end if
<span class="line_number">1216 </span>
<span class="line_number">1217 </span>    end subroutine <strong>json_value_destroy</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fget"></a>
<a name="robo58"></a><h2>json_module/json_value_get [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_get</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a child, either by index or name string.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">281 </span>    interface <strong>json_value_get</strong>           <span class="sign">!</span>consider renaming this json_value_get_child
<span class="line_number">282 </span>        module procedure <a href="#robo5">get_by_index</a>
<span class="line_number">283 </span>        module procedure <a href="#robo6">get_by_name_chars</a>
<span class="line_number">284 </span>    end interface <strong>json_value_get</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fremove"></a>
<a name="robo59"></a><h2>json_module/json_value_remove [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <a href="#robo57">json_value_destroy</a>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Remove and destroy a <a href="#robo44">json_value</a> (and all its children) 
        from a linked-list structure.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 9/9/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1235 </span>    subroutine <strong>json_value_remove</strong><span class="sign">(</span>me<span class="sign">)</span>
<span class="line_number">1236 </span>
<span class="line_number">1237 </span>    implicit none
<span class="line_number">1238 </span>
<span class="line_number">1239 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">1240 </span>    
<span class="line_number">1241 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> parent<span class="sign">,</span>previous<span class="sign">,</span>next
<span class="line_number">1242 </span>    
<span class="line_number">1243 </span>    if <span class="sign">(</span>associated<span class="sign">(</span>me<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1244 </span>        if <span class="sign">(</span>associated<span class="sign">(</span>me<span class="sign">%</span>parent<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1245 </span>            if <span class="sign">(</span>associated<span class="sign">(</span>me<span class="sign">%</span>next<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1246 </span>        
<span class="line_number">1247 </span>                <span class="sign">!</span>there are later items in the list<span class="sign">:</span>
<span class="line_number">1248 </span>            
<span class="line_number">1249 </span>                next <span class="sign">=</span><span class="sign">&gt;</span> me<span class="sign">%</span>next
<span class="line_number">1250 </span>                nullify<span class="sign">(</span>me<span class="sign">%</span>next<span class="sign">)</span>
<span class="line_number">1251 </span>            
<span class="line_number">1252 </span>                if <span class="sign">(</span>associated<span class="sign">(</span>me<span class="sign">%</span>previous<span class="sign">)</span><span class="sign">)</span> then           
<span class="line_number">1253 </span>                    <span class="sign">!</span>there are earlier items in the list
<span class="line_number">1254 </span>                    previous <span class="sign">=</span><span class="sign">&gt;</span> me<span class="sign">%</span>previous                
<span class="line_number">1255 </span>                    previous<span class="sign">%</span>next <span class="sign">=</span><span class="sign">&gt;</span> next
<span class="line_number">1256 </span>                    next<span class="sign">%</span>previous <span class="sign">=</span><span class="sign">&gt;</span> previous
<span class="line_number">1257 </span>                else
<span class="line_number">1258 </span>                    <span class="sign">!</span>this is the first item in the list
<span class="line_number">1259 </span>                    parent <span class="sign">=</span><span class="sign">&gt;</span> me<span class="sign">%</span>parent                    
<span class="line_number">1260 </span>                    parent<span class="sign">%</span>children <span class="sign">=</span><span class="sign">&gt;</span> next
<span class="line_number">1261 </span>                    next<span class="sign">%</span>previous <span class="sign">=</span><span class="sign">&gt;</span> null<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">1262 </span>                end if
<span class="line_number">1263 </span>                
<span class="line_number">1264 </span>            else
<span class="line_number">1265 </span>            
<span class="line_number">1266 </span>                if <span class="sign">(</span>associated<span class="sign">(</span>me<span class="sign">%</span>previous<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1267 </span>                    <span class="sign">!</span>there are earlier items in the list<span class="sign">:</span>
<span class="line_number">1268 </span>                    previous <span class="sign">=</span><span class="sign">&gt;</span> me<span class="sign">%</span>previous 
<span class="line_number">1269 </span>                    previous<span class="sign">%</span>next <span class="sign">=</span><span class="sign">&gt;</span> null<span class="sign">(</span><span class="sign">)</span>  
<span class="line_number">1270 </span>                else
<span class="line_number">1271 </span>                    <span class="sign">!</span>this is the only item in the list<span class="sign">:</span>
<span class="line_number">1272 </span>                    parent <span class="sign">=</span><span class="sign">&gt;</span> me<span class="sign">%</span>parent 
<span class="line_number">1273 </span>                    parent<span class="sign">%</span>children <span class="sign">=</span><span class="sign">&gt;</span> null<span class="sign">(</span><span class="sign">)</span>                   
<span class="line_number">1274 </span>                end if
<span class="line_number">1275 </span>                
<span class="line_number">1276 </span>            end if     
<span class="line_number">1277 </span>                   
<span class="line_number">1278 </span>        end if
<span class="line_number">1279 </span>            
<span class="line_number">1280 </span>        call <a href="#robo57">json_value_destroy</a><span class="sign">(</span>me<span class="sign">)</span>
<span class="line_number">1281 </span>
<span class="line_number">1282 </span>    end if
<span class="line_number">1283 </span>
<span class="line_number">1284 </span>    end subroutine <strong>json_value_remove</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fremove5fif5fpresent"></a>
<a name="robo60"></a><h2>json_module/json_value_remove_if_present [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_remove_if_present</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    If the child variable is present, then remove it.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/6/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1301 </span>    subroutine <strong>json_value_remove_if_present</strong><span class="sign">(</span>p<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">1302 </span>     
<span class="line_number">1303 </span>    implicit none
<span class="line_number">1304 </span>    
<span class="line_number">1305 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer    <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">1306 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1307 </span>    
<span class="line_number">1308 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> p_var
<span class="line_number">1309 </span>    logical <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">1310 </span>    
<span class="line_number">1311 </span>    call <a href="#robo22">json_get</a><span class="sign">(</span>p<span class="sign">,</span>name<span class="sign">,</span>p_var<span class="sign">,</span>found<span class="sign">)</span>
<span class="line_number">1312 </span>    if <span class="sign">(</span>found<span class="sign">)</span> call json_remove<span class="sign">(</span>p_var<span class="sign">)</span>
<span class="line_number">1313 </span>     
<span class="line_number">1314 </span>    end subroutine <strong>json_value_remove_if_present</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fto5fstring"></a>
<a name="robo61"></a><h2>json_module/json_value_to_string [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_to_string</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Print the JSON structure to an allocatable string.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 2/12/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2146 </span>    subroutine <strong>json_value_to_string</strong><span class="sign">(</span>me<span class="sign">,</span>str<span class="sign">)</span>
<span class="line_number">2147 </span>
<span class="line_number">2148 </span>    implicit none
<span class="line_number">2149 </span>    
<span class="line_number">2150 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>        <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">2151 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>allocatable   <span class="sign">:</span><span class="sign">:</span> str
<span class="line_number">2152 </span>    
<span class="line_number">2153 </span>    str <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">2154 </span>    call json_value_print<span class="sign">(</span>me<span class="sign">,</span> iunit<span class="sign">=</span>0<span class="sign">,</span> str<span class="sign">=</span>str<span class="sign">)</span>
<span class="line_number">2155 </span>        
<span class="line_number">2156 </span>    end subroutine <strong>json_value_to_string</strong>
</pre>

<hr />
<a name="json5fmodule2fload5fjson5ffile"></a>
<a name="robo62"></a><h2>json_module/load_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>load_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%load_file(filename)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Load the JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/9/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">539 </span>    subroutine <strong>load_json_file</strong><span class="sign">(</span>me<span class="sign">,</span> filename<span class="sign">)</span>
<span class="line_number">540 </span>
<span class="line_number">541 </span>    implicit none
<span class="line_number">542 </span>
<span class="line_number">543 </span>    class<span class="sign">(</span><a href="#robo21">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">544 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> filename
<span class="line_number">545 </span>
<span class="line_number">546 </span>    call <a href="#robo35">json_parse</a><span class="sign">(</span>filename<span class="sign">,</span> me<span class="sign">%</span>p<span class="sign">)</span>
<span class="line_number">547 </span>
<span class="line_number">548 </span>    end subroutine <strong>load_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fmove5fpointer5fin5fjson5ffile"></a>
<a name="robo63"></a><h2>json_module/move_pointer_in_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>move_pointer_in_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call to%move(from)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Move the <a href="#robo44">json_value</a> pointer from one <a href="#robo21">json_file</a> to another.
    "from" is then nullified, but not destroyed.
    Note: if "from%p" is not associated, then an error is thrown.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/5/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">505 </span>    subroutine <strong>move_pointer_in_json_file</strong><span class="sign">(</span>to<span class="sign">,</span>from<span class="sign">)</span>
<span class="line_number">506 </span>    
<span class="line_number">507 </span>    implicit none
<span class="line_number">508 </span>
<span class="line_number">509 </span>    class<span class="sign">(</span><a href="#robo21">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> to
<span class="line_number">510 </span>    class<span class="sign">(</span><a href="#robo21">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> from
<span class="line_number">511 </span>
<span class="line_number">512 </span>    if <span class="sign">(</span>associated<span class="sign">(</span>from<span class="sign">%</span>p<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">513 </span>        to<span class="sign">%</span>p <span class="sign">=</span><span class="sign">&gt;</span> from<span class="sign">%</span>p
<span class="line_number">514 </span>        nullify<span class="sign">(</span>from<span class="sign">%</span>p<span class="sign">)</span>
<span class="line_number">515 </span>    else
<span class="line_number">516 </span>        call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>move_pointer_in_json_file</strong>: '</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">517 </span>                             <span class="squote">'pointer is not associated.'</span><span class="sign">)</span>
<span class="line_number">518 </span>    end if
<span class="line_number">519 </span>
<span class="line_number">520 </span>    end subroutine <strong>move_pointer_in_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fparse5fobject"></a>
<a name="robo64"></a><h2>json_module/parse_object [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>parse_object</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">4007 </span>    recursive subroutine <strong>parse_object</strong><span class="sign">(</span>unit<span class="sign">,</span> parent<span class="sign">)</span>
<span class="line_number">4008 </span>
<span class="line_number">4009 </span>    implicit none
<span class="line_number">4010 </span>
<span class="line_number">4011 </span>    integer<span class="sign">,</span> intent<span class="sign">(</span>in<span class="sign">)</span>       <span class="sign">:</span><span class="sign">:</span> unit
<span class="line_number">4012 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> parent
<span class="line_number">4013 </span>
<span class="line_number">4014 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> pair
<span class="line_number">4015 </span>    logical <span class="sign">:</span><span class="sign">:</span> eof
<span class="line_number">4016 </span>    character<span class="sign">(</span>len<span class="sign">=</span>1<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> c
<span class="line_number">4017 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable <span class="sign">:</span><span class="sign">:</span> tmp  <span class="sign">!</span>this is a work<span class="sign">-</span>around for a bug 
<span class="line_number">4018 </span>                                         <span class="sign">!</span>  in the gfortran 4<span class="sign">.</span>9 compiler<span class="sign">.</span>
<span class="line_number">4019 </span>
<span class="line_number">4020 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">4021 </span>
<span class="line_number">4022 </span>        <span class="sign">!</span>the routine is being called incorrectly<span class="sign">.</span>
<span class="line_number">4023 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> associated<span class="sign">(</span>parent<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">4024 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_object</strong>: parent pointer not associated.'</span><span class="sign">)</span>
<span class="line_number">4025 </span>        end if
<span class="line_number">4026 </span>
<span class="line_number">4027 </span>        nullify<span class="sign">(</span>pair<span class="sign">)</span>    <span class="sign">!</span>probably not necessary
<span class="line_number">4028 </span>
<span class="line_number">4029 </span>        <span class="sign">!</span> pair name
<span class="line_number">4030 </span>        c <span class="sign">=</span> pop_char<span class="sign">(</span>unit<span class="sign">,</span> eof <span class="sign">=</span> eof<span class="sign">,</span> skip_ws <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span><span class="sign">)</span>
<span class="line_number">4031 </span>        if <span class="sign">(</span>eof<span class="sign">)</span> then
<span class="line_number">4032 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_object</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">4033 </span>                                 <span class="squote">' Unexpected end of file while parsing start of object.'</span><span class="sign">)</span>
<span class="line_number">4034 </span>            call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">4035 </span>            return
<span class="line_number">4036 </span>        else if <span class="sign">(</span><span class="squote">'}'</span> <span class="sign">=</span><span class="sign">=</span> c<span class="sign">)</span> then
<span class="line_number">4037 </span>            <span class="sign">!</span> end of an empty object
<span class="line_number">4038 </span>            call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">4039 </span>            return
<span class="line_number">4040 </span>        else if <span class="sign">(</span><span class="squote">'"'</span> <span class="sign">=</span><span class="sign">=</span> c<span class="sign">)</span> then
<span class="line_number">4041 </span>            call <a href="#robo56">json_value_create</a><span class="sign">(</span>pair<span class="sign">)</span>
<span class="line_number">4042 </span>            call parse_string<span class="sign">(</span>unit<span class="sign">,</span> tmp<span class="sign">)</span>   <span class="sign">!</span>write to a tmp variable because of
<span class="line_number">4043 </span>            pair <span class="sign">%</span> name <span class="sign">=</span> tmp              <span class="sign">!</span> a bug in 4<span class="sign">.</span>9 gfortran compiler<span class="sign">.</span>
<span class="line_number">4044 </span>            deallocate<span class="sign">(</span>tmp<span class="sign">)</span>
<span class="line_number">4045 </span>            if <span class="sign">(</span>exception_thrown<span class="sign">)</span> return
<span class="line_number">4046 </span>        else
<span class="line_number">4047 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_object</strong>: Expecting string: "'</span><span class="sign">/</span><span class="sign">/</span>c<span class="sign">/</span><span class="sign">/</span><span class="squote">'"'</span><span class="sign">)</span>
<span class="line_number">4048 </span>            call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">4049 </span>            return
<span class="line_number">4050 </span>        end if
<span class="line_number">4051 </span>
<span class="line_number">4052 </span>        <span class="sign">!</span> pair value
<span class="line_number">4053 </span>        c <span class="sign">=</span> pop_char<span class="sign">(</span>unit<span class="sign">,</span> eof <span class="sign">=</span> eof<span class="sign">,</span> skip_ws <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span><span class="sign">)</span>
<span class="line_number">4054 </span>        if <span class="sign">(</span>eof<span class="sign">)</span> then
<span class="line_number">4055 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_object</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">4056 </span>                                 <span class="squote">' Unexpected end of file while parsing object member.'</span><span class="sign">)</span>
<span class="line_number">4057 </span>            call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">4058 </span>            return
<span class="line_number">4059 </span>        else if <span class="sign">(</span><span class="squote">':'</span> <span class="sign">=</span><span class="sign">=</span> c<span class="sign">)</span> then
<span class="line_number">4060 </span>            <span class="sign">!</span> parse the value
<span class="line_number">4061 </span>            call <a href="#robo65">parse_value</a><span class="sign">(</span>unit<span class="sign">,</span> pair<span class="sign">)</span>
<span class="line_number">4062 </span>            if <span class="sign">(</span>exception_thrown<span class="sign">)</span> return
<span class="line_number">4063 </span>            call <a href="#robo45">json_value_add</a><span class="sign">(</span>parent<span class="sign">,</span> pair<span class="sign">)</span>
<span class="line_number">4064 </span>        else
<span class="line_number">4065 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_object</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">4066 </span>                                 <span class="squote">' Expecting : and then a value: '</span><span class="sign">/</span><span class="sign">/</span>c<span class="sign">)</span>
<span class="line_number">4067 </span>            call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">4068 </span>            return
<span class="line_number">4069 </span>        end if
<span class="line_number">4070 </span>
<span class="line_number">4071 </span>        <span class="sign">!</span> another possible pair
<span class="line_number">4072 </span>        c <span class="sign">=</span> pop_char<span class="sign">(</span>unit<span class="sign">,</span> eof <span class="sign">=</span> eof<span class="sign">,</span> skip_ws <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span><span class="sign">)</span>
<span class="line_number">4073 </span>        if <span class="sign">(</span>eof<span class="sign">)</span> then
<span class="line_number">4074 </span>            call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">4075 </span>            return
<span class="line_number">4076 </span>        else if <span class="sign">(</span><span class="squote">','</span> <span class="sign">=</span><span class="sign">=</span> c<span class="sign">)</span> then
<span class="line_number">4077 </span>            <span class="sign">!</span> read the next member
<span class="line_number">4078 </span>            call <strong>parse_object</strong><span class="sign">(</span>unit <span class="sign">=</span> unit<span class="sign">,</span> parent <span class="sign">=</span> parent<span class="sign">)</span>
<span class="line_number">4079 </span>        else if <span class="sign">(</span><span class="squote">'}'</span> <span class="sign">=</span><span class="sign">=</span> c<span class="sign">)</span> then
<span class="line_number">4080 </span>            call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">4081 </span>            return
<span class="line_number">4082 </span>        else
<span class="line_number">4083 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_object</strong>: Expecting end of object: '</span><span class="sign">/</span><span class="sign">/</span>c<span class="sign">)</span>
<span class="line_number">4084 </span>            call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">4085 </span>            return
<span class="line_number">4086 </span>        end if
<span class="line_number">4087 </span>
<span class="line_number">4088 </span>        call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">4089 </span>
<span class="line_number">4090 </span>    end if
<span class="line_number">4091 </span>
<span class="line_number">4092 </span>    contains
<span class="line_number">4093 </span>
<span class="line_number">4094 </span>        <span class="sign">!</span>cleanup routine<span class="sign">:</span>
<span class="line_number">4095 </span>        subroutine cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">4096 </span>        
<span class="line_number">4097 </span>        implicit none
<span class="line_number">4098 </span>
<span class="line_number">4099 </span>        if <span class="sign">(</span>associated<span class="sign">(</span>pair<span class="sign">)</span><span class="sign">)</span> nullify<span class="sign">(</span>pair<span class="sign">)</span>
<span class="line_number">4100 </span>
<span class="line_number">4101 </span>        end subroutine cleanup
<span class="line_number">4102 </span>
<span class="line_number">4103 </span>    end subroutine <strong>parse_object</strong>
</pre>

<hr />
<a name="json5fmodule2fparse5fvalue"></a>
<a name="robo65"></a><h2>json_module/parse_value [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>parse_value</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Core parsing routine.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3640 </span>    recursive subroutine <strong>parse_value</strong><span class="sign">(</span>unit<span class="sign">,</span> value<span class="sign">)</span>
<span class="line_number">3641 </span>
<span class="line_number">3642 </span>    implicit none
<span class="line_number">3643 </span>
<span class="line_number">3644 </span>    integer<span class="sign">,</span> intent<span class="sign">(</span>in<span class="sign">)</span>       <span class="sign">:</span><span class="sign">:</span> unit
<span class="line_number">3645 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> value
<span class="line_number">3646 </span>
<span class="line_number">3647 </span>    logical <span class="sign">:</span><span class="sign">:</span> eof
<span class="line_number">3648 </span>    character<span class="sign">(</span>len<span class="sign">=</span>1<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> c
<span class="line_number">3649 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable <span class="sign">:</span><span class="sign">:</span> tmp  <span class="sign">!</span>this is a work<span class="sign">-</span>around for a bug 
<span class="line_number">3650 </span>                                         <span class="sign">!</span>  in the gfortran 4<span class="sign">.</span>9 compiler<span class="sign">.</span>
<span class="line_number">3651 </span>
<span class="line_number">3652 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">3653 </span>
<span class="line_number">3654 </span>        <span class="sign">!</span>the routine is being called incorrectly<span class="sign">.</span>
<span class="line_number">3655 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> associated<span class="sign">(</span>value<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3656 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_value</strong>: value pointer not associated.'</span><span class="sign">)</span>
<span class="line_number">3657 </span>        end if
<span class="line_number">3658 </span>
<span class="line_number">3659 </span>        <span class="sign">!</span> pop the next non whitespace character off the file
<span class="line_number">3660 </span>        c <span class="sign">=</span> pop_char<span class="sign">(</span>unit<span class="sign">,</span> eof <span class="sign">=</span> eof<span class="sign">,</span> skip_ws <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span><span class="sign">)</span>
<span class="line_number">3661 </span>
<span class="line_number">3662 </span>        if <span class="sign">(</span>eof<span class="sign">)</span> then
<span class="line_number">3663 </span>            return
<span class="line_number">3664 </span>        else
<span class="line_number">3665 </span>            select case <span class="sign">(</span>c<span class="sign">)</span>
<span class="line_number">3666 </span>            case <span class="sign">(</span><span class="squote">'{'</span><span class="sign">)</span>
<span class="line_number">3667 </span>
<span class="line_number">3668 </span>                <span class="sign">!</span> start object
<span class="line_number">3669 </span>                call <a href="#robo74">to_object</a><span class="sign">(</span>value<span class="sign">)</span>    <span class="sign">!</span>allocate class
<span class="line_number">3670 </span>                call <a href="#robo64">parse_object</a><span class="sign">(</span>unit<span class="sign">,</span> value<span class="sign">)</span>
<span class="line_number">3671 </span>
<span class="line_number">3672 </span>            case <span class="sign">(</span><span class="squote">'['</span><span class="sign">)</span>
<span class="line_number">3673 </span>
<span class="line_number">3674 </span>                <span class="sign">!</span> start array
<span class="line_number">3675 </span>                call <a href="#robo70">to_array</a><span class="sign">(</span>value<span class="sign">)</span>    <span class="sign">!</span>allocate class
<span class="line_number">3676 </span>                call parse_array<span class="sign">(</span>unit<span class="sign">,</span> value<span class="sign">)</span>
<span class="line_number">3677 </span>
<span class="line_number">3678 </span>            case <span class="sign">(</span><span class="squote">']'</span><span class="sign">)</span>
<span class="line_number">3679 </span>
<span class="line_number">3680 </span>                <span class="sign">!</span> end an empty array
<span class="line_number">3681 </span>                call push_char<span class="sign">(</span>c<span class="sign">)</span>
<span class="line_number">3682 </span>                nullify<span class="sign">(</span>value<span class="sign">)</span>
<span class="line_number">3683 </span>
<span class="line_number">3684 </span>            case <span class="sign">(</span><span class="squote">'"'</span><span class="sign">)</span>
<span class="line_number">3685 </span>
<span class="line_number">3686 </span>                <span class="sign">!</span> string
<span class="line_number">3687 </span>                call <a href="#robo76">to_string</a><span class="sign">(</span>value<span class="sign">)</span>    <span class="sign">!</span>allocate class
<span class="line_number">3688 </span>
<span class="line_number">3689 </span>                 <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> value<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3690 </span>                    <span class="sign">!</span>select type <span class="sign">(</span>value<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3691 </span>                    select case <span class="sign">(</span>value<span class="sign">%</span>data<span class="sign">%</span>var_type<span class="sign">)</span>
<span class="line_number">3692 </span>                    <span class="sign">!</span>type is <span class="sign">(</span>json_string<span class="sign">)</span>
<span class="line_number">3693 </span>                    case <span class="sign">(</span>json_string<span class="sign">)</span>
<span class="line_number">3694 </span>                        call parse_string<span class="sign">(</span>unit<span class="sign">,</span> tmp<span class="sign">)</span>  <span class="sign">!</span>write to a tmp variable because of
<span class="line_number">3695 </span>                        value<span class="sign">%</span>data<span class="sign">%</span>str_value <span class="sign">=</span> tmp    <span class="sign">!</span> a bug in 4<span class="sign">.</span>9 gfortran compiler<span class="sign">.</span>
<span class="line_number">3696 </span>                        deallocate<span class="sign">(</span>tmp<span class="sign">)</span>
<span class="line_number">3697 </span>                    end select
<span class="line_number">3698 </span>                <span class="sign">!</span>end associate
<span class="line_number">3699 </span>
<span class="line_number">3700 </span>            case <span class="sign">(</span><span class="squote">'t'</span><span class="sign">)</span>
<span class="line_number">3701 </span>
<span class="line_number">3702 </span>                <span class="sign">!</span>true
<span class="line_number">3703 </span>                call parse_for_chars<span class="sign">(</span>unit<span class="sign">,</span> <span class="squote">'rue'</span><span class="sign">)</span>
<span class="line_number">3704 </span>                <span class="sign">!</span>allocate class and set value<span class="sign">:</span>
<span class="line_number">3705 </span>                if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> call <a href="#robo72">to_logical</a><span class="sign">(</span>value<span class="sign">,</span><span class="sign">.</span>true<span class="sign">.</span><span class="sign">)</span>    
<span class="line_number">3706 </span>
<span class="line_number">3707 </span>            case <span class="sign">(</span><span class="squote">'f'</span><span class="sign">)</span>
<span class="line_number">3708 </span>
<span class="line_number">3709 </span>                <span class="sign">!</span>false
<span class="line_number">3710 </span>                call parse_for_chars<span class="sign">(</span>unit<span class="sign">,</span> <span class="squote">'alse'</span><span class="sign">)</span>
<span class="line_number">3711 </span>                <span class="sign">!</span>allocate class and set value<span class="sign">:</span>
<span class="line_number">3712 </span>                if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> call <a href="#robo72">to_logical</a><span class="sign">(</span>value<span class="sign">,</span><span class="sign">.</span>false<span class="sign">.</span><span class="sign">)</span>
<span class="line_number">3713 </span>
<span class="line_number">3714 </span>            case <span class="sign">(</span><span class="squote">'n'</span><span class="sign">)</span>
<span class="line_number">3715 </span>
<span class="line_number">3716 </span>                call parse_for_chars<span class="sign">(</span>unit<span class="sign">,</span> <span class="squote">'ull'</span><span class="sign">)</span>
<span class="line_number">3717 </span>                if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> call <a href="#robo73">to_null</a><span class="sign">(</span>value<span class="sign">)</span>    <span class="sign">!</span>allocate class
<span class="line_number">3718 </span>
<span class="line_number">3719 </span>            case<span class="sign">(</span><span class="squote">'-'</span><span class="sign">,</span> <span class="squote">'0'</span><span class="sign">:</span> <span class="squote">'9'</span><span class="sign">)</span>
<span class="line_number">3720 </span>
<span class="line_number">3721 </span>                call push_char<span class="sign">(</span>c<span class="sign">)</span>
<span class="line_number">3722 </span>                call parse_number<span class="sign">(</span>unit<span class="sign">,</span> value<span class="sign">)</span>
<span class="line_number">3723 </span>
<span class="line_number">3724 </span>            case default
<span class="line_number">3725 </span>
<span class="line_number">3726 </span>                call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_value</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3727 </span>                                     <span class="squote">' Unexpected character while parsing value. "'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3728 </span>                                     c<span class="sign">/</span><span class="sign">/</span><span class="squote">'"'</span><span class="sign">)</span>
<span class="line_number">3729 </span>
<span class="line_number">3730 </span>            end select
<span class="line_number">3731 </span>        end if
<span class="line_number">3732 </span>
<span class="line_number">3733 </span>    end if
<span class="line_number">3734 </span>
<span class="line_number">3735 </span>    end subroutine <strong>parse_value</strong>
</pre>

<hr />
<a name="json5fmodule2fprint5fjson5ffile"></a>
<a name="robo66"></a><h2>json_module/print_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>print_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%print_file()
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Print the JSON file.
    Prints to the specified file unit (if not present, then prints to the console)
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/9/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">569 </span>    subroutine <strong>print_json_file</strong><span class="sign">(</span>me<span class="sign">,</span> iunit<span class="sign">)</span>
<span class="line_number">570 </span>
<span class="line_number">571 </span>    use<span class="sign">,</span> intrinsic <span class="sign">:</span><span class="sign">:</span> iso_fortran_env<span class="sign">,</span>    only<span class="sign">:</span> output_unit
<span class="line_number">572 </span>
<span class="line_number">573 </span>    implicit none
<span class="line_number">574 </span>
<span class="line_number">575 </span>    class<span class="sign">(</span><a href="#robo21">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">576 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional <span class="sign">:</span><span class="sign">:</span> iunit  <span class="sign">!</span>must be non<span class="sign">-</span>zero
<span class="line_number">577 </span>
<span class="line_number">578 </span>    integer <span class="sign">:</span><span class="sign">:</span> i
<span class="line_number">579 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable <span class="sign">:</span><span class="sign">:</span> dummy
<span class="line_number">580 </span>
<span class="line_number">581 </span>    if <span class="sign">(</span>present<span class="sign">(</span>iunit<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">582 </span>        if <span class="sign">(</span>iunit<span class="sign">/</span><span class="sign">=</span>0<span class="sign">)</span> then
<span class="line_number">583 </span>            i <span class="sign">=</span> iunit
<span class="line_number">584 </span>        else
<span class="line_number">585 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>print_json_file</strong>: iunit must be nonzero.'</span><span class="sign">)</span>
<span class="line_number">586 </span>            return
<span class="line_number">587 </span>        end if
<span class="line_number">588 </span>    else
<span class="line_number">589 </span>        i <span class="sign">=</span> output_unit
<span class="line_number">590 </span>    end if
<span class="line_number">591 </span>
<span class="line_number">592 </span>    call json_value_print<span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span>iunit<span class="sign">=</span>i<span class="sign">,</span>str<span class="sign">=</span>dummy<span class="sign">)</span>
<span class="line_number">593 </span>
<span class="line_number">594 </span>    end subroutine <strong>print_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fstring5fto5fdouble"></a>
<a name="robo67"></a><h2>json_module/string_to_double [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>string_to_double</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Convert a string into a double.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/19/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2684 </span>    function <strong>string_to_double</strong><span class="sign">(</span>str<span class="sign">)</span> result<span class="sign">(</span>rval<span class="sign">)</span>
<span class="line_number">2685 </span>
<span class="line_number">2686 </span>    implicit none
<span class="line_number">2687 </span>
<span class="line_number">2688 </span>    real<span class="sign">(</span>wp<span class="sign">)</span>                    <span class="sign">:</span><span class="sign">:</span> rval
<span class="line_number">2689 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> str
<span class="line_number">2690 </span>
<span class="line_number">2691 </span>    integer <span class="sign">:</span><span class="sign">:</span> ierr
<span class="line_number">2692 </span>
<span class="line_number">2693 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">2694 </span>
<span class="line_number">2695 </span>        read<span class="sign">(</span>str<span class="sign">,</span>fmt<span class="sign">=</span>real_fmt<span class="sign">,</span>iostat<span class="sign">=</span>ierr<span class="sign">)</span> rval    <span class="sign">!</span>string to double
<span class="line_number">2696 </span>
<span class="line_number">2697 </span>        if <span class="sign">(</span>ierr<span class="sign">/</span><span class="sign">=</span>0<span class="sign">)</span> then    <span class="sign">!</span>if there was an error
<span class="line_number">2698 </span>            rval <span class="sign">=</span> 0<span class="sign">.</span>0_wp
<span class="line_number">2699 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>string_to_double</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">2700 </span>                                 <span class="squote">' string cannot be converted to a double: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>str<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2701 </span>        end if
<span class="line_number">2702 </span>
<span class="line_number">2703 </span>    end if
<span class="line_number">2704 </span>
<span class="line_number">2705 </span>    end function <strong>string_to_double</strong>
</pre>

<hr />
<a name="json5fmodule2fstring5fto5finteger"></a>
<a name="robo68"></a><h2>json_module/string_to_integer [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>string_to_integer</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Convert a string into an integer.
</pre>
<p class="item_name">NOTES</p>
<pre>    Replacement for the parse_integer function in the original code.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/10/2013 : Rewrote routine.  Added error checking.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2646 </span>    function <strong>string_to_integer</strong><span class="sign">(</span>str<span class="sign">)</span> result<span class="sign">(</span>ival<span class="sign">)</span>
<span class="line_number">2647 </span>
<span class="line_number">2648 </span>    implicit none
<span class="line_number">2649 </span>
<span class="line_number">2650 </span>    integer                     <span class="sign">:</span><span class="sign">:</span> ival
<span class="line_number">2651 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> str
<span class="line_number">2652 </span>
<span class="line_number">2653 </span>    integer <span class="sign">:</span><span class="sign">:</span> ierr
<span class="line_number">2654 </span>
<span class="line_number">2655 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">2656 </span>
<span class="line_number">2657 </span>        read<span class="sign">(</span>str<span class="sign">,</span><span class="sign">*</span><span class="sign">,</span>iostat<span class="sign">=</span>ierr<span class="sign">)</span> ival        <span class="sign">!</span>string to integer
<span class="line_number">2658 </span>
<span class="line_number">2659 </span>        if <span class="sign">(</span>ierr<span class="sign">/</span><span class="sign">=</span>0<span class="sign">)</span> then                   <span class="sign">!</span>if there was an error
<span class="line_number">2660 </span>            ival <span class="sign">=</span> 0
<span class="line_number">2661 </span>            call <a href="#robo69">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>string_to_integer</strong>:'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">2662 </span>                                 <span class="squote">' string cannot be converted to an integer: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>str<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2663 </span>        end if
<span class="line_number">2664 </span>
<span class="line_number">2665 </span>    end if
<span class="line_number">2666 </span>
<span class="line_number">2667 </span>    end function <strong>string_to_integer</strong>
</pre>

<hr />
<a name="json5fmodule2fthrow5fexception"></a>
<a name="robo69"></a><h2>json_module/throw_exception [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>throw_exception</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Throw an exception in the JSON module.
    This routine sets the error flag, and prevents any subsequent routine
    from doing anything, until <a href="#robo19">json_clear_exceptions</a> is called.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/4/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1035 </span>    subroutine <strong>throw_exception</strong><span class="sign">(</span>msg<span class="sign">)</span>
<span class="line_number">1036 </span>
<span class="line_number">1037 </span>    <span class="sign">!</span>use ifcore<span class="sign">,</span>    only<span class="sign">:</span> tracebackqq    <span class="sign">!</span>Intel routine
<span class="line_number">1038 </span>
<span class="line_number">1039 </span>    implicit none
<span class="line_number">1040 </span>
<span class="line_number">1041 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> msg    <span class="sign">!</span>the error message
<span class="line_number">1042 </span>
<span class="line_number">1043 </span>    exception_thrown <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">1044 </span>    err_message <span class="sign">=</span> trim<span class="sign">(</span>msg<span class="sign">)</span>
<span class="line_number">1045 </span>
<span class="line_number">1046 </span>    end subroutine <strong>throw_exception</strong>
</pre>

<hr />
<a name="json5fmodule2fto5farray"></a>
<a name="robo70"></a><h2>json_module/to_array [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>to_array</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Change the variable to an array.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3977 </span>    subroutine <strong>to_array</strong><span class="sign">(</span>me<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">3978 </span>
<span class="line_number">3979 </span>    implicit none
<span class="line_number">3980 </span>
<span class="line_number">3981 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> intent<span class="sign">(</span>inout<span class="sign">)</span>        <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">3982 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional   <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">3983 </span>
<span class="line_number">3984 </span>    <span class="sign">!</span>set type and value<span class="sign">:</span>
<span class="line_number">3985 </span>    <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> me<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3986 </span>        call me<span class="sign">%</span>data<span class="sign">%</span>destroy<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3987 </span>        me<span class="sign">%</span>data<span class="sign">%</span>var_type <span class="sign">=</span> json_array
<span class="line_number">3988 </span>    <span class="sign">!</span>end associate
<span class="line_number">3989 </span>
<span class="line_number">3990 </span>    <span class="sign">!</span>name<span class="sign">:</span>
<span class="line_number">3991 </span>    if <span class="sign">(</span>present<span class="sign">(</span>name<span class="sign">)</span><span class="sign">)</span> me<span class="sign">%</span>name <span class="sign">=</span> trim<span class="sign">(</span>name<span class="sign">)</span>
<span class="line_number">3992 </span>
<span class="line_number">3993 </span>    end subroutine <strong>to_array</strong>
</pre>

<hr />
<a name="json5fmodule2fto5finteger"></a>
<a name="robo71"></a><h2>json_module/to_integer [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>to_integer</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Change the variable to an integer.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3792 </span>    subroutine <strong>to_integer</strong><span class="sign">(</span>me<span class="sign">,</span>val<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">3793 </span>
<span class="line_number">3794 </span>    implicit none
<span class="line_number">3795 </span>
<span class="line_number">3796 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> intent<span class="sign">(</span>inout<span class="sign">)</span>        <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">3797 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional   <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">3798 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional            <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">3799 </span>
<span class="line_number">3800 </span>    <span class="sign">!</span>set type and value<span class="sign">:</span>
<span class="line_number">3801 </span>    <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> me<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3802 </span>        call me<span class="sign">%</span>data<span class="sign">%</span>destroy<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3803 </span>        me<span class="sign">%</span>data<span class="sign">%</span>var_type <span class="sign">=</span> json_integer
<span class="line_number">3804 </span>        allocate<span class="sign">(</span>me<span class="sign">%</span>data<span class="sign">%</span>int_value<span class="sign">)</span>
<span class="line_number">3805 </span>        if <span class="sign">(</span>present<span class="sign">(</span>val<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3806 </span>            me<span class="sign">%</span>data<span class="sign">%</span>int_value <span class="sign">=</span> val
<span class="line_number">3807 </span>        else
<span class="line_number">3808 </span>            me<span class="sign">%</span>data<span class="sign">%</span>int_value <span class="sign">=</span> 0    <span class="sign">!</span>default value
<span class="line_number">3809 </span>        end if
<span class="line_number">3810 </span>    <span class="sign">!</span>end associate
<span class="line_number">3811 </span>
<span class="line_number">3812 </span>    <span class="sign">!</span>name<span class="sign">:</span>
<span class="line_number">3813 </span>    if <span class="sign">(</span>present<span class="sign">(</span>name<span class="sign">)</span><span class="sign">)</span> me<span class="sign">%</span>name <span class="sign">=</span> trim<span class="sign">(</span>name<span class="sign">)</span>
<span class="line_number">3814 </span>
<span class="line_number">3815 </span>    end subroutine <strong>to_integer</strong>
</pre>

<hr />
<a name="json5fmodule2fto5flogical"></a>
<a name="robo72"></a><h2>json_module/to_logical [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>to_logical</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Change the variable to a logical.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3752 </span>    subroutine <strong>to_logical</strong><span class="sign">(</span>me<span class="sign">,</span>val<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">3753 </span>
<span class="line_number">3754 </span>    implicit none
<span class="line_number">3755 </span>
<span class="line_number">3756 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> intent<span class="sign">(</span>inout<span class="sign">)</span>        <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">3757 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional   <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">3758 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional            <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">3759 </span>
<span class="line_number">3760 </span>    <span class="sign">!</span>set type and value<span class="sign">:</span>
<span class="line_number">3761 </span>    <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> me<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3762 </span>        call me<span class="sign">%</span>data<span class="sign">%</span>destroy<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3763 </span>        me<span class="sign">%</span>data<span class="sign">%</span>var_type <span class="sign">=</span> json_logical
<span class="line_number">3764 </span>        allocate<span class="sign">(</span>me<span class="sign">%</span>data<span class="sign">%</span>log_value<span class="sign">)</span>
<span class="line_number">3765 </span>        if <span class="sign">(</span>present<span class="sign">(</span>val<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3766 </span>            me<span class="sign">%</span>data<span class="sign">%</span>log_value <span class="sign">=</span> val
<span class="line_number">3767 </span>        else
<span class="line_number">3768 </span>            me<span class="sign">%</span>data<span class="sign">%</span>log_value <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>    <span class="sign">!</span>default value
<span class="line_number">3769 </span>        end if
<span class="line_number">3770 </span>    <span class="sign">!</span>end associate
<span class="line_number">3771 </span>
<span class="line_number">3772 </span>    <span class="sign">!</span>name<span class="sign">:</span>
<span class="line_number">3773 </span>    if <span class="sign">(</span>present<span class="sign">(</span>name<span class="sign">)</span><span class="sign">)</span> me<span class="sign">%</span>name <span class="sign">=</span> trim<span class="sign">(</span>name<span class="sign">)</span>
<span class="line_number">3774 </span>
<span class="line_number">3775 </span>    end subroutine <strong>to_logical</strong>
</pre>

<hr />
<a name="json5fmodule2fto5fnull"></a>
<a name="robo73"></a><h2>json_module/to_null [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>to_null</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Change the variable to a null.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3911 </span>    subroutine <strong>to_null</strong><span class="sign">(</span>me<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">3912 </span>
<span class="line_number">3913 </span>    implicit none
<span class="line_number">3914 </span>
<span class="line_number">3915 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> intent<span class="sign">(</span>inout<span class="sign">)</span>        <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">3916 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional   <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">3917 </span>
<span class="line_number">3918 </span>    <span class="sign">!</span>set type and value<span class="sign">:</span>
<span class="line_number">3919 </span>    <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> me<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3920 </span>        call me<span class="sign">%</span>data<span class="sign">%</span>destroy<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3921 </span>        me<span class="sign">%</span>data<span class="sign">%</span>var_type <span class="sign">=</span> json_null
<span class="line_number">3922 </span>    <span class="sign">!</span>end associate
<span class="line_number">3923 </span>
<span class="line_number">3924 </span>    <span class="sign">!</span>name<span class="sign">:</span>
<span class="line_number">3925 </span>    if <span class="sign">(</span>present<span class="sign">(</span>name<span class="sign">)</span><span class="sign">)</span> me<span class="sign">%</span>name <span class="sign">=</span> trim<span class="sign">(</span>name<span class="sign">)</span>
<span class="line_number">3926 </span>
<span class="line_number">3927 </span>    end subroutine <strong>to_null</strong>
</pre>

<hr />
<a name="json5fmodule2fto5fobject"></a>
<a name="robo74"></a><h2>json_module/to_object [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>to_object</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Change the variable to an object.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3944 </span>    subroutine <strong>to_object</strong><span class="sign">(</span>me<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">3945 </span>
<span class="line_number">3946 </span>    implicit none
<span class="line_number">3947 </span>
<span class="line_number">3948 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> intent<span class="sign">(</span>inout<span class="sign">)</span>        <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">3949 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional   <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">3950 </span>
<span class="line_number">3951 </span>    <span class="sign">!</span>set type and value<span class="sign">:</span>
<span class="line_number">3952 </span>    <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> me<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3953 </span>        call me<span class="sign">%</span>data<span class="sign">%</span>destroy<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3954 </span>        me<span class="sign">%</span>data<span class="sign">%</span>var_type <span class="sign">=</span> json_object
<span class="line_number">3955 </span>    <span class="sign">!</span>end associate
<span class="line_number">3956 </span>
<span class="line_number">3957 </span>    <span class="sign">!</span>name<span class="sign">:</span>
<span class="line_number">3958 </span>    if <span class="sign">(</span>present<span class="sign">(</span>name<span class="sign">)</span><span class="sign">)</span> me<span class="sign">%</span>name <span class="sign">=</span> trim<span class="sign">(</span>name<span class="sign">)</span>
<span class="line_number">3959 </span>
<span class="line_number">3960 </span>    end subroutine <strong>to_object</strong>
</pre>

<hr />
<a name="json5fmodule2fto5freal"></a>
<a name="robo75"></a><h2>json_module/to_real [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>to_real</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Change the variable to a double.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3832 </span>    subroutine <strong>to_real</strong><span class="sign">(</span>me<span class="sign">,</span>val<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">3833 </span>
<span class="line_number">3834 </span>    implicit none
<span class="line_number">3835 </span>
<span class="line_number">3836 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> intent<span class="sign">(</span>inout<span class="sign">)</span>        <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">3837 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional   <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">3838 </span>    real<span class="sign">(</span>wp<span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional           <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">3839 </span>
<span class="line_number">3840 </span>    <span class="sign">!</span>set type and value<span class="sign">:</span>
<span class="line_number">3841 </span>    <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> me<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3842 </span>        call me<span class="sign">%</span>data<span class="sign">%</span>destroy<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3843 </span>        me<span class="sign">%</span>data<span class="sign">%</span>var_type <span class="sign">=</span> json_real
<span class="line_number">3844 </span>        allocate<span class="sign">(</span>me<span class="sign">%</span>data<span class="sign">%</span>dbl_value<span class="sign">)</span>
<span class="line_number">3845 </span>        if <span class="sign">(</span>present<span class="sign">(</span>val<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3846 </span>            me<span class="sign">%</span>data<span class="sign">%</span>dbl_value <span class="sign">=</span> val
<span class="line_number">3847 </span>        else
<span class="line_number">3848 </span>            me<span class="sign">%</span>data<span class="sign">%</span>dbl_value <span class="sign">=</span> 0<span class="sign">.</span>0_wp    <span class="sign">!</span>default value
<span class="line_number">3849 </span>        end if
<span class="line_number">3850 </span>    <span class="sign">!</span>end associate
<span class="line_number">3851 </span>
<span class="line_number">3852 </span>    <span class="sign">!</span>name<span class="sign">:</span>
<span class="line_number">3853 </span>    if <span class="sign">(</span>present<span class="sign">(</span>name<span class="sign">)</span><span class="sign">)</span> me<span class="sign">%</span>name <span class="sign">=</span> trim<span class="sign">(</span>name<span class="sign">)</span>
<span class="line_number">3854 </span>
<span class="line_number">3855 </span>    end subroutine <strong>to_real</strong>
</pre>

<hr />
<a name="json5fmodule2fto5fstring"></a>
<a name="robo76"></a><h2>json_module/to_string [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>to_string</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Change the variable to a string.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3872 </span>    subroutine <strong>to_string</strong><span class="sign">(</span>me<span class="sign">,</span>val<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">3873 </span>
<span class="line_number">3874 </span>    implicit none
<span class="line_number">3875 </span>
<span class="line_number">3876 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span> intent<span class="sign">(</span>inout<span class="sign">)</span>        <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">3877 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional   <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">3878 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional   <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">3879 </span>
<span class="line_number">3880 </span>    <span class="sign">!</span>set type and value<span class="sign">:</span>
<span class="line_number">3881 </span>    <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> me<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3882 </span>        call me<span class="sign">%</span>data<span class="sign">%</span>destroy<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3883 </span>        me<span class="sign">%</span>data<span class="sign">%</span>var_type <span class="sign">=</span> json_string
<span class="line_number">3884 </span>        if <span class="sign">(</span>present<span class="sign">(</span>val<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3885 </span>            me<span class="sign">%</span>data<span class="sign">%</span>str_value <span class="sign">=</span> val
<span class="line_number">3886 </span>        else
<span class="line_number">3887 </span>            me<span class="sign">%</span>data<span class="sign">%</span>str_value <span class="sign">=</span> <span class="squote">''</span>    <span class="sign">!</span>default value
<span class="line_number">3888 </span>        end if
<span class="line_number">3889 </span>    <span class="sign">!</span>end associate
<span class="line_number">3890 </span>
<span class="line_number">3891 </span>    <span class="sign">!</span>name<span class="sign">:</span>
<span class="line_number">3892 </span>    if <span class="sign">(</span>present<span class="sign">(</span>name<span class="sign">)</span><span class="sign">)</span> me<span class="sign">%</span>name <span class="sign">=</span> trim<span class="sign">(</span>name<span class="sign">)</span>
<span class="line_number">3893 </span>
<span class="line_number">3894 </span>    end subroutine <strong>to_string</strong>
</pre>

<hr />
<a name="json5fmodule2fvariable5finfo5fin5ffile"></a>
<a name="robo77"></a><h2>json_module/variable_info_in_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>variable_info_in_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%info(path,found,var_type,n_children)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Returns information about a variable in a file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 2/3/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">614 </span>    subroutine <strong>variable_info_in_file</strong><span class="sign">(</span>me<span class="sign">,</span>path<span class="sign">,</span>found<span class="sign">,</span>var_type<span class="sign">,</span>n_children<span class="sign">)</span>
<span class="line_number">615 </span>
<span class="line_number">616 </span>    implicit none
<span class="line_number">617 </span>
<span class="line_number">618 </span>    class<span class="sign">(</span><a href="#robo21">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">619 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">620 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>            <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">621 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>            <span class="sign">:</span><span class="sign">:</span> var_type
<span class="line_number">622 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>            <span class="sign">:</span><span class="sign">:</span> n_children
<span class="line_number">623 </span>
<span class="line_number">624 </span>    type<span class="sign">(</span><a href="#robo44">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">625 </span>
<span class="line_number">626 </span>    <span class="sign">!</span>initialize<span class="sign">:</span>
<span class="line_number">627 </span>    nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">628 </span>
<span class="line_number">629 </span>    <span class="sign">!</span>get a pointer to the variable <span class="sign">(</span>if it is there<span class="sign">)</span><span class="sign">:</span>
<span class="line_number">630 </span>    call me<span class="sign">%</span>get<span class="sign">(</span>path<span class="sign">,</span>p<span class="sign">,</span>found<span class="sign">)</span>
<span class="line_number">631 </span>
<span class="line_number">632 </span>    if <span class="sign">(</span>found<span class="sign">)</span> then
<span class="line_number">633 </span>
<span class="line_number">634 </span>        <span class="sign">!</span>get info<span class="sign">:</span>
<span class="line_number">635 </span>        call <a href="#robo33">json_info</a><span class="sign">(</span>p<span class="sign">,</span>var_type<span class="sign">,</span>n_children<span class="sign">)</span>
<span class="line_number">636 </span>
<span class="line_number">637 </span>    else
<span class="line_number">638 </span>
<span class="line_number">639 </span>        <span class="sign">!</span>set to dummy values<span class="sign">:</span>
<span class="line_number">640 </span>        var_type <span class="sign">=</span> json_unknown
<span class="line_number">641 </span>        n_children <span class="sign">=</span> 0
<span class="line_number">642 </span>
<span class="line_number">643 </span>    end if
<span class="line_number">644 </span>
<span class="line_number">645 </span>    <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">646 </span>    nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">647 </span>
<span class="line_number">648 </span>    end subroutine <strong>variable_info_in_file</strong>
</pre>

</div> <!-- content -->
<div id="footer">
<p>Generated from ./src/json_module.f90 with <a href="http://www.xs4all.nl/~rfsber/Robo/robodoc.html">ROBODoc</a> V4.99.38 on Tue Dec 23 2014 21:00:53
</p>
</div> <!-- footer -->
</body>
</html>
