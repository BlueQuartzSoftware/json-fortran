<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-type" content="text/html; charset=ISO-8859-1" />
<link rel="stylesheet" href="./robodoc.css" type="text/css" />
<title>./src/json_module.f90</title>
<!-- Source: ./src/json_module.f90 -->
<!-- Generated with ROBODoc Version 4.99.38 (Jun 13 2014) -->
</head>
<body>
<div id="logo">
<a name="robo_top_of_doc">jsonfortran</a>
</div> <!-- logo -->
<div id="navigation">
<a class="menuitem" href="./toc_index.html#top">Table of Contents</a>
<a class="menuitem" href="./robo_sourcefiles.html#top">Sourcefiles</a>
<a class="menuitem" href="./masterindex.html#top">Index</a>
<a class="menuitem" href="./robo_classes.html#top">Classes</a>
<a class="menuitem" href="./robo_functions.html#top">Functions</a>
<a class="menuitem" href="./robo_modules.html#top">Modules</a>
<a class="menuitem" href="./robo_unittests.html#top">Unittest</a>
</div> <!-- navigation -->
<div id="content">
<hr />
<a name="JSON2fjson5fmodule"></a>
<a name="robo0"></a><h2>JSON/json_module [ Modules ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="./robo_modules.html#robo_top_of_doc">Modules</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_module</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    JSON-FORTRAN: A Fortran 2008 JSON (JavaScript Object Notation) API.
</pre>
<p class="item_name">NOTES</p>
<pre>    -Based on fson by Joseph A. Levin (see License below)
        -The original F95 code was split into four files:
            fson_path_m.f95, fson_string_m.f95, fson_value_m.f95, fson.f95
        -The code has been extensively modified and combined into this one module (<a href="#robo_top_of_doc">json_module.f90</a>).
        -Some Fortran 2003/2008 features are now used 
            (e.g., allocatable strings, associate, newunit, generic, class, and abstract interface)
    -The headers in this file follow the ROBODoc conventions.
            Compile with: robodoc --src ./ --doc ./doc --multidoc --html 
                                  --tabsize 4 --ignore_case_when_linking 
                                  --syntaxcolors --source_line_numbers --index
</pre>
<p class="item_name">HISTORY</p>
<pre>    Joseph A. Levin : March 2012
    Jacob Williams : 2/8/2013 : Extensive modifications to the original code.
</pre>
<p class="item_name">SEE ALSO</p>
<pre>    [1] <a href="http://github.com/jacobwilliams/json-fortran">http://github.com/jacobwilliams/json-fortran</a> [json-fortran development site]
    [2] <a href="http://jacobwilliams.github.io/json-fortran">http://jacobwilliams.github.io/json-fortran</a> [json-fortran online documentation]
    [3] <a href="http://github.com/josephalevin/fson">http://github.com/josephalevin/fson</a> [FSON code retrieved on 12/2/2013]
    [4] <a href="http://www.json.org/">http://www.json.org/</a> [JSON website]
    [5] <a href="http://jsonlint.com/">http://jsonlint.com/</a> [JSON validator]
</pre>
<p class="item_name">COPYRIGHT</p>
<pre>    -----------------------------------------------------------------------------------------
    json-fortran License:

    JSON-FORTRAN: A Fortran 2003/2008 JSON API
    <a href="http://github.com/jacobwilliams/json-fortran">http://github.com/jacobwilliams/json-fortran</a>

    Copyright (c) 2014, Jacob Williams
    All rights reserved.

    Redistribution and use in source and binary forms, with or without modification,
    are permitted provided that the following conditions are met:

    * Redistributions of source code must retain the above copyright notice, this
      list of conditions and the following disclaimer.

    * Redistributions in binary form must reproduce the above copyright notice, this
      list of conditions and the following disclaimer in the documentation and/or
      other materials provided with the distribution.

    * The names of its contributors may not be used to endorse or promote products 
      derived from this software without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
    ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
    WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
    DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
    ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
    (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
    LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
    ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

    -----------------------------------------------------------------------------------------
    Original FSON License:

    Copyright (c) 2012 Joseph A. Levin

    Permission is hereby granted, free of charge, to any person obtaining a copy of this
    software and associated documentation files (the "Software"), to deal in the Software
    without restriction, including without limitation the rights to use, copy, modify, merge,
    publish, distribute, sublicense, and/or sell copies of the Software, and to permit
    persons to whom the Software is furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all copies or
    substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,
    INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR
    PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
    LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT
    OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
    DEALINGS IN THE SOFTWARE.
</pre>

<hr />
<a name="json5fmodule2fdestroy5fjson5fdata5fnon5fpolymorphic"></a>
<a name="robo2"></a><h2>json_module/destroy_json_data_non_polymorphic [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>destroy_json_data_non_polymorphic</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%destroy()
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Destroy the nonpolymorphic data type.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">345 </span>    subroutine <strong>destroy_json_data_non_polymorphic</strong><span class="sign">(</span>me<span class="sign">)</span>
<span class="line_number">346 </span>
<span class="line_number">347 </span>    implicit none
<span class="line_number">348 </span>
<span class="line_number">349 </span>    class<span class="sign">(</span><a href="#robo20">json_data_non_polymorphic</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">350 </span>
<span class="line_number">351 </span>    me<span class="sign">%</span>var_type <span class="sign">=</span> 0
<span class="line_number">352 </span>
<span class="line_number">353 </span>    if <span class="sign">(</span>allocated<span class="sign">(</span>me<span class="sign">%</span>log_value<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>me<span class="sign">%</span>log_value<span class="sign">)</span>
<span class="line_number">354 </span>    if <span class="sign">(</span>allocated<span class="sign">(</span>me<span class="sign">%</span>int_value<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>me<span class="sign">%</span>int_value<span class="sign">)</span>
<span class="line_number">355 </span>    if <span class="sign">(</span>allocated<span class="sign">(</span>me<span class="sign">%</span>dbl_value<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>me<span class="sign">%</span>dbl_value<span class="sign">)</span>
<span class="line_number">356 </span>    if <span class="sign">(</span>allocated<span class="sign">(</span>me<span class="sign">%</span>str_value<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>me<span class="sign">%</span>str_value<span class="sign">)</span>
<span class="line_number">357 </span>
<span class="line_number">358 </span>    end subroutine <strong>destroy_json_data_non_polymorphic</strong>
</pre>

<hr />
<a name="json5fmodule2fdestroy5fjson5ffile"></a>
<a name="robo3"></a><h2>json_module/destroy_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>destroy_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%destroy()
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Destroy the JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/9/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">378 </span>    subroutine <strong>destroy_json_file</strong><span class="sign">(</span>me<span class="sign">)</span>
<span class="line_number">379 </span>    
<span class="line_number">380 </span>    implicit none
<span class="line_number">381 </span>
<span class="line_number">382 </span>    class<span class="sign">(</span><a href="#robo22">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">383 </span>
<span class="line_number">384 </span>    if <span class="sign">(</span>associated<span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">)</span><span class="sign">)</span> call <a href="#robo48">json_value_destroy</a><span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">)</span>
<span class="line_number">385 </span>
<span class="line_number">386 </span>    end subroutine <strong>destroy_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fescape5fstring"></a>
<a name="robo4"></a><h2>json_module/escape_string [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>escape_string</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Add the escape characters to a string for adding to JSON.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/21/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1434 </span>    subroutine <strong>escape_string</strong><span class="sign">(</span>str_in<span class="sign">,</span> str_out<span class="sign">)</span>
<span class="line_number">1435 </span>
<span class="line_number">1436 </span>    implicit none
<span class="line_number">1437 </span>
<span class="line_number">1438 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>              <span class="sign">:</span><span class="sign">:</span> str_in
<span class="line_number">1439 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> str_out
<span class="line_number">1440 </span>
<span class="line_number">1441 </span>    integer <span class="sign">:</span><span class="sign">:</span> i
<span class="line_number">1442 </span>    character<span class="sign">(</span>len<span class="sign">=</span>1<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> c
<span class="line_number">1443 </span>
<span class="line_number">1444 </span>    str_out <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">1445 </span>
<span class="line_number">1446 </span>    <span class="sign">!</span>go through the string and look for special characters<span class="sign">:</span>
<span class="line_number">1447 </span>    do i<span class="sign">=</span>1<span class="sign">,</span>len<span class="sign">(</span>str_in<span class="sign">)</span>
<span class="line_number">1448 </span>
<span class="line_number">1449 </span>        c <span class="sign">=</span> str_in<span class="sign">(</span>i<span class="sign">:</span>i<span class="sign">)</span>    <span class="sign">!</span>get next character in the input string
<span class="line_number">1450 </span>
<span class="line_number">1451 </span>        select case<span class="sign">(</span>c<span class="sign">)</span>
<span class="line_number">1452 </span>
<span class="line_number">1453 </span>        case<span class="sign">(</span>quotation_mark<span class="sign">,</span>backslash<span class="sign">,</span>slash<span class="sign">,</span>bspace<span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">1454 </span>             formfeed<span class="sign">,</span>newline<span class="sign">,</span>carriage_return<span class="sign">,</span>horizontal_tab<span class="sign">)</span>    <span class="sign">!</span>special characters
<span class="line_number">1455 </span>            select case<span class="sign">(</span>c<span class="sign">)</span>
<span class="line_number">1456 </span>            case<span class="sign">(</span>quotation_mark<span class="sign">,</span>backslash<span class="sign">,</span>slash<span class="sign">)</span>
<span class="line_number">1457 </span>                str_out <span class="sign">=</span> str_out<span class="sign">/</span><span class="sign">/</span>backslash<span class="sign">/</span><span class="sign">/</span>c    <span class="sign">!</span>add escape char
<span class="line_number">1458 </span>            case<span class="sign">(</span>bspace<span class="sign">)</span>
<span class="line_number">1459 </span>                str_out <span class="sign">=</span> str_out<span class="sign">/</span><span class="sign">/</span><span class="squote">'\b'</span>        <span class="sign">!</span>backspace
<span class="line_number">1460 </span>            case<span class="sign">(</span>formfeed<span class="sign">)</span>
<span class="line_number">1461 </span>                str_out <span class="sign">=</span> str_out<span class="sign">/</span><span class="sign">/</span><span class="squote">'\f'</span>        <span class="sign">!</span>formfeed
<span class="line_number">1462 </span>            case<span class="sign">(</span>newline<span class="sign">)</span>
<span class="line_number">1463 </span>                str_out <span class="sign">=</span> str_out<span class="sign">/</span><span class="sign">/</span><span class="squote">'\n'</span>        <span class="sign">!</span>new line
<span class="line_number">1464 </span>            case<span class="sign">(</span>carriage_return<span class="sign">)</span>
<span class="line_number">1465 </span>                str_out <span class="sign">=</span> str_out<span class="sign">/</span><span class="sign">/</span><span class="squote">'\r'</span>        <span class="sign">!</span>carriage return
<span class="line_number">1466 </span>            case<span class="sign">(</span>horizontal_tab<span class="sign">)</span>
<span class="line_number">1467 </span>                str_out <span class="sign">=</span> str_out<span class="sign">/</span><span class="sign">/</span><span class="squote">'\t'</span>        <span class="sign">!</span>horizontal tab
<span class="line_number">1468 </span>            end select
<span class="line_number">1469 </span>        case default
<span class="line_number">1470 </span>            str_out <span class="sign">=</span> str_out<span class="sign">/</span><span class="sign">/</span>c
<span class="line_number">1471 </span>        end select
<span class="line_number">1472 </span>
<span class="line_number">1473 </span>    end do
<span class="line_number">1474 </span>
<span class="line_number">1475 </span>    end subroutine <strong>escape_string</strong>
</pre>

<hr />
<a name="json5fmodule2fget5fby5findex"></a>
<a name="robo5"></a><h2>json_module/get_by_index [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_by_index</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Returns a child in the object given the index.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1608 </span>    subroutine <strong>get_by_index</strong><span class="sign">(</span>this<span class="sign">,</span> idx<span class="sign">,</span> p<span class="sign">)</span>
<span class="line_number">1609 </span>
<span class="line_number">1610 </span>    implicit none
<span class="line_number">1611 </span>
<span class="line_number">1612 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">1613 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                  <span class="sign">:</span><span class="sign">:</span> idx
<span class="line_number">1614 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer           <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">1615 </span>
<span class="line_number">1616 </span>    integer <span class="sign">:</span><span class="sign">:</span> i
<span class="line_number">1617 </span>
<span class="line_number">1618 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">1619 </span>
<span class="line_number">1620 </span>        nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">1621 </span>
<span class="line_number">1622 </span>        if <span class="sign">(</span>associated<span class="sign">(</span>this<span class="sign">%</span>children<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1623 </span>
<span class="line_number">1624 </span>            p <span class="sign">=</span><span class="sign">&gt;</span> this<span class="sign">%</span>children
<span class="line_number">1625 </span>
<span class="line_number">1626 </span>            do i <span class="sign">=</span> 1<span class="sign">,</span> idx <span class="sign">-</span> 1
<span class="line_number">1627 </span>
<span class="line_number">1628 </span>                if <span class="sign">(</span>associated<span class="sign">(</span>p<span class="sign">%</span>next<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1629 </span>                    p <span class="sign">=</span><span class="sign">&gt;</span> p<span class="sign">%</span>next
<span class="line_number">1630 </span>                else
<span class="line_number">1631 </span>                    call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>get_by_index</strong>: p%next is not associated.'</span><span class="sign">)</span>
<span class="line_number">1632 </span>                    return
<span class="line_number">1633 </span>                end if
<span class="line_number">1634 </span>
<span class="line_number">1635 </span>            end do
<span class="line_number">1636 </span>
<span class="line_number">1637 </span>        else
<span class="line_number">1638 </span>
<span class="line_number">1639 </span>            call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>get_by_index</strong>: this%children is not associated.'</span><span class="sign">)</span>
<span class="line_number">1640 </span>
<span class="line_number">1641 </span>        end if
<span class="line_number">1642 </span>
<span class="line_number">1643 </span>    end if
<span class="line_number">1644 </span>
<span class="line_number">1645 </span>    end subroutine <strong>get_by_index</strong>
</pre>

<hr />
<a name="json5fmodule2fget5fby5fname5fchars"></a>
<a name="robo6"></a><h2>json_module/get_by_name_chars [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_by_name_chars</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Returns a child in the object given the name string.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1659 </span>    subroutine <strong>get_by_name_chars</strong><span class="sign">(</span>this<span class="sign">,</span> name<span class="sign">,</span> p<span class="sign">)</span>
<span class="line_number">1660 </span>
<span class="line_number">1661 </span>    implicit none
<span class="line_number">1662 </span>
<span class="line_number">1663 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">1664 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>         <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1665 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer            <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">1666 </span>
<span class="line_number">1667 </span>    integer <span class="sign">:</span><span class="sign">:</span> i
<span class="line_number">1668 </span>
<span class="line_number">1669 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">1670 </span>
<span class="line_number">1671 </span>        if <span class="sign">(</span>associated<span class="sign">(</span>this<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1672 </span>
<span class="line_number">1673 </span>            nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">1674 </span>
<span class="line_number">1675 </span>            if <span class="sign">(</span>this<span class="sign">%</span>data<span class="sign">%</span>var_type<span class="sign">=</span><span class="sign">=</span>json_object<span class="sign">)</span> then
<span class="line_number">1676 </span>                do i<span class="sign">=</span>1<span class="sign">,</span> <a href="#robo46">json_value_count</a><span class="sign">(</span>this<span class="sign">)</span>
<span class="line_number">1677 </span>                    call json_value_get<span class="sign">(</span>this<span class="sign">,</span> i<span class="sign">,</span> p<span class="sign">)</span>
<span class="line_number">1678 </span>                    if <span class="sign">(</span>allocated<span class="sign">(</span>p<span class="sign">%</span>name<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1679 </span>                        if <span class="sign">(</span>p<span class="sign">%</span>name <span class="sign">=</span><span class="sign">=</span> name<span class="sign">)</span> return
<span class="line_number">1680 </span>                    end if
<span class="line_number">1681 </span>                end do
<span class="line_number">1682 </span>            end if
<span class="line_number">1683 </span>
<span class="line_number">1684 </span>            <span class="sign">!</span>did not find anything<span class="sign">:</span>
<span class="line_number">1685 </span>            nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">1686 </span>
<span class="line_number">1687 </span>        else
<span class="line_number">1688 </span>            call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>get_by_name_chars</strong>: pointer is not associated.'</span><span class="sign">)</span>
<span class="line_number">1689 </span>        end if
<span class="line_number">1690 </span>
<span class="line_number">1691 </span>    end if
<span class="line_number">1692 </span>
<span class="line_number">1693 </span>    end subroutine <strong>get_by_name_chars</strong>
</pre>

<hr />
<a name="json5fmodule2fget5fchar5fvec5ffrom5fjson5ffile"></a>
<a name="robo7"></a><h2>json_module/get_char_vec_from_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_char_vec_from_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%get(path,vec)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a char vector from a JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/19/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">810 </span>    subroutine <strong>get_char_vec_from_json_file</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">811 </span>
<span class="line_number">812 </span>    implicit none
<span class="line_number">813 </span>
<span class="line_number">814 </span>    class<span class="sign">(</span><a href="#robo22">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span>                         <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">815 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                            <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">816 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> vec
<span class="line_number">817 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                           <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">818 </span>
<span class="line_number">819 </span>    call json_get<span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">820 </span>
<span class="line_number">821 </span>    end subroutine <strong>get_char_vec_from_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fget5fchars5ffrom5fjson5ffile"></a>
<a name="robo8"></a><h2>json_module/get_chars_from_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_chars_from_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%get(path,val)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a character string from a json file.
    Note: val is an allocatable character string.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/9/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">779 </span>    subroutine <strong>get_chars_from_json_file</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> val<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">780 </span>
<span class="line_number">781 </span>    implicit none
<span class="line_number">782 </span>
<span class="line_number">783 </span>    class<span class="sign">(</span><a href="#robo22">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span>              <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">784 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                 <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">785 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">786 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">787 </span>
<span class="line_number">788 </span>    call json_get<span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> value<span class="sign">=</span>val<span class="sign">,</span> found<span class="sign">=</span>found<span class="sign">)</span>
<span class="line_number">789 </span>
<span class="line_number">790 </span>    end subroutine <strong>get_chars_from_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fget5fcurrent5fline5ffrom5ffile"></a>
<a name="robo9"></a><h2>json_module/get_current_line_from_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_current_line_from_file</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Rewind the file to the beginning of the current line, and return this line.
    The file is assumed to be opened.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3040 </span>    subroutine <strong>get_current_line_from_file</strong><span class="sign">(</span>iunit<span class="sign">,</span>line<span class="sign">)</span>
<span class="line_number">3041 </span>    
<span class="line_number">3042 </span>    implicit none
<span class="line_number">3043 </span>    
<span class="line_number">3044 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> iunit
<span class="line_number">3045 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> line
<span class="line_number">3046 </span>    
<span class="line_number">3047 </span>    integer<span class="sign">,</span>parameter           <span class="sign">:</span><span class="sign">:</span> n_chunk <span class="sign">=</span> 256      <span class="sign">!</span>chunk size <span class="sign">[</span>arbitrary<span class="sign">]</span>
<span class="line_number">3048 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>parameter  <span class="sign">:</span><span class="sign">:</span> nfmt <span class="sign">=</span> <span class="squote">'(A256)'</span>    <span class="sign">!</span>corresponding format statement
<span class="line_number">3049 </span>    
<span class="line_number">3050 </span>    character<span class="sign">(</span>len<span class="sign">=</span>n_chunk<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> chunk
<span class="line_number">3051 </span>    integer <span class="sign">:</span><span class="sign">:</span> istat<span class="sign">,</span>isize
<span class="line_number">3052 </span>    
<span class="line_number">3053 </span>    <span class="sign">!</span>initialize<span class="sign">:</span>
<span class="line_number">3054 </span>    line <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">3055 </span>
<span class="line_number">3056 </span>    <span class="sign">!</span>rewind to beginning of the current record<span class="sign">:</span>
<span class="line_number">3057 </span>    backspace<span class="sign">(</span>iunit<span class="sign">,</span> iostat<span class="sign">=</span>istat<span class="sign">)</span>
<span class="line_number">3058 </span>
<span class="line_number">3059 </span>    <span class="sign">!</span>loop to read in all the characters in the current record<span class="sign">.</span>
<span class="line_number">3060 </span>    <span class="sign">!</span><span class="sign">[</span>the line is read in chunks until the end of the line is reached<span class="sign">]</span>
<span class="line_number">3061 </span>    if <span class="sign">(</span>istat<span class="sign">=</span><span class="sign">=</span>0<span class="sign">)</span> then
<span class="line_number">3062 </span>        do
<span class="line_number">3063 </span>            read<span class="sign">(</span>iunit<span class="sign">,</span>fmt<span class="sign">=</span>nfmt<span class="sign">,</span>advance<span class="sign">=</span><span class="squote">'NO'</span><span class="sign">,</span>size<span class="sign">=</span>isize<span class="sign">,</span>iostat<span class="sign">=</span>istat<span class="sign">)</span> chunk
<span class="line_number">3064 </span>            if <span class="sign">(</span>istat<span class="sign">=</span><span class="sign">=</span>0<span class="sign">)</span> then            
<span class="line_number">3065 </span>                line <span class="sign">=</span> line<span class="sign">/</span><span class="sign">/</span>chunk
<span class="line_number">3066 </span>            else
<span class="line_number">3067 </span>                if <span class="sign">(</span>isize<span class="sign">&gt;</span>0<span class="sign">)</span> line <span class="sign">=</span> line<span class="sign">/</span><span class="sign">/</span>chunk<span class="sign">(</span>1<span class="sign">:</span>isize<span class="sign">)</span>
<span class="line_number">3068 </span>                exit
<span class="line_number">3069 </span>            end if
<span class="line_number">3070 </span>        end do
<span class="line_number">3071 </span>    end if
<span class="line_number">3072 </span>    
<span class="line_number">3073 </span>    end subroutine <strong>get_current_line_from_file</strong>
</pre>

<hr />
<a name="json5fmodule2fget5fdouble5ffrom5fjson5ffile"></a>
<a name="robo10"></a><h2>json_module/get_double_from_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_double_from_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%get(path,val,found)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a double from a JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/9/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">654 </span>    subroutine <strong>get_double_from_json_file</strong> <span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> val<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">655 </span>
<span class="line_number">656 </span>    implicit none
<span class="line_number">657 </span>
<span class="line_number">658 </span>    class<span class="sign">(</span><a href="#robo22">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">659 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>     <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">660 </span>    real<span class="sign">(</span>wp<span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>            <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">661 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional    <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">662 </span>
<span class="line_number">663 </span>    call json_get<span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> value<span class="sign">=</span>val<span class="sign">,</span> found<span class="sign">=</span>found<span class="sign">)</span>
<span class="line_number">664 </span>
<span class="line_number">665 </span>    end subroutine <strong>get_double_from_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fget5fdouble5fvec5ffrom5fjson5ffile"></a>
<a name="robo11"></a><h2>json_module/get_double_vec_from_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_double_vec_from_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%get(path,vec,found)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a double vector from a JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/19/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">685 </span>    subroutine <strong>get_double_vec_from_json_file</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">686 </span>    
<span class="line_number">687 </span>    implicit none
<span class="line_number">688 </span>
<span class="line_number">689 </span>    class<span class="sign">(</span><a href="#robo22">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span>                  <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">690 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                     <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">691 </span>    real<span class="sign">(</span>wp<span class="sign">)</span><span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>   <span class="sign">:</span><span class="sign">:</span> vec
<span class="line_number">692 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                    <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">693 </span>
<span class="line_number">694 </span>    call json_get<span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">695 </span>
<span class="line_number">696 </span>    end subroutine <strong>get_double_vec_from_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fget5finteger5ffrom5fjson5ffile"></a>
<a name="robo12"></a><h2>json_module/get_integer_from_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_integer_from_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%get(path,val)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get an integer from a JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/9/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">591 </span>    subroutine <strong>get_integer_from_json_file</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> val<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">592 </span>
<span class="line_number">593 </span>    implicit none
<span class="line_number">594 </span>
<span class="line_number">595 </span>    class<span class="sign">(</span><a href="#robo22">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">596 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>       <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">597 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>               <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">598 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional      <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">599 </span>
<span class="line_number">600 </span>    call json_get<span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> value<span class="sign">=</span>val<span class="sign">,</span> found<span class="sign">=</span>found<span class="sign">)</span>
<span class="line_number">601 </span>
<span class="line_number">602 </span>    end subroutine <strong>get_integer_from_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fget5finteger5fvec5ffrom5fjson5ffile"></a>
<a name="robo13"></a><h2>json_module/get_integer_vec_from_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_integer_vec_from_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%get(path,vec)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get an integer vector from a JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/20/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">622 </span>    subroutine <strong>get_integer_vec_from_json_file</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">623 </span>
<span class="line_number">624 </span>    implicit none
<span class="line_number">625 </span>
<span class="line_number">626 </span>    class<span class="sign">(</span><a href="#robo22">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span>                  <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">627 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                     <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">628 </span>    integer<span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> vec
<span class="line_number">629 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                    <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">630 </span>
<span class="line_number">631 </span>
<span class="line_number">632 </span>    call json_get<span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">633 </span>
<span class="line_number">634 </span>    end subroutine <strong>get_integer_vec_from_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fget5flogical5ffrom5fjson5ffile"></a>
<a name="robo14"></a><h2>json_module/get_logical_from_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_logical_from_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%get(path,val,found)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get an logical from a JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/9/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">716 </span>    subroutine <strong>get_logical_from_json_file</strong><span class="sign">(</span>me<span class="sign">,</span>path<span class="sign">,</span>val<span class="sign">,</span>found<span class="sign">)</span>
<span class="line_number">717 </span>
<span class="line_number">718 </span>    implicit none
<span class="line_number">719 </span>
<span class="line_number">720 </span>    class<span class="sign">(</span><a href="#robo22">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">721 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>     <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">722 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>             <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">723 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional    <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">724 </span>
<span class="line_number">725 </span>    call json_get<span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> value<span class="sign">=</span>val<span class="sign">,</span> found<span class="sign">=</span>found<span class="sign">)</span>
<span class="line_number">726 </span>
<span class="line_number">727 </span>    end subroutine <strong>get_logical_from_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fget5flogical5fvec5ffrom5fjson5ffile"></a>
<a name="robo15"></a><h2>json_module/get_logical_vec_from_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_logical_vec_from_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%get(path,vec)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a logical vector from a JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/20/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">747 </span>    subroutine <strong>get_logical_vec_from_json_file</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">748 </span>
<span class="line_number">749 </span>    implicit none
<span class="line_number">750 </span>
<span class="line_number">751 </span>    class<span class="sign">(</span><a href="#robo22">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span>                 <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">752 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                    <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">753 </span>    logical<span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>   <span class="sign">:</span><span class="sign">:</span> vec
<span class="line_number">754 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                   <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">755 </span>    
<span class="line_number">756 </span>    call json_get<span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">757 </span>
<span class="line_number">758 </span>    end subroutine <strong>get_logical_vec_from_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fget5fobject5ffrom5fjson5ffile"></a>
<a name="robo16"></a><h2>json_module/get_object_from_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>get_object_from_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%get(path,p,found)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a pointer to an object from a JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 2/3/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">560 </span>    subroutine <strong>get_object_from_json_file</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> p<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">561 </span>    
<span class="line_number">562 </span>    implicit none
<span class="line_number">563 </span>
<span class="line_number">564 </span>    class<span class="sign">(</span><a href="#robo22">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span>          <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">565 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>             <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">566 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">567 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional            <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">568 </span>
<span class="line_number">569 </span>    call <a href="#robo24">json_get_by_path</a><span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> p<span class="sign">=</span>p<span class="sign">,</span> found<span class="sign">=</span>found<span class="sign">)</span>
<span class="line_number">570 </span>
<span class="line_number">571 </span>    end subroutine <strong>get_object_from_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2finteger5fto5fstring"></a>
<a name="robo17"></a><h2>json_module/integer_to_string [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>integer_to_string</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Convert an integer to a string.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/4/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3970 </span>    subroutine <strong>integer_to_string</strong><span class="sign">(</span>ival<span class="sign">,</span>str<span class="sign">)</span>
<span class="line_number">3971 </span>
<span class="line_number">3972 </span>    implicit none
<span class="line_number">3973 </span>
<span class="line_number">3974 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>           <span class="sign">:</span><span class="sign">:</span> ival
<span class="line_number">3975 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> str
<span class="line_number">3976 </span>
<span class="line_number">3977 </span>    integer <span class="sign">:</span><span class="sign">:</span> istat
<span class="line_number">3978 </span>
<span class="line_number">3979 </span>    write<span class="sign">(</span>str<span class="sign">,</span>fmt<span class="sign">=</span>int_fmt<span class="sign">,</span>iostat<span class="sign">=</span>istat<span class="sign">)</span> ival
<span class="line_number">3980 </span>
<span class="line_number">3981 </span>    if <span class="sign">(</span>istat<span class="sign">=</span><span class="sign">=</span>0<span class="sign">)</span> then
<span class="line_number">3982 </span>        str <span class="sign">=</span> adjustl<span class="sign">(</span>str<span class="sign">)</span>
<span class="line_number">3983 </span>    else
<span class="line_number">3984 </span>        str <span class="sign">=</span> repeat<span class="sign">(</span><span class="squote">'*'</span><span class="sign">,</span>len<span class="sign">(</span>str<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">3985 </span>    end if
<span class="line_number">3986 </span>
<span class="line_number">3987 </span>    end subroutine <strong>integer_to_string</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fcheck5ffor5ferrors"></a>
<a name="robo18"></a><h2>json_module/json_check_for_errors [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_check_for_errors</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Retrieve error code from the module.
    This should be called after <a href="#robo35">json_parse</a> to check for errors.
    If an error is thrown, before using the module again, <a href="#robo34">json_initialize</a>
    should be called to clean up before it is used again.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/4/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">939 </span>    subroutine <strong>json_check_for_errors</strong><span class="sign">(</span>status_ok<span class="sign">,</span> error_msg<span class="sign">)</span>
<span class="line_number">940 </span>
<span class="line_number">941 </span>    implicit none
<span class="line_number">942 </span>
<span class="line_number">943 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> status_ok
<span class="line_number">944 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> error_msg
<span class="line_number">945 </span>
<span class="line_number">946 </span>    status_ok <span class="sign">=</span> <span class="sign">.</span>not<span class="sign">.</span> exception_thrown
<span class="line_number">947 </span>
<span class="line_number">948 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> status_ok<span class="sign">)</span> then
<span class="line_number">949 </span>        if <span class="sign">(</span>allocated<span class="sign">(</span>err_message<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">950 </span>            error_msg <span class="sign">=</span> err_message
<span class="line_number">951 </span>        else
<span class="line_number">952 </span>            error_msg <span class="sign">=</span> <span class="squote">'Unknown Error'</span>
<span class="line_number">953 </span>        end if
<span class="line_number">954 </span>    else
<span class="line_number">955 </span>        error_msg <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">956 </span>    end if
<span class="line_number">957 </span>
<span class="line_number">958 </span>    end subroutine <strong>json_check_for_errors</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fclear5fexceptions"></a>
<a name="robo19"></a><h2>json_module/json_clear_exceptions [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_clear_exceptions</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Clear exceptions in the JSON module.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/4/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">870 </span>    subroutine <strong>json_clear_exceptions</strong><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">871 </span>
<span class="line_number">872 </span>    implicit none
<span class="line_number">873 </span>
<span class="line_number">874 </span>    <span class="sign">!</span>clear the flag and message<span class="sign">:</span>
<span class="line_number">875 </span>    exception_thrown <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">876 </span>    err_message <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">877 </span>
<span class="line_number">878 </span>    end subroutine <strong>json_clear_exceptions</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fdata5fnon5fpolymorphic"></a>
<a name="robo20"></a><h2>json_module/json_data_non_polymorphic [ Classes ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_classes.html#robo_top_of_doc">Classes</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_data_non_polymorphic</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    The data in a <a href="#robo36">json_value</a> class
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">137 </span>        type <span class="sign">:</span><span class="sign">:</span> <strong>json_data_non_polymorphic</strong>
<span class="line_number">138 </span>
<span class="line_number">139 </span>            integer <span class="sign">:</span><span class="sign">:</span> var_type <span class="sign">=</span> json_unknown
<span class="line_number">140 </span>
<span class="line_number">141 </span>            logical<span class="sign">,</span>allocatable             <span class="sign">:</span><span class="sign">:</span> log_value
<span class="line_number">142 </span>            integer<span class="sign">,</span>allocatable             <span class="sign">:</span><span class="sign">:</span> int_value
<span class="line_number">143 </span>            real<span class="sign">(</span>wp<span class="sign">)</span><span class="sign">,</span>allocatable            <span class="sign">:</span><span class="sign">:</span> dbl_value
<span class="line_number">144 </span>            character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable    <span class="sign">:</span><span class="sign">:</span> str_value
<span class="line_number">145 </span>
<span class="line_number">146 </span>        contains
<span class="line_number">147 </span>
<span class="line_number">148 </span>            procedure <span class="sign">:</span><span class="sign">:</span> destroy <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo2">destroy_json_data_non_polymorphic</a>
<span class="line_number">149 </span>
<span class="line_number">150 </span>        end type <strong>json_data_non_polymorphic</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5ffailed"></a>
<a name="robo21"></a><h2>json_module/json_failed [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_failed</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Logical function to indicate if an exception has been thrown.
</pre>
<p class="item_name">USAGE</p>
<pre>    if (<strong>json_failed</strong>()) then
        !do something about it
        call <a href="#robo19">json_clear_exceptions</a>()
    end if
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/5/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">981 </span>    function <strong>json_failed</strong><span class="sign">(</span><span class="sign">)</span> result<span class="sign">(</span>failed<span class="sign">)</span>
<span class="line_number">982 </span>
<span class="line_number">983 </span>    implicit none
<span class="line_number">984 </span>
<span class="line_number">985 </span>    logical <span class="sign">:</span><span class="sign">:</span> failed
<span class="line_number">986 </span>
<span class="line_number">987 </span>    failed <span class="sign">=</span> exception_thrown
<span class="line_number">988 </span>
<span class="line_number">989 </span>    end function <strong>json_failed</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5ffile"></a>
<a name="robo22"></a><h2>json_module/json_file [ Classes ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_classes.html#robo_top_of_doc">Classes</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_file</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>  The <strong>json_file</strong> is the main public class that is
    used to open a file and get data from it.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    type(<strong>json_file</strong>) :: json
    call json%load_file(filename)
    call json%print_file()
    call json%get('var.i',ival,found)
    call json%get('var.d',rval,found)
    call json%get('var.c',cval,found)
    call json%destroy()
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/9/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">206 </span>        private
<span class="line_number">207 </span>
<span class="line_number">208 </span>        type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> p    <span class="sign">=</span><span class="sign">&gt;</span> null<span class="sign">(</span><span class="sign">)</span>    <span class="sign">!</span>the JSON structure read from the file<span class="sign">:</span>
<span class="line_number">209 </span>
<span class="line_number">210 </span>        contains
<span class="line_number">211 </span>
<span class="line_number">212 </span>        procedure<span class="sign">,</span>public <span class="sign">:</span><span class="sign">:</span> load_file   <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo51">load_json_file</a>
<span class="line_number">213 </span>        procedure<span class="sign">,</span>public <span class="sign">:</span><span class="sign">:</span> print_file  <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo59">print_json_file</a>
<span class="line_number">214 </span>        procedure<span class="sign">,</span>public <span class="sign">:</span><span class="sign">:</span> destroy     <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo3">destroy_json_file</a>
<span class="line_number">215 </span>
<span class="line_number">216 </span>        procedure<span class="sign">,</span>public <span class="sign">:</span><span class="sign">:</span> info        <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo73">variable_info_in_file</a>
<span class="line_number">217 </span>
<span class="line_number">218 </span>        generic<span class="sign">,</span>public <span class="sign">:</span><span class="sign">:</span> get <span class="sign">=</span><span class="sign">&gt;</span> get_pointer<span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">219 </span>                                 get_integer<span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">220 </span>                                 get_double<span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">221 </span>                                 get_logical<span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">222 </span>                                 get_chars<span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">223 </span>                                 get_double_vec<span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">224 </span>                                 get_char_vec<span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">225 </span>                                 get_integer_vec<span class="sign">,</span><span class="sign">&amp;</span>
<span class="line_number">226 </span>                                 get_logical_vec
<span class="line_number">227 </span>
<span class="line_number">228 </span>        <span class="sign">!</span>scalars<span class="sign">:</span>
<span class="line_number">229 </span>        procedure <span class="sign">:</span><span class="sign">:</span> get_pointer        <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo16">get_object_from_json_file</a>
<span class="line_number">230 </span>        procedure <span class="sign">:</span><span class="sign">:</span> get_integer        <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo12">get_integer_from_json_file</a>
<span class="line_number">231 </span>        procedure <span class="sign">:</span><span class="sign">:</span> get_double         <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo10">get_double_from_json_file</a>
<span class="line_number">232 </span>        procedure <span class="sign">:</span><span class="sign">:</span> get_logical        <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo14">get_logical_from_json_file</a>
<span class="line_number">233 </span>        procedure <span class="sign">:</span><span class="sign">:</span> get_chars          <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo8">get_chars_from_json_file</a>
<span class="line_number">234 </span>
<span class="line_number">235 </span>        <span class="sign">!</span>vectors<span class="sign">:</span>
<span class="line_number">236 </span>        procedure <span class="sign">:</span><span class="sign">:</span> get_integer_vec    <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo13">get_integer_vec_from_json_file</a>
<span class="line_number">237 </span>        procedure <span class="sign">:</span><span class="sign">:</span> get_double_vec     <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo11">get_double_vec_from_json_file</a>
<span class="line_number">238 </span>        procedure <span class="sign">:</span><span class="sign">:</span> get_logical_vec    <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo15">get_logical_vec_from_json_file</a>
<span class="line_number">239 </span>        procedure <span class="sign">:</span><span class="sign">:</span> get_char_vec       <span class="sign">=</span><span class="sign">&gt;</span> <a href="#robo7">get_char_vec_from_json_file</a>
</pre>

<hr />
<a name="json5fmodule2fjson5fget5farray"></a>
<a name="robo23"></a><h2>json_module/json_get_array [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_array</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get an array from an <a href="#robo36">json_value</a>.
    This routine calls the user-supplied array_callback subroutine
        for each element in the array.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2851 </span>    subroutine <strong>json_get_array</strong><span class="sign">(</span>this<span class="sign">,</span> path<span class="sign">,</span> array_callback<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">2852 </span>
<span class="line_number">2853 </span>    implicit none
<span class="line_number">2854 </span>
<span class="line_number">2855 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">2856 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">2857 </span>    procedure<span class="sign">(</span>array_callback_func<span class="sign">)</span>       <span class="sign">:</span><span class="sign">:</span> array_callback
<span class="line_number">2858 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional         <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">2859 </span>
<span class="line_number">2860 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> element<span class="sign">,</span>p
<span class="line_number">2861 </span>    integer <span class="sign">:</span><span class="sign">:</span> i<span class="sign">,</span> count
<span class="line_number">2862 </span>
<span class="line_number">2863 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">2864 </span>
<span class="line_number">2865 </span>        nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2866 </span>
<span class="line_number">2867 </span>        <span class="sign">!</span> resolve the path to the value
<span class="line_number">2868 </span>        if <span class="sign">(</span>present<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2869 </span>            call <a href="#robo24">json_get_by_path</a><span class="sign">(</span>this<span class="sign">=</span>this<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> p<span class="sign">=</span>p<span class="sign">)</span>
<span class="line_number">2870 </span>        else
<span class="line_number">2871 </span>            p <span class="sign">=</span><span class="sign">&gt;</span> this
<span class="line_number">2872 </span>        end if
<span class="line_number">2873 </span>
<span class="line_number">2874 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2875 </span>
<span class="line_number">2876 </span>            call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_array</strong>: Unable to resolve path: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2877 </span>
<span class="line_number">2878 </span>        else
<span class="line_number">2879 </span>
<span class="line_number">2880 </span>            <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> p<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">2881 </span>                select case <span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>var_type<span class="sign">)</span>
<span class="line_number">2882 </span>                case <span class="sign">(</span>json_array<span class="sign">)</span>
<span class="line_number">2883 </span>                    count <span class="sign">=</span> <a href="#robo46">json_value_count</a><span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2884 </span>                    do i <span class="sign">=</span> 1<span class="sign">,</span> count
<span class="line_number">2885 </span>                        call json_value_get<span class="sign">(</span>p<span class="sign">,</span> i<span class="sign">,</span> element<span class="sign">)</span>
<span class="line_number">2886 </span>                        call array_callback<span class="sign">(</span>element<span class="sign">,</span> i<span class="sign">,</span> count<span class="sign">)</span>
<span class="line_number">2887 </span>                    end do
<span class="line_number">2888 </span>                case default
<span class="line_number">2889 </span>                    call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_array</strong>: Resolved value is not an array. '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2890 </span>                end select
<span class="line_number">2891 </span>            <span class="sign">!</span>end associate
<span class="line_number">2892 </span>
<span class="line_number">2893 </span>            <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">2894 </span>            if <span class="sign">(</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span>       nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2895 </span>            if <span class="sign">(</span>associated<span class="sign">(</span>element<span class="sign">)</span><span class="sign">)</span> nullify<span class="sign">(</span>element<span class="sign">)</span>
<span class="line_number">2896 </span>
<span class="line_number">2897 </span>        end if
<span class="line_number">2898 </span>
<span class="line_number">2899 </span>        if <span class="sign">(</span>exception_thrown<span class="sign">)</span> then
<span class="line_number">2900 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2901 </span>                found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2902 </span>                call <a href="#robo19">json_clear_exceptions</a><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">2903 </span>            end if
<span class="line_number">2904 </span>        else
<span class="line_number">2905 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">2906 </span>        end if
<span class="line_number">2907 </span>
<span class="line_number">2908 </span>    else
<span class="line_number">2909 </span>        if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2910 </span>    end if
<span class="line_number">2911 </span>
<span class="line_number">2912 </span>    end subroutine <strong>json_get_array</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fget5fby5fpath"></a>
<a name="robo24"></a><h2>json_module/json_get_by_path [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_by_path</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>     $         root
     @         this
     .         child object member
     [] or ()  child array element
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1956 </span>    recursive subroutine <strong>json_get_by_path</strong><span class="sign">(</span>this<span class="sign">,</span> path<span class="sign">,</span> p<span class="sign">,</span> found<span class="sign">)</span>       <span class="sign">!</span>JW <span class="sign">:</span> Does this need to be recursive <span class="sign">?</span><span class="sign">?</span><span class="sign">?</span>
<span class="line_number">1957 </span>
<span class="line_number">1958 </span>    implicit none
<span class="line_number">1959 </span>
<span class="line_number">1960 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>     <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">1961 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>             <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">1962 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">1963 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional            <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">1964 </span>
<span class="line_number">1965 </span>    integer <span class="sign">:</span><span class="sign">:</span> i<span class="sign">,</span> length<span class="sign">,</span> child_i
<span class="line_number">1966 </span>    character<span class="sign">(</span>len<span class="sign">=</span>1<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> c
<span class="line_number">1967 </span>    logical <span class="sign">:</span><span class="sign">:</span> array
<span class="line_number">1968 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> tmp
<span class="line_number">1969 </span>
<span class="line_number">1970 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">1971 </span>
<span class="line_number">1972 </span>        nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">1973 </span>
<span class="line_number">1974 </span>        <span class="sign">!</span> default to assuming relative to this
<span class="line_number">1975 </span>        p <span class="sign">=</span><span class="sign">&gt;</span> this
<span class="line_number">1976 </span>
<span class="line_number">1977 </span>        child_i <span class="sign">=</span> 1
<span class="line_number">1978 </span>
<span class="line_number">1979 </span>        array <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">1980 </span>
<span class="line_number">1981 </span>        length <span class="sign">=</span> len_trim<span class="sign">(</span>path<span class="sign">)</span>
<span class="line_number">1982 </span>
<span class="line_number">1983 </span>        do i<span class="sign">=</span>1<span class="sign">,</span> length
<span class="line_number">1984 </span>
<span class="line_number">1985 </span>            c <span class="sign">=</span> path<span class="sign">(</span>i<span class="sign">:</span>i<span class="sign">)</span>
<span class="line_number">1986 </span>
<span class="line_number">1987 </span>            select case <span class="sign">(</span>c<span class="sign">)</span>
<span class="line_number">1988 </span>            case <span class="sign">(</span><span class="squote">'$'</span><span class="sign">)</span>
<span class="line_number">1989 </span>
<span class="line_number">1990 </span>                <span class="sign">!</span> root
<span class="line_number">1991 </span>                do while <span class="sign">(</span>associated <span class="sign">(</span>p <span class="sign">%</span> parent<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">1992 </span>                    p <span class="sign">=</span><span class="sign">&gt;</span> p <span class="sign">%</span> parent
<span class="line_number">1993 </span>                end do
<span class="line_number">1994 </span>                child_i <span class="sign">=</span> i <span class="sign">+</span> 1
<span class="line_number">1995 </span>
<span class="line_number">1996 </span>            case <span class="sign">(</span><span class="squote">'@'</span><span class="sign">)</span>
<span class="line_number">1997 </span>
<span class="line_number">1998 </span>                <span class="sign">!</span> this
<span class="line_number">1999 </span>                p <span class="sign">=</span><span class="sign">&gt;</span> this
<span class="line_number">2000 </span>                child_i <span class="sign">=</span> i <span class="sign">+</span> 1
<span class="line_number">2001 </span>
<span class="line_number">2002 </span>            case <span class="sign">(</span><span class="squote">'.'</span><span class="sign">)</span>
<span class="line_number">2003 </span>
<span class="line_number">2004 </span>                <span class="sign">!</span> get child member from p
<span class="line_number">2005 </span>                if <span class="sign">(</span>child_i <span class="sign">&lt;</span> i<span class="sign">)</span> then
<span class="line_number">2006 </span>                    nullify<span class="sign">(</span>tmp<span class="sign">)</span>
<span class="line_number">2007 </span>                    call json_value_get<span class="sign">(</span>p<span class="sign">,</span> path<span class="sign">(</span>child_i<span class="sign">:</span>i<span class="sign">-</span>1<span class="sign">)</span><span class="sign">,</span> tmp<span class="sign">)</span>
<span class="line_number">2008 </span>                    p <span class="sign">=</span><span class="sign">&gt;</span> tmp
<span class="line_number">2009 </span>                    nullify<span class="sign">(</span>tmp<span class="sign">)</span>
<span class="line_number">2010 </span>                else
<span class="line_number">2011 </span>                    child_i <span class="sign">=</span> i <span class="sign">+</span> 1
<span class="line_number">2012 </span>                    cycle
<span class="line_number">2013 </span>                end if
<span class="line_number">2014 </span>
<span class="line_number">2015 </span>                if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2016 </span>                    call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_by_path</strong>: Error getting child member.'</span><span class="sign">)</span>
<span class="line_number">2017 </span>                    exit
<span class="line_number">2018 </span>                end if
<span class="line_number">2019 </span>
<span class="line_number">2020 </span>                child_i <span class="sign">=</span> i<span class="sign">+</span>1
<span class="line_number">2021 </span>
<span class="line_number">2022 </span>            case <span class="sign">(</span><span class="squote">'['</span><span class="sign">,</span><span class="squote">'('</span><span class="sign">)</span>
<span class="line_number">2023 </span>
<span class="line_number">2024 </span>                <span class="sign">!</span><span class="sign">.</span><span class="sign">.</span><span class="sign">.</span><span class="sign">.</span>Modified to allow for <span class="squote">'var[3]'</span> style syntax
<span class="line_number">2025 </span>                <span class="sign">!</span>Note<span class="sign">:</span> jmozmoz<span class="sign">/</span>fson has a slightly different version of this<span class="sign">.</span><span class="sign">.</span><span class="sign">.</span>
<span class="line_number">2026 </span>
<span class="line_number">2027 </span>                <span class="sign">!</span> start looking for the array element index
<span class="line_number">2028 </span>                array <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">2029 </span>
<span class="line_number">2030 </span>                <span class="sign">!</span> get child member from p
<span class="line_number">2031 </span>                if <span class="sign">(</span>child_i <span class="sign">&lt;</span> i<span class="sign">)</span> then
<span class="line_number">2032 </span>                    nullify<span class="sign">(</span>tmp<span class="sign">)</span>
<span class="line_number">2033 </span>                    call json_value_get<span class="sign">(</span>p<span class="sign">,</span> path<span class="sign">(</span>child_i<span class="sign">:</span>i<span class="sign">-</span>1<span class="sign">)</span><span class="sign">,</span> tmp<span class="sign">)</span>
<span class="line_number">2034 </span>                    p <span class="sign">=</span><span class="sign">&gt;</span> tmp
<span class="line_number">2035 </span>                    nullify<span class="sign">(</span>tmp<span class="sign">)</span>
<span class="line_number">2036 </span>                else
<span class="line_number">2037 </span>                    child_i <span class="sign">=</span> i <span class="sign">+</span> 1
<span class="line_number">2038 </span>                    cycle
<span class="line_number">2039 </span>                end if
<span class="line_number">2040 </span>                if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2041 </span>                    call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_by_path</strong>: Error getting array element'</span><span class="sign">)</span>
<span class="line_number">2042 </span>                    exit
<span class="line_number">2043 </span>                end if
<span class="line_number">2044 </span>                child_i <span class="sign">=</span> i <span class="sign">+</span> 1
<span class="line_number">2045 </span>
<span class="line_number">2046 </span>            case <span class="sign">(</span><span class="squote">']'</span><span class="sign">,</span><span class="squote">')'</span><span class="sign">)</span>
<span class="line_number">2047 </span>
<span class="line_number">2048 </span>                if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span>array<span class="sign">)</span> then
<span class="line_number">2049 </span>                    call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_by_path</strong>: Unexpected ]'</span><span class="sign">)</span>
<span class="line_number">2050 </span>                    exit
<span class="line_number">2051 </span>                end if
<span class="line_number">2052 </span>                array <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2053 </span>                child_i <span class="sign">=</span> <a href="#robo63">string_to_integer</a><span class="sign">(</span>path<span class="sign">(</span>child_i<span class="sign">:</span>i<span class="sign">-</span>1<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2054 </span>
<span class="line_number">2055 </span>                nullify<span class="sign">(</span>tmp<span class="sign">)</span>
<span class="line_number">2056 </span>                call json_value_get<span class="sign">(</span>p<span class="sign">,</span> child_i<span class="sign">,</span> tmp<span class="sign">)</span>
<span class="line_number">2057 </span>                p <span class="sign">=</span><span class="sign">&gt;</span> tmp
<span class="line_number">2058 </span>                nullify<span class="sign">(</span>tmp<span class="sign">)</span>
<span class="line_number">2059 </span>
<span class="line_number">2060 </span>                child_i<span class="sign">=</span> i <span class="sign">+</span> 1
<span class="line_number">2061 </span>
<span class="line_number">2062 </span>            end select
<span class="line_number">2063 </span>
<span class="line_number">2064 </span>        end do
<span class="line_number">2065 </span>
<span class="line_number">2066 </span>        if <span class="sign">(</span>exception_thrown<span class="sign">)</span> then
<span class="line_number">2067 </span>
<span class="line_number">2068 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2069 </span>                found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2070 </span>                call <a href="#robo19">json_clear_exceptions</a><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">2071 </span>            end if
<span class="line_number">2072 </span>
<span class="line_number">2073 </span>        else
<span class="line_number">2074 </span>
<span class="line_number">2075 </span>            <span class="sign">!</span> grab the last child if present in the path
<span class="line_number">2076 </span>            if <span class="sign">(</span>child_i <span class="sign">&lt;</span><span class="sign">=</span> length<span class="sign">)</span> then
<span class="line_number">2077 </span>                nullify<span class="sign">(</span>tmp<span class="sign">)</span>
<span class="line_number">2078 </span>                call json_value_get<span class="sign">(</span>p<span class="sign">,</span> path<span class="sign">(</span>child_i<span class="sign">:</span>i<span class="sign">-</span>1<span class="sign">)</span><span class="sign">,</span> tmp<span class="sign">)</span>
<span class="line_number">2079 </span>                p <span class="sign">=</span><span class="sign">&gt;</span> tmp
<span class="line_number">2080 </span>                nullify<span class="sign">(</span>tmp<span class="sign">)</span>
<span class="line_number">2081 </span>            end if
<span class="line_number">2082 </span>            if <span class="sign">(</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2083 </span>                if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>    <span class="sign">!</span>everything seems to be ok
<span class="line_number">2084 </span>            else
<span class="line_number">2085 </span>                call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_by_path</strong>: variable not found: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2086 </span>                if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2087 </span>                    found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2088 </span>                    call <a href="#robo19">json_clear_exceptions</a><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">2089 </span>                end if
<span class="line_number">2090 </span>            end if
<span class="line_number">2091 </span>            
<span class="line_number">2092 </span>        end if
<span class="line_number">2093 </span>
<span class="line_number">2094 </span>    else
<span class="line_number">2095 </span>        if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2096 </span>    end if
<span class="line_number">2097 </span>
<span class="line_number">2098 </span>    end subroutine <strong>json_get_by_path</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fget5fchar5fvec"></a>
<a name="robo25"></a><h2>json_module/json_get_char_vec [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_char_vec</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a char vector from a JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 5/14/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2787 </span>    subroutine <strong>json_get_char_vec</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">2788 </span>
<span class="line_number">2789 </span>    implicit none
<span class="line_number">2790 </span>
<span class="line_number">2791 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                    <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">2792 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                            <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">2793 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> vec
<span class="line_number">2794 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                           <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">2795 </span>
<span class="line_number">2796 </span>    logical <span class="sign">:</span><span class="sign">:</span> initialized
<span class="line_number">2797 </span>
<span class="line_number">2798 </span>    initialized <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2799 </span>
<span class="line_number">2800 </span>    if <span class="sign">(</span>allocated<span class="sign">(</span>vec<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>vec<span class="sign">)</span>
<span class="line_number">2801 </span>
<span class="line_number">2802 </span>    <span class="sign">!</span>the callback function is called for each element of the array<span class="sign">:</span>
<span class="line_number">2803 </span>    call json_get<span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> array_callback<span class="sign">=</span>get_chars_from_array<span class="sign">,</span> found<span class="sign">=</span>found<span class="sign">)</span>
<span class="line_number">2804 </span>
<span class="line_number">2805 </span>    contains
<span class="line_number">2806 </span>
<span class="line_number">2807 </span>        <span class="sign">!</span> callback function for chars
<span class="line_number">2808 </span>        subroutine get_chars_from_array<span class="sign">(</span>element<span class="sign">,</span> i<span class="sign">,</span> count<span class="sign">)</span>
<span class="line_number">2809 </span>        
<span class="line_number">2810 </span>        implicit none
<span class="line_number">2811 </span>
<span class="line_number">2812 </span>        type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> element
<span class="line_number">2813 </span>        integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                   <span class="sign">:</span><span class="sign">:</span> i        <span class="sign">!</span>index
<span class="line_number">2814 </span>        integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                   <span class="sign">:</span><span class="sign">:</span> count    <span class="sign">!</span>size of array
<span class="line_number">2815 </span>
<span class="line_number">2816 </span>        character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable <span class="sign">:</span><span class="sign">:</span> cval
<span class="line_number">2817 </span>
<span class="line_number">2818 </span>        <span class="sign">!</span>size the output array<span class="sign">:</span>
<span class="line_number">2819 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> initialized<span class="sign">)</span> then
<span class="line_number">2820 </span>            allocate<span class="sign">(</span>vec<span class="sign">(</span>count<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2821 </span>            initialized <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">2822 </span>        end if
<span class="line_number">2823 </span>
<span class="line_number">2824 </span>        <span class="sign">!</span>populate the elements<span class="sign">:</span>
<span class="line_number">2825 </span>        call json_get<span class="sign">(</span>element<span class="sign">,</span> value<span class="sign">=</span>cval<span class="sign">)</span>
<span class="line_number">2826 </span>        if <span class="sign">(</span>allocated<span class="sign">(</span>cval<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2827 </span>            vec<span class="sign">(</span>i<span class="sign">)</span> <span class="sign">=</span> cval
<span class="line_number">2828 </span>            deallocate<span class="sign">(</span>cval<span class="sign">)</span>
<span class="line_number">2829 </span>        else
<span class="line_number">2830 </span>            vec<span class="sign">(</span>i<span class="sign">)</span> <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">2831 </span>        end if
<span class="line_number">2832 </span>
<span class="line_number">2833 </span>        end subroutine get_chars_from_array
<span class="line_number">2834 </span>
<span class="line_number">2835 </span>    end subroutine <strong>json_get_char_vec</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fget5fchars"></a>
<a name="robo26"></a><h2>json_module/json_get_chars [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_chars</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a character string from a <a href="#robo36">json_value</a>.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2585 </span>    subroutine <strong>json_get_chars</strong><span class="sign">(</span>this<span class="sign">,</span> path<span class="sign">,</span> value<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">2586 </span>
<span class="line_number">2587 </span>    implicit none
<span class="line_number">2588 </span>
<span class="line_number">2589 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>         <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">2590 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional        <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">2591 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> value
<span class="line_number">2592 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">2593 </span>
<span class="line_number">2594 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">2595 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable <span class="sign">:</span><span class="sign">:</span> s<span class="sign">,</span>pre<span class="sign">,</span>post
<span class="line_number">2596 </span>    integer <span class="sign">:</span><span class="sign">:</span> j<span class="sign">,</span>jprev<span class="sign">,</span>n
<span class="line_number">2597 </span>    character<span class="sign">(</span>len<span class="sign">=</span>1<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> c
<span class="line_number">2598 </span>
<span class="line_number">2599 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">2600 </span>
<span class="line_number">2601 </span>        nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2602 </span>
<span class="line_number">2603 </span>        if <span class="sign">(</span>present<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2604 </span>            call <a href="#robo24">json_get_by_path</a><span class="sign">(</span>this<span class="sign">=</span>this<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> p<span class="sign">=</span>p<span class="sign">)</span>
<span class="line_number">2605 </span>        else
<span class="line_number">2606 </span>            p <span class="sign">=</span><span class="sign">&gt;</span> this
<span class="line_number">2607 </span>        end if
<span class="line_number">2608 </span>
<span class="line_number">2609 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2610 </span>
<span class="line_number">2611 </span>            call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_chars</strong>: Unable to resolve path: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2612 </span>
<span class="line_number">2613 </span>        else
<span class="line_number">2614 </span>
<span class="line_number">2615 </span>            <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> p<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">2616 </span>                select case <span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>var_type<span class="sign">)</span>
<span class="line_number">2617 </span>                case <span class="sign">(</span>json_string<span class="sign">)</span>
<span class="line_number">2618 </span>                    if <span class="sign">(</span>allocated<span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>str_value<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2619 </span>
<span class="line_number">2620 </span>                        <span class="sign">!</span>get the value as is<span class="sign">:</span>
<span class="line_number">2621 </span>                        s <span class="sign">=</span> p<span class="sign">%</span>data<span class="sign">%</span>str_value
<span class="line_number">2622 </span>
<span class="line_number">2623 </span>                        <span class="sign">!</span> Now<span class="sign">,</span> have to remove the escape characters<span class="sign">:</span>
<span class="line_number">2624 </span>                        <span class="sign">!</span>
<span class="line_number">2625 </span>                        <span class="sign">!</span> <span class="squote">'\"'</span>        quotation mark
<span class="line_number">2626 </span>                        <span class="sign">!</span> <span class="squote">'\\'</span>        reverse solidus
<span class="line_number">2627 </span>                        <span class="sign">!</span> <span class="squote">'\/'</span>        solidus
<span class="line_number">2628 </span>                        <span class="sign">!</span> <span class="squote">'\b'</span>        backspace
<span class="line_number">2629 </span>                        <span class="sign">!</span> <span class="squote">'\f'</span>        formfeed
<span class="line_number">2630 </span>                        <span class="sign">!</span> <span class="squote">'\n'</span>        newline <span class="sign">(</span>LF<span class="sign">)</span>
<span class="line_number">2631 </span>                        <span class="sign">!</span> <span class="squote">'\r'</span>        carriage return <span class="sign">(</span>CR<span class="sign">)</span>
<span class="line_number">2632 </span>                        <span class="sign">!</span> <span class="squote">'\t'</span>        horizontal tab
<span class="line_number">2633 </span>                        <span class="sign">!</span> <span class="squote">'\uXXXX'</span>    4 hexadecimal digits
<span class="line_number">2634 </span>                        <span class="sign">!</span>
<span class="line_number">2635 </span>
<span class="line_number">2636 </span>                        <span class="sign">!</span>initialize<span class="sign">:</span>
<span class="line_number">2637 </span>                        n <span class="sign">=</span> len<span class="sign">(</span>s<span class="sign">)</span>
<span class="line_number">2638 </span>                        j <span class="sign">=</span> 1
<span class="line_number">2639 </span>
<span class="line_number">2640 </span>                        do
<span class="line_number">2641 </span>
<span class="line_number">2642 </span>                            jprev <span class="sign">=</span> j                <span class="sign">!</span>initialize
<span class="line_number">2643 </span>                            j <span class="sign">=</span> index<span class="sign">(</span>s<span class="sign">(</span>j<span class="sign">:</span>n<span class="sign">)</span><span class="sign">,</span>backslash<span class="sign">)</span>    <span class="sign">!</span>look for an escape character
<span class="line_number">2644 </span>
<span class="line_number">2645 </span>                            if <span class="sign">(</span>j<span class="sign">&gt;</span>0<span class="sign">)</span> then            <span class="sign">!</span>an escape character was found
<span class="line_number">2646 </span>
<span class="line_number">2647 </span>                                j <span class="sign">=</span> j <span class="sign">+</span> <span class="sign">(</span>jprev<span class="sign">-</span>1<span class="sign">)</span>    <span class="sign">!</span>index in full string of the escape character
<span class="line_number">2648 </span>
<span class="line_number">2649 </span>                                if <span class="sign">(</span>j<span class="sign">&lt;</span>n<span class="sign">)</span> then
<span class="line_number">2650 </span>
<span class="line_number">2651 </span>                                    <span class="sign">!</span>save the bit before the escape character<span class="sign">:</span>
<span class="line_number">2652 </span>                                    if <span class="sign">(</span>j<span class="sign">&gt;</span>1<span class="sign">)</span> then
<span class="line_number">2653 </span>                                        pre <span class="sign">=</span> s<span class="sign">(</span> 1 <span class="sign">:</span> j<span class="sign">-</span>1 <span class="sign">)</span>
<span class="line_number">2654 </span>                                    else
<span class="line_number">2655 </span>                                        pre <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">2656 </span>                                    end if
<span class="line_number">2657 </span>
<span class="line_number">2658 </span>                                    <span class="sign">!</span>character after the escape character<span class="sign">:</span>
<span class="line_number">2659 </span>                                    c <span class="sign">=</span> s<span class="sign">(</span> j<span class="sign">+</span>1 <span class="sign">:</span> j<span class="sign">+</span>1 <span class="sign">)</span>
<span class="line_number">2660 </span>
<span class="line_number">2661 </span>                                    select case <span class="sign">(</span>c<span class="sign">)</span>
<span class="line_number">2662 </span>                                    case<span class="sign">(</span>quotation_mark<span class="sign">,</span>backslash<span class="sign">,</span>slash<span class="sign">,</span><span class="squote">'b'</span><span class="sign">,</span><span class="squote">'f'</span><span class="sign">,</span><span class="squote">'n'</span><span class="sign">,</span><span class="squote">'r'</span><span class="sign">,</span><span class="squote">'t'</span><span class="sign">)</span>
<span class="line_number">2663 </span>
<span class="line_number">2664 </span>                                        <span class="sign">!</span>save the bit after the escape characters<span class="sign">:</span>
<span class="line_number">2665 </span>                                        if <span class="sign">(</span>j<span class="sign">+</span>2<span class="sign">&lt;</span>n<span class="sign">)</span> then
<span class="line_number">2666 </span>                                            post <span class="sign">=</span> s<span class="sign">(</span>j<span class="sign">+</span>2<span class="sign">:</span>n<span class="sign">)</span>
<span class="line_number">2667 </span>                                        else
<span class="line_number">2668 </span>                                            post <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">2669 </span>                                        end if
<span class="line_number">2670 </span>
<span class="line_number">2671 </span>                                        select case<span class="sign">(</span>c<span class="sign">)</span>
<span class="line_number">2672 </span>                                        case<span class="sign">(</span>quotation_mark<span class="sign">,</span>backslash<span class="sign">,</span>slash<span class="sign">)</span>
<span class="line_number">2673 </span>                                            <span class="sign">!</span>use c as is
<span class="line_number">2674 </span>                                        case<span class="sign">(</span><span class="squote">'b'</span><span class="sign">)</span>
<span class="line_number">2675 </span>                                            c <span class="sign">=</span> bspace
<span class="line_number">2676 </span>                                        case<span class="sign">(</span><span class="squote">'f'</span><span class="sign">)</span>
<span class="line_number">2677 </span>                                            c <span class="sign">=</span> formfeed
<span class="line_number">2678 </span>                                        case<span class="sign">(</span><span class="squote">'n'</span><span class="sign">)</span>
<span class="line_number">2679 </span>                                            c <span class="sign">=</span> newline
<span class="line_number">2680 </span>                                        case<span class="sign">(</span><span class="squote">'r'</span><span class="sign">)</span>
<span class="line_number">2681 </span>                                            c <span class="sign">=</span> carriage_return
<span class="line_number">2682 </span>                                        case<span class="sign">(</span><span class="squote">'t'</span><span class="sign">)</span>
<span class="line_number">2683 </span>                                            c <span class="sign">=</span> horizontal_tab
<span class="line_number">2684 </span>                                        end select
<span class="line_number">2685 </span>
<span class="line_number">2686 </span>                                        s <span class="sign">=</span> pre<span class="sign">/</span><span class="sign">/</span>c<span class="sign">/</span><span class="sign">/</span>post
<span class="line_number">2687 </span>
<span class="line_number">2688 </span>                                        n <span class="sign">=</span> n<span class="sign">-</span>1    <span class="sign">!</span>backslash character has been removed from the string
<span class="line_number">2689 </span>
<span class="line_number">2690 </span>                                    case<span class="sign">(</span><span class="squote">'u'</span><span class="sign">)</span>    <span class="sign">!</span>expecting 4 hexadecimal digits after the escape character    <span class="sign">[</span><span class="sign">\</span>uXXXX<span class="sign">]</span>
<span class="line_number">2691 </span>
<span class="line_number">2692 </span>                                        <span class="sign">!</span>for now<span class="sign">,</span> we are just printing them as is
<span class="line_number">2693 </span>                                        <span class="sign">!</span><span class="sign">[</span>Note<span class="sign">:</span> not checking to see if it is a valid hex value<span class="sign">]</span>
<span class="line_number">2694 </span>
<span class="line_number">2695 </span>                                        if <span class="sign">(</span>j<span class="sign">+</span>5<span class="sign">&lt;</span><span class="sign">=</span>n<span class="sign">)</span> then
<span class="line_number">2696 </span>                                            j<span class="sign">=</span>j<span class="sign">+</span>4
<span class="line_number">2697 </span>                                        else
<span class="line_number">2698 </span>                                            call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="sign">&amp;</span>
<span class="line_number">2699 </span>                                                <span class="squote">'Error in <strong>json_get_chars</strong>: Invalid hexadecimal sequence in string: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>c<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2700 </span>                                            exit
<span class="line_number">2701 </span>                                        end if
<span class="line_number">2702 </span>
<span class="line_number">2703 </span>                                    case default
<span class="line_number">2704 </span>                                        <span class="sign">!</span>unknown escape character
<span class="line_number">2705 </span>                                        call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_chars</strong>: unknown escape sequence in string "'</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">2706 </span>                                                trim<span class="sign">(</span>s<span class="sign">)</span><span class="sign">/</span><span class="sign">/</span><span class="squote">'" ['</span><span class="sign">/</span><span class="sign">/</span>backslash<span class="sign">/</span><span class="sign">/</span>c<span class="sign">/</span><span class="sign">/</span><span class="squote">']'</span><span class="sign">)</span>
<span class="line_number">2707 </span>                                        exit
<span class="line_number">2708 </span>                                    end select
<span class="line_number">2709 </span>
<span class="line_number">2710 </span>                                    j<span class="sign">=</span>j<span class="sign">+</span>1    <span class="sign">!</span>go to the next character
<span class="line_number">2711 </span>
<span class="line_number">2712 </span>                                    if <span class="sign">(</span>j<span class="sign">&gt;</span><span class="sign">=</span>n<span class="sign">)</span> exit    <span class="sign">!</span>finished
<span class="line_number">2713 </span>
<span class="line_number">2714 </span>                                else
<span class="line_number">2715 </span>                                    <span class="sign">!</span>an escape character is the last character in the string
<span class="line_number">2716 </span>                                    <span class="sign">!</span> <span class="sign">[</span>this may not be valid syntax<span class="sign">,</span> but just keep it<span class="sign">]</span>
<span class="line_number">2717 </span>                                    exit
<span class="line_number">2718 </span>                                end if
<span class="line_number">2719 </span>
<span class="line_number">2720 </span>                            else
<span class="line_number">2721 </span>                                exit    <span class="sign">!</span>no more escape characters in the string
<span class="line_number">2722 </span>                            end if
<span class="line_number">2723 </span>
<span class="line_number">2724 </span>                        end do
<span class="line_number">2725 </span>
<span class="line_number">2726 </span>                        if <span class="sign">(</span>exception_thrown<span class="sign">)</span> then
<span class="line_number">2727 </span>                            if <span class="sign">(</span>allocated<span class="sign">(</span>value<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>value<span class="sign">)</span>
<span class="line_number">2728 </span>                        else
<span class="line_number">2729 </span>                            value <span class="sign">=</span> s
<span class="line_number">2730 </span>                        end if
<span class="line_number">2731 </span>
<span class="line_number">2732 </span>                    else
<span class="line_number">2733 </span>                        call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_chars</strong>: p%data%value not allocated'</span><span class="sign">)</span>
<span class="line_number">2734 </span>                    end if
<span class="line_number">2735 </span>
<span class="line_number">2736 </span>                <span class="sign">!</span>class default
<span class="line_number">2737 </span>                case default
<span class="line_number">2738 </span>
<span class="line_number">2739 </span>                    call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_chars</strong>: Unable to resolve value to characters: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2740 </span>
<span class="line_number">2741 </span>                    <span class="sign">!</span> Note<span class="sign">:</span> for the other cases<span class="sign">,</span> we could do val to string conversions<span class="sign">.</span><span class="sign">.</span><span class="sign">.</span> TO DO
<span class="line_number">2742 </span>
<span class="line_number">2743 </span>                end select
<span class="line_number">2744 </span>            <span class="sign">!</span>end associate
<span class="line_number">2745 </span>
<span class="line_number">2746 </span>        end if
<span class="line_number">2747 </span>
<span class="line_number">2748 </span>        if <span class="sign">(</span>allocated<span class="sign">(</span>value<span class="sign">)</span> <span class="sign">.</span>and<span class="sign">.</span> <span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">2749 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">2750 </span>        else
<span class="line_number">2751 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2752 </span>                found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2753 </span>                call <a href="#robo19">json_clear_exceptions</a><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">2754 </span>            end if
<span class="line_number">2755 </span>        end if
<span class="line_number">2756 </span>
<span class="line_number">2757 </span>        <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">2758 </span>        if <span class="sign">(</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span> nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2759 </span>        if <span class="sign">(</span>allocated<span class="sign">(</span>s<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>s<span class="sign">)</span>
<span class="line_number">2760 </span>        if <span class="sign">(</span>allocated<span class="sign">(</span>pre<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>pre<span class="sign">)</span>
<span class="line_number">2761 </span>        if <span class="sign">(</span>allocated<span class="sign">(</span>post<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>post<span class="sign">)</span>
<span class="line_number">2762 </span>
<span class="line_number">2763 </span>    else
<span class="line_number">2764 </span>
<span class="line_number">2765 </span>        value <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">2766 </span>        found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2767 </span>
<span class="line_number">2768 </span>    end if
<span class="line_number">2769 </span>
<span class="line_number">2770 </span>    end subroutine <strong>json_get_chars</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fget5fdouble"></a>
<a name="robo27"></a><h2>json_module/json_get_double [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_double</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a double value from an <a href="#robo36">json_value</a>.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2323 </span>    subroutine <strong>json_get_double</strong><span class="sign">(</span>this<span class="sign">,</span> path<span class="sign">,</span> value<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">2324 </span>
<span class="line_number">2325 </span>    implicit none
<span class="line_number">2326 </span>
<span class="line_number">2327 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer       <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">2328 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span> optional      <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">2329 </span>    real<span class="sign">(</span>wp<span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>            <span class="sign">:</span><span class="sign">:</span> value
<span class="line_number">2330 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional    <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">2331 </span>
<span class="line_number">2332 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">2333 </span>
<span class="line_number">2334 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">2335 </span>
<span class="line_number">2336 </span>        nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2337 </span>
<span class="line_number">2338 </span>        if <span class="sign">(</span>present<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2339 </span>            call <a href="#robo24">json_get_by_path</a><span class="sign">(</span>this<span class="sign">=</span>this<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> p<span class="sign">=</span>p<span class="sign">)</span>
<span class="line_number">2340 </span>        else
<span class="line_number">2341 </span>            p <span class="sign">=</span><span class="sign">&gt;</span> this
<span class="line_number">2342 </span>        end if
<span class="line_number">2343 </span>
<span class="line_number">2344 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2345 </span>
<span class="line_number">2346 </span>            call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_double</strong>: Unable to resolve path: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2347 </span>
<span class="line_number">2348 </span>        else
<span class="line_number">2349 </span>
<span class="line_number">2350 </span>            <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> p<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">2351 </span>                select case <span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>var_type<span class="sign">)</span>
<span class="line_number">2352 </span>                case <span class="sign">(</span>json_integer<span class="sign">)</span>
<span class="line_number">2353 </span>                    value <span class="sign">=</span> p<span class="sign">%</span>data<span class="sign">%</span>int_value
<span class="line_number">2354 </span>                case <span class="sign">(</span>json_real<span class="sign">)</span>
<span class="line_number">2355 </span>                    value <span class="sign">=</span> p<span class="sign">%</span>data<span class="sign">%</span>dbl_value
<span class="line_number">2356 </span>                case <span class="sign">(</span>json_logical<span class="sign">)</span>
<span class="line_number">2357 </span>                    if <span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>log_value<span class="sign">)</span> then
<span class="line_number">2358 </span>                        value <span class="sign">=</span> 1<span class="sign">.</span>0_wp
<span class="line_number">2359 </span>                    else
<span class="line_number">2360 </span>                        value <span class="sign">=</span> 0<span class="sign">.</span>0_wp
<span class="line_number">2361 </span>                    end if
<span class="line_number">2362 </span>                case default
<span class="line_number">2363 </span>                    call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_double</strong>: Unable to resolve value to double: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2364 </span>                end select
<span class="line_number">2365 </span>            <span class="sign">!</span>end associate
<span class="line_number">2366 </span>
<span class="line_number">2367 </span>            nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2368 </span>
<span class="line_number">2369 </span>        end if
<span class="line_number">2370 </span>
<span class="line_number">2371 </span>        if <span class="sign">(</span>exception_thrown<span class="sign">)</span> then
<span class="line_number">2372 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2373 </span>                found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2374 </span>                call <a href="#robo19">json_clear_exceptions</a><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">2375 </span>            end if
<span class="line_number">2376 </span>        else
<span class="line_number">2377 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">2378 </span>        end if
<span class="line_number">2379 </span>
<span class="line_number">2380 </span>    else
<span class="line_number">2381 </span>
<span class="line_number">2382 </span>        value <span class="sign">=</span> 0<span class="sign">.</span>0_wp
<span class="line_number">2383 </span>        if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2384 </span>
<span class="line_number">2385 </span>    end if
<span class="line_number">2386 </span>
<span class="line_number">2387 </span>    end subroutine <strong>json_get_double</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fget5fdouble5fvec"></a>
<a name="robo28"></a><h2>json_module/json_get_double_vec [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_double_vec</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a double vector from a JSON value.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 5/14/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2404 </span>    subroutine <strong>json_get_double_vec</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">2405 </span>
<span class="line_number">2406 </span>    implicit none
<span class="line_number">2407 </span>
<span class="line_number">2408 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer                       <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">2409 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                     <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">2410 </span>    real<span class="sign">(</span>wp<span class="sign">)</span><span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> vec
<span class="line_number">2411 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                    <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">2412 </span>
<span class="line_number">2413 </span>    logical <span class="sign">:</span><span class="sign">:</span> initialized
<span class="line_number">2414 </span>
<span class="line_number">2415 </span>    initialized <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2416 </span>
<span class="line_number">2417 </span>    if <span class="sign">(</span>allocated<span class="sign">(</span>vec<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>vec<span class="sign">)</span>
<span class="line_number">2418 </span>
<span class="line_number">2419 </span>    <span class="sign">!</span>the callback function is called for each element of the array<span class="sign">:</span>
<span class="line_number">2420 </span>    call json_get<span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> array_callback<span class="sign">=</span>get_double_from_array<span class="sign">,</span> found<span class="sign">=</span>found<span class="sign">)</span>
<span class="line_number">2421 </span>
<span class="line_number">2422 </span>    contains
<span class="line_number">2423 </span>
<span class="line_number">2424 </span>        <span class="sign">!</span> callback function for double
<span class="line_number">2425 </span>        subroutine get_double_from_array<span class="sign">(</span>element<span class="sign">,</span> i<span class="sign">,</span> count<span class="sign">)</span>
<span class="line_number">2426 </span>        implicit none
<span class="line_number">2427 </span>
<span class="line_number">2428 </span>        type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>     <span class="sign">:</span><span class="sign">:</span> element
<span class="line_number">2429 </span>        integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                      <span class="sign">:</span><span class="sign">:</span> i        <span class="sign">!</span>index
<span class="line_number">2430 </span>        integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                      <span class="sign">:</span><span class="sign">:</span> count    <span class="sign">!</span>size of array
<span class="line_number">2431 </span>
<span class="line_number">2432 </span>        <span class="sign">!</span>size the output array<span class="sign">:</span>
<span class="line_number">2433 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> initialized<span class="sign">)</span> then
<span class="line_number">2434 </span>            allocate<span class="sign">(</span>vec<span class="sign">(</span>count<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2435 </span>            initialized <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">2436 </span>        end if
<span class="line_number">2437 </span>
<span class="line_number">2438 </span>        <span class="sign">!</span>populate the elements<span class="sign">:</span>
<span class="line_number">2439 </span>        call json_get<span class="sign">(</span>element<span class="sign">,</span> value<span class="sign">=</span>vec<span class="sign">(</span>i<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2440 </span>
<span class="line_number">2441 </span>        end subroutine get_double_from_array
<span class="line_number">2442 </span>
<span class="line_number">2443 </span>    end subroutine <strong>json_get_double_vec</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fget5finteger"></a>
<a name="robo29"></a><h2>json_module/json_get_integer [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_integer</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get an integer value from an <a href="#robo36">json_value</a>.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2189 </span>    subroutine <strong>json_get_integer</strong><span class="sign">(</span>this<span class="sign">,</span> path<span class="sign">,</span> value<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">2190 </span>
<span class="line_number">2191 </span>    implicit none
<span class="line_number">2192 </span>
<span class="line_number">2193 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">2194 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>optional            <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">2195 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>                  <span class="sign">:</span><span class="sign">:</span> value
<span class="line_number">2196 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional         <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">2197 </span>
<span class="line_number">2198 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">2199 </span>
<span class="line_number">2200 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">2201 </span>
<span class="line_number">2202 </span>        nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2203 </span>        if <span class="sign">(</span>present<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2204 </span>            call <a href="#robo24">json_get_by_path</a><span class="sign">(</span>this<span class="sign">=</span>this<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> p<span class="sign">=</span>p<span class="sign">)</span>
<span class="line_number">2205 </span>        else
<span class="line_number">2206 </span>            p <span class="sign">=</span><span class="sign">&gt;</span> this
<span class="line_number">2207 </span>        end if
<span class="line_number">2208 </span>
<span class="line_number">2209 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2210 </span>
<span class="line_number">2211 </span>            call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_integer</strong>: Unable to resolve path: '</span><span class="sign">/</span><span class="sign">/</span> trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2212 </span>
<span class="line_number">2213 </span>        else
<span class="line_number">2214 </span>
<span class="line_number">2215 </span>            <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> p<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">2216 </span>                select case<span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>var_type<span class="sign">)</span>
<span class="line_number">2217 </span>                case <span class="sign">(</span>json_integer<span class="sign">)</span>
<span class="line_number">2218 </span>                    value <span class="sign">=</span> p<span class="sign">%</span>data<span class="sign">%</span>int_value
<span class="line_number">2219 </span>                case <span class="sign">(</span>json_real<span class="sign">)</span>
<span class="line_number">2220 </span>                    value <span class="sign">=</span> int<span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>dbl_value<span class="sign">)</span>
<span class="line_number">2221 </span>                case <span class="sign">(</span>json_logical<span class="sign">)</span>
<span class="line_number">2222 </span>                    if <span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>log_value<span class="sign">)</span> then
<span class="line_number">2223 </span>                        value <span class="sign">=</span> 1
<span class="line_number">2224 </span>                    else
<span class="line_number">2225 </span>                        value <span class="sign">=</span> 0
<span class="line_number">2226 </span>                    end if
<span class="line_number">2227 </span>                case default
<span class="line_number">2228 </span>                    call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in get_integer: Unable to resolve value to integer: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2229 </span>                end select
<span class="line_number">2230 </span>            <span class="sign">!</span>end associate
<span class="line_number">2231 </span>
<span class="line_number">2232 </span>            nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2233 </span>
<span class="line_number">2234 </span>        end if
<span class="line_number">2235 </span>
<span class="line_number">2236 </span>        if <span class="sign">(</span>exception_thrown<span class="sign">)</span> then
<span class="line_number">2237 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2238 </span>                found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2239 </span>                call <a href="#robo19">json_clear_exceptions</a><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">2240 </span>            end if
<span class="line_number">2241 </span>        else
<span class="line_number">2242 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">2243 </span>        end if
<span class="line_number">2244 </span>
<span class="line_number">2245 </span>    else
<span class="line_number">2246 </span>
<span class="line_number">2247 </span>        value <span class="sign">=</span> 0
<span class="line_number">2248 </span>        if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2249 </span>
<span class="line_number">2250 </span>    end if
<span class="line_number">2251 </span>
<span class="line_number">2252 </span>    end subroutine <strong>json_get_integer</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fget5finteger5fvec"></a>
<a name="robo30"></a><h2>json_module/json_get_integer_vec [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_integer_vec</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get an integer vector from a JSON value.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 5/14/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2269 </span>    subroutine <strong>json_get_integer_vec</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">2270 </span>
<span class="line_number">2271 </span>    implicit none
<span class="line_number">2272 </span>
<span class="line_number">2273 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer                       <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">2274 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                     <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">2275 </span>    integer<span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> vec
<span class="line_number">2276 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                    <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">2277 </span>
<span class="line_number">2278 </span>    logical <span class="sign">:</span><span class="sign">:</span> initialized
<span class="line_number">2279 </span>
<span class="line_number">2280 </span>    initialized <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2281 </span>
<span class="line_number">2282 </span>    if <span class="sign">(</span>allocated<span class="sign">(</span>vec<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>vec<span class="sign">)</span>
<span class="line_number">2283 </span>
<span class="line_number">2284 </span>    <span class="sign">!</span>the callback function is called for each element of the array<span class="sign">:</span>
<span class="line_number">2285 </span>    call json_get<span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> array_callback<span class="sign">=</span>get_int_from_array<span class="sign">,</span> found<span class="sign">=</span>found<span class="sign">)</span>
<span class="line_number">2286 </span>
<span class="line_number">2287 </span>    contains
<span class="line_number">2288 </span>
<span class="line_number">2289 </span>        <span class="sign">!</span> callback function for integer
<span class="line_number">2290 </span>        subroutine get_int_from_array<span class="sign">(</span>element<span class="sign">,</span> i<span class="sign">,</span> count<span class="sign">)</span>
<span class="line_number">2291 </span>        implicit none
<span class="line_number">2292 </span>
<span class="line_number">2293 </span>        type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>     <span class="sign">:</span><span class="sign">:</span> element
<span class="line_number">2294 </span>        integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                      <span class="sign">:</span><span class="sign">:</span> i        <span class="sign">!</span>index
<span class="line_number">2295 </span>        integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                      <span class="sign">:</span><span class="sign">:</span> count    <span class="sign">!</span>size of array
<span class="line_number">2296 </span>
<span class="line_number">2297 </span>        <span class="sign">!</span>size the output array<span class="sign">:</span>
<span class="line_number">2298 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> initialized<span class="sign">)</span> then
<span class="line_number">2299 </span>            allocate<span class="sign">(</span>vec<span class="sign">(</span>count<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2300 </span>            initialized <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">2301 </span>        end if
<span class="line_number">2302 </span>
<span class="line_number">2303 </span>        <span class="sign">!</span>populate the elements<span class="sign">:</span>
<span class="line_number">2304 </span>        call json_get<span class="sign">(</span>element<span class="sign">,</span> value<span class="sign">=</span>vec<span class="sign">(</span>i<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2305 </span>
<span class="line_number">2306 </span>        end subroutine get_int_from_array
</pre>

<hr />
<a name="json5fmodule2fjson5fget5flogical"></a>
<a name="robo31"></a><h2>json_module/json_get_logical [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_logical</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a logical value from an <a href="#robo36">json_value</a>.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2457 </span>    subroutine <strong>json_get_logical</strong><span class="sign">(</span>this<span class="sign">,</span> path<span class="sign">,</span> value<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">2458 </span>
<span class="line_number">2459 </span>    implicit none
<span class="line_number">2460 </span>
<span class="line_number">2461 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">2462 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>optional           <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">2463 </span>    logical                             <span class="sign">:</span><span class="sign">:</span> value
<span class="line_number">2464 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional        <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">2465 </span>
<span class="line_number">2466 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">2467 </span>
<span class="line_number">2468 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">2469 </span>
<span class="line_number">2470 </span>        nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2471 </span>
<span class="line_number">2472 </span>        if <span class="sign">(</span>present<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2473 </span>            call <a href="#robo24">json_get_by_path</a><span class="sign">(</span>this<span class="sign">=</span>this<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> p<span class="sign">=</span>p<span class="sign">)</span>
<span class="line_number">2474 </span>        else
<span class="line_number">2475 </span>            p <span class="sign">=</span><span class="sign">&gt;</span> this
<span class="line_number">2476 </span>        end if
<span class="line_number">2477 </span>
<span class="line_number">2478 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2479 </span>
<span class="line_number">2480 </span>            call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_logical</strong>: Unable to resolve path: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2481 </span>
<span class="line_number">2482 </span>        else
<span class="line_number">2483 </span>
<span class="line_number">2484 </span>            <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> p<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">2485 </span>                select case <span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>var_type<span class="sign">)</span>
<span class="line_number">2486 </span>                case <span class="sign">(</span>json_integer<span class="sign">)</span>
<span class="line_number">2487 </span>                    value <span class="sign">=</span> <span class="sign">(</span>p<span class="sign">%</span>data<span class="sign">%</span>int_value <span class="sign">&gt;</span> 0<span class="sign">)</span>
<span class="line_number">2488 </span>                case <span class="sign">(</span>json_logical<span class="sign">)</span>
<span class="line_number">2489 </span>                    value <span class="sign">=</span> p<span class="sign">%</span>data <span class="sign">%</span> log_value
<span class="line_number">2490 </span>                case default
<span class="line_number">2491 </span>                    call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_get_logical</strong>: Unable to resolve value to logical: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>path<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2492 </span>                end select
<span class="line_number">2493 </span>            <span class="sign">!</span>end associate
<span class="line_number">2494 </span>
<span class="line_number">2495 </span>            nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2496 </span>
<span class="line_number">2497 </span>        end if
<span class="line_number">2498 </span>
<span class="line_number">2499 </span>        if <span class="sign">(</span>exception_thrown<span class="sign">)</span> then
<span class="line_number">2500 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2501 </span>                found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2502 </span>                call <a href="#robo19">json_clear_exceptions</a><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">2503 </span>            end if
<span class="line_number">2504 </span>        else
<span class="line_number">2505 </span>            if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">2506 </span>        end if
<span class="line_number">2507 </span>
<span class="line_number">2508 </span>    else
<span class="line_number">2509 </span>
<span class="line_number">2510 </span>        value <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2511 </span>        if <span class="sign">(</span>present<span class="sign">(</span>found<span class="sign">)</span><span class="sign">)</span> found <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2512 </span>
<span class="line_number">2513 </span>    end if
<span class="line_number">2514 </span>
<span class="line_number">2515 </span>    end subroutine <strong>json_get_logical</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fget5flogical5fvec"></a>
<a name="robo32"></a><h2>json_module/json_get_logical_vec [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_get_logical_vec</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get a logical vector from a JSON value.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 5/14/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2532 </span>    subroutine <strong>json_get_logical_vec</strong><span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">,</span> vec<span class="sign">,</span> found<span class="sign">)</span>
<span class="line_number">2533 </span>
<span class="line_number">2534 </span>    implicit none
<span class="line_number">2535 </span>
<span class="line_number">2536 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>            <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">2537 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                    <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">2538 </span>    logical<span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>   <span class="sign">:</span><span class="sign">:</span> vec
<span class="line_number">2539 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional                   <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">2540 </span>
<span class="line_number">2541 </span>    logical <span class="sign">:</span><span class="sign">:</span> initialized
<span class="line_number">2542 </span>
<span class="line_number">2543 </span>    initialized <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">2544 </span>
<span class="line_number">2545 </span>    if <span class="sign">(</span>allocated<span class="sign">(</span>vec<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>vec<span class="sign">)</span>
<span class="line_number">2546 </span>
<span class="line_number">2547 </span>    <span class="sign">!</span>the callback function is called for each element of the array<span class="sign">:</span>
<span class="line_number">2548 </span>    call json_get<span class="sign">(</span>me<span class="sign">,</span> path<span class="sign">=</span>path<span class="sign">,</span> array_callback<span class="sign">=</span>get_logical_from_array<span class="sign">,</span> found<span class="sign">=</span>found<span class="sign">)</span>
<span class="line_number">2549 </span>
<span class="line_number">2550 </span>    contains
<span class="line_number">2551 </span>
<span class="line_number">2552 </span>        <span class="sign">!</span> callback function for logical
<span class="line_number">2553 </span>        subroutine get_logical_from_array<span class="sign">(</span>element<span class="sign">,</span> i<span class="sign">,</span> count<span class="sign">)</span>
<span class="line_number">2554 </span>        implicit none
<span class="line_number">2555 </span>
<span class="line_number">2556 </span>        type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> element
<span class="line_number">2557 </span>        integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                   <span class="sign">:</span><span class="sign">:</span> i        <span class="sign">!</span>index
<span class="line_number">2558 </span>        integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                   <span class="sign">:</span><span class="sign">:</span> count    <span class="sign">!</span>size of array
<span class="line_number">2559 </span>
<span class="line_number">2560 </span>        <span class="sign">!</span>size the output array<span class="sign">:</span>
<span class="line_number">2561 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> initialized<span class="sign">)</span> then
<span class="line_number">2562 </span>            allocate<span class="sign">(</span>vec<span class="sign">(</span>count<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2563 </span>            initialized <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">2564 </span>        end if
<span class="line_number">2565 </span>
<span class="line_number">2566 </span>        <span class="sign">!</span>populate the elements<span class="sign">:</span>
<span class="line_number">2567 </span>        call json_get<span class="sign">(</span>element<span class="sign">,</span> value<span class="sign">=</span>vec<span class="sign">(</span>i<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2568 </span>
<span class="line_number">2569 </span>        end subroutine get_logical_from_array
<span class="line_number">2570 </span>
<span class="line_number">2571 </span>    end subroutine <strong>json_get_logical_vec</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5finfo"></a>
<a name="robo33"></a><h2>json_module/json_info [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_info</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%info(path,found,var_type,n_children)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Returns information about a <a href="#robo36">json_value</a>
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 2/13/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">529 </span>    subroutine <strong>json_info</strong><span class="sign">(</span>p<span class="sign">,</span>var_type<span class="sign">,</span>n_children<span class="sign">)</span>
<span class="line_number">530 </span>
<span class="line_number">531 </span>    implicit none
<span class="line_number">532 </span>
<span class="line_number">533 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer        <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">534 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional    <span class="sign">:</span><span class="sign">:</span> var_type
<span class="line_number">535 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>optional    <span class="sign">:</span><span class="sign">:</span> n_children
<span class="line_number">536 </span>        
<span class="line_number">537 </span>    if <span class="sign">(</span>present<span class="sign">(</span>var_type<span class="sign">)</span><span class="sign">)</span>    var_type <span class="sign">=</span> p<span class="sign">%</span>data<span class="sign">%</span>var_type        <span class="sign">!</span>variable type
<span class="line_number">538 </span>    if <span class="sign">(</span>present<span class="sign">(</span>n_children<span class="sign">)</span><span class="sign">)</span>  n_children <span class="sign">=</span> <a href="#robo46">json_value_count</a><span class="sign">(</span>p<span class="sign">)</span>  <span class="sign">!</span>number of children
<span class="line_number">539 </span>    
<span class="line_number">540 </span>    end subroutine <strong>json_info</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5finitialize"></a>
<a name="robo34"></a><h2>json_module/json_initialize [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_initialize</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Initialize the module.
    Should be called before the routines are used.
    It can also be called after using the module and encountering exceptions.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/4/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">840 </span>    subroutine <strong>json_initialize</strong><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">841 </span>
<span class="line_number">842 </span>    implicit none
<span class="line_number">843 </span>
<span class="line_number">844 </span>    <span class="sign">!</span>clear any errors from previous runs<span class="sign">:</span>
<span class="line_number">845 </span>    call <a href="#robo19">json_clear_exceptions</a><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">846 </span>
<span class="line_number">847 </span>    <span class="sign">!</span>Just in case<span class="sign">,</span> clear these global variables also<span class="sign">:</span>
<span class="line_number">848 </span>    pushed_index <span class="sign">=</span> 0
<span class="line_number">849 </span>    pushed_char <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">850 </span>    char_count <span class="sign">=</span> 0
<span class="line_number">851 </span>    line_count <span class="sign">=</span> 1
<span class="line_number">852 </span>
<span class="line_number">853 </span>    end subroutine <strong>json_initialize</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fparse"></a>
<a name="robo35"></a><h2>json_module/json_parse [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_parse</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Parse the JSON file and populate the <a href="#robo36">json_value</a> tree.
</pre>
<p class="item_name">NOTES</p>
<pre>    When calling this routine, any exceptions thrown from previous
        calls will automatically be cleared.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2930 </span>    subroutine <strong>json_parse</strong><span class="sign">(</span>file<span class="sign">,</span> p<span class="sign">,</span> unit<span class="sign">)</span>
<span class="line_number">2931 </span>
<span class="line_number">2932 </span>    implicit none
<span class="line_number">2933 </span>
<span class="line_number">2934 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> file
<span class="line_number">2935 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer    <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">2936 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional <span class="sign">:</span><span class="sign">:</span> unit
<span class="line_number">2937 </span>
<span class="line_number">2938 </span>    integer <span class="sign">:</span><span class="sign">:</span> iunit<span class="sign">,</span> istat
<span class="line_number">2939 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable <span class="sign">:</span><span class="sign">:</span> line<span class="sign">,</span> arrow_str
<span class="line_number">2940 </span>    character<span class="sign">(</span>len<span class="sign">=</span>10<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> line_str<span class="sign">,</span> char_str
<span class="line_number">2941 </span>    logical <span class="sign">:</span><span class="sign">:</span> is_open
<span class="line_number">2942 </span>
<span class="line_number">2943 </span>    <span class="sign">!</span>clean any exceptions and initialize<span class="sign">:</span>
<span class="line_number">2944 </span>    call <a href="#robo34">json_initialize</a><span class="sign">(</span><span class="sign">)</span>
<span class="line_number">2945 </span>
<span class="line_number">2946 </span>    if <span class="sign">(</span>present<span class="sign">(</span>unit<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">2947 </span>        
<span class="line_number">2948 </span>        iunit <span class="sign">=</span> unit   
<span class="line_number">2949 </span>        
<span class="line_number">2950 </span>        <span class="sign">!</span>check to see if the file is already open
<span class="line_number">2951 </span>        <span class="sign">!</span> if it is<span class="sign">,</span> then use it<span class="sign">,</span> otherwise open the file<span class="sign">.</span>
<span class="line_number">2952 </span>        inquire<span class="sign">(</span>unit<span class="sign">=</span>iunit<span class="sign">,</span> opened<span class="sign">=</span>is_open<span class="sign">,</span> iostat<span class="sign">=</span>istat<span class="sign">)</span>
<span class="line_number">2953 </span>        if <span class="sign">(</span>istat<span class="sign">=</span><span class="sign">=</span>0 <span class="sign">.</span>and<span class="sign">.</span> <span class="sign">.</span>not<span class="sign">.</span> is_open<span class="sign">)</span> then
<span class="line_number">2954 </span>           <span class="sign">!</span> open the file
<span class="line_number">2955 </span>            open <span class="sign">(</span>  unit        <span class="sign">=</span> iunit<span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">2956 </span>                    file        <span class="sign">=</span> file<span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">2957 </span>                    status      <span class="sign">=</span> <span class="squote">'OLD'</span><span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">2958 </span>                    action      <span class="sign">=</span> <span class="squote">'READ'</span><span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">2959 </span>                    form        <span class="sign">=</span> <span class="squote">'FORMATTED'</span><span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">2960 </span>                    position    <span class="sign">=</span> <span class="squote">'REWIND'</span><span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">2961 </span>                    iostat      <span class="sign">=</span> istat<span class="sign">)</span>
<span class="line_number">2962 </span>        end if
<span class="line_number">2963 </span>        
<span class="line_number">2964 </span>    else
<span class="line_number">2965 </span>    
<span class="line_number">2966 </span>        <span class="sign">!</span> open the file with a new unit number<span class="sign">:</span>
<span class="line_number">2967 </span>        open <span class="sign">(</span>  newunit     <span class="sign">=</span> iunit<span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">2968 </span>                file        <span class="sign">=</span> file<span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">2969 </span>                status      <span class="sign">=</span> <span class="squote">'OLD'</span><span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">2970 </span>                action      <span class="sign">=</span> <span class="squote">'READ'</span><span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">2971 </span>                form        <span class="sign">=</span> <span class="squote">'FORMATTED'</span><span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">2972 </span>                position    <span class="sign">=</span> <span class="squote">'REWIND'</span><span class="sign">,</span> <span class="sign">&amp;</span>
<span class="line_number">2973 </span>                iostat      <span class="sign">=</span> istat<span class="sign">)</span>
<span class="line_number">2974 </span>    
<span class="line_number">2975 </span>    end if
<span class="line_number">2976 </span>
<span class="line_number">2977 </span>    if <span class="sign">(</span>istat<span class="sign">=</span><span class="sign">=</span>0<span class="sign">)</span> then
<span class="line_number">2978 </span>
<span class="line_number">2979 </span>        <span class="sign">!</span> create the value and associate the pointer
<span class="line_number">2980 </span>        call <a href="#robo47">json_value_create</a><span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">2981 </span>
<span class="line_number">2982 </span>        <span class="sign">!</span>add the file name as the name of the overall structure<span class="sign">:</span>
<span class="line_number">2983 </span>        p<span class="sign">%</span>name <span class="sign">=</span> trim<span class="sign">(</span>file<span class="sign">)</span>
<span class="line_number">2984 </span>
<span class="line_number">2985 </span>        <span class="sign">!</span> parse as a value
<span class="line_number">2986 </span>        call <a href="#robo57">parse_value</a><span class="sign">(</span>unit <span class="sign">=</span> iunit<span class="sign">,</span> value <span class="sign">=</span> p<span class="sign">)</span>
<span class="line_number">2987 </span>
<span class="line_number">2988 </span>        <span class="sign">!</span>
<span class="line_number">2989 </span>        <span class="sign">!</span>  If there was an error reading the file<span class="sign">,</span> then
<span class="line_number">2990 </span>        <span class="sign">!</span>   can print the line where the error occurred<span class="sign">:</span>
<span class="line_number">2991 </span>        <span class="sign">!</span>
<span class="line_number">2992 </span>        if <span class="sign">(</span>exception_thrown<span class="sign">)</span> then
<span class="line_number">2993 </span>        
<span class="line_number">2994 </span>            call <a href="#robo9">get_current_line_from_file</a><span class="sign">(</span>iunit<span class="sign">,</span>line<span class="sign">)</span>
<span class="line_number">2995 </span>            
<span class="line_number">2996 </span>            <span class="sign">!</span>the counters for the current line and the last character read<span class="sign">:</span>
<span class="line_number">2997 </span>            call <a href="#robo17">integer_to_string</a><span class="sign">(</span>line_count<span class="sign">,</span> line_str<span class="sign">)</span>
<span class="line_number">2998 </span>            call <a href="#robo17">integer_to_string</a><span class="sign">(</span>char_count<span class="sign">,</span> char_str<span class="sign">)</span>
<span class="line_number">2999 </span>            
<span class="line_number">3000 </span>            <span class="sign">!</span>draw the arrow string that points to the current character<span class="sign">:</span>
<span class="line_number">3001 </span>            arrow_str <span class="sign">=</span> repeat<span class="sign">(</span><span class="squote">'-'</span><span class="sign">,</span>max<span class="sign">(</span> 0<span class="sign">,</span> char_count <span class="sign">-</span> 1<span class="sign">)</span> <span class="sign">)</span><span class="sign">/</span><span class="sign">/</span><span class="squote">'^'</span>
<span class="line_number">3002 </span>
<span class="line_number">3003 </span>            <span class="sign">!</span>create the error message<span class="sign">:</span>
<span class="line_number">3004 </span>            err_message <span class="sign">=</span> err_message<span class="sign">/</span><span class="sign">/</span>newline<span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3005 </span>                           <span class="squote">'line: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>adjustl<span class="sign">(</span>line_str<span class="sign">)</span><span class="sign">)</span><span class="sign">/</span><span class="sign">/</span><span class="squote">', '</span><span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3006 </span>                           <span class="squote">'character: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>adjustl<span class="sign">(</span>char_str<span class="sign">)</span><span class="sign">)</span><span class="sign">/</span><span class="sign">/</span>newline<span class="sign">/</span><span class="sign">/</span><span class="sign">&amp;</span>
<span class="line_number">3007 </span>                           trim<span class="sign">(</span>line<span class="sign">)</span><span class="sign">/</span><span class="sign">/</span>newline<span class="sign">/</span><span class="sign">/</span>arrow_str
<span class="line_number">3008 </span>                                        
<span class="line_number">3009 </span>            if <span class="sign">(</span>allocated<span class="sign">(</span>line<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>line<span class="sign">)</span>
<span class="line_number">3010 </span>                        
<span class="line_number">3011 </span>        end if
<span class="line_number">3012 </span>
<span class="line_number">3013 </span>        <span class="sign">!</span> close the file
<span class="line_number">3014 </span>        close <span class="sign">(</span>iunit<span class="sign">,</span> iostat<span class="sign">=</span>istat<span class="sign">)</span>
<span class="line_number">3015 </span>
<span class="line_number">3016 </span>    else
<span class="line_number">3017 </span>
<span class="line_number">3018 </span>        call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_parse</strong>: Error opening file: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>file<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">3019 </span>
<span class="line_number">3020 </span>    end if
<span class="line_number">3021 </span>
<span class="line_number">3022 </span>    end subroutine <strong>json_parse</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue"></a>
<a name="robo36"></a><h2>json_module/json_value [ Classes ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_classes.html#robo_top_of_doc">Classes</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Type used to construct the linked-list json structure
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">164 </span>        type<span class="sign">,</span>public <span class="sign">:</span><span class="sign">:</span> <strong>json_value</strong>
<span class="line_number">165 </span>
<span class="line_number">166 </span>        <span class="sign">!</span>variable name<span class="sign">:</span>
<span class="line_number">167 </span>        character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">168 </span>
<span class="line_number">169 </span>        <span class="sign">!</span>the data for this variable<span class="sign">:</span>
<span class="line_number">170 </span>        type<span class="sign">(</span><a href="#robo20">json_data_non_polymorphic</a><span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> data
<span class="line_number">171 </span>
<span class="line_number">172 </span>        <span class="sign">!</span>for the linked list<span class="sign">:</span>
<span class="line_number">173 </span>        type<span class="sign">(</span><strong>json_value</strong><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> next <span class="sign">=</span><span class="sign">&gt;</span> null<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">174 </span>        type<span class="sign">(</span><strong>json_value</strong><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> parent <span class="sign">=</span><span class="sign">&gt;</span> null<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">175 </span>        type<span class="sign">(</span><strong>json_value</strong><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> children <span class="sign">=</span><span class="sign">&gt;</span> null<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">176 </span>
<span class="line_number">177 </span>        end type <strong>json_value</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fadd5finteger"></a>
<a name="robo37"></a><h2>json_module/json_value_add_integer [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_add_integer</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Add an integer value to the structure.

    These routines are part of the public API that can be
        used to build a json structure using data.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/20/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1221 </span>    subroutine <strong>json_value_add_integer</strong><span class="sign">(</span>me<span class="sign">,</span> name<span class="sign">,</span> val<span class="sign">)</span>
<span class="line_number">1222 </span>
<span class="line_number">1223 </span>    implicit none
<span class="line_number">1224 </span>
<span class="line_number">1225 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer     <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">1226 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>   <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1227 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>            <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1228 </span>
<span class="line_number">1229 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> var
<span class="line_number">1230 </span>
<span class="line_number">1231 </span>    <span class="sign">!</span>create the variable<span class="sign">:</span>
<span class="line_number">1232 </span>    call <a href="#robo47">json_value_create</a><span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1233 </span>    call <a href="#robo66">to_integer</a><span class="sign">(</span>var<span class="sign">,</span>val<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">1234 </span>
<span class="line_number">1235 </span>    <span class="sign">!</span>add it<span class="sign">:</span>
<span class="line_number">1236 </span>    call json_value_add<span class="sign">(</span>me<span class="sign">,</span> var<span class="sign">)</span>
<span class="line_number">1237 </span>
<span class="line_number">1238 </span>    <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">1239 </span>    nullify<span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1240 </span>
<span class="line_number">1241 </span>    end subroutine <strong>json_value_add_integer</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fadd5finteger5fvec"></a>
<a name="robo38"></a><h2>json_module/json_value_add_integer_vec [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_add_integer_vec</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Add an integer vector to the structure.

    These routines are part of the public API that can be
        used to build a json structure using data.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/20/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1261 </span>    subroutine <strong>json_value_add_integer_vec</strong><span class="sign">(</span>me<span class="sign">,</span> name<span class="sign">,</span> val<span class="sign">)</span>
<span class="line_number">1262 </span>
<span class="line_number">1263 </span>    implicit none
<span class="line_number">1264 </span>
<span class="line_number">1265 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer       <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">1266 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>     <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1267 </span>    integer<span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1268 </span>
<span class="line_number">1269 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> var
<span class="line_number">1270 </span>    integer <span class="sign">:</span><span class="sign">:</span> i    <span class="sign">!</span>counter
<span class="line_number">1271 </span>
<span class="line_number">1272 </span>    <span class="sign">!</span>create the variable as an array<span class="sign">:</span>
<span class="line_number">1273 </span>    call <a href="#robo47">json_value_create</a><span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1274 </span>    call <a href="#robo65">to_array</a><span class="sign">(</span>var<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">1275 </span>
<span class="line_number">1276 </span>    <span class="sign">!</span>populate the array<span class="sign">:</span>
<span class="line_number">1277 </span>    do i<span class="sign">=</span>1<span class="sign">,</span>size<span class="sign">(</span>val<span class="sign">)</span>
<span class="line_number">1278 </span>        call json_value_add<span class="sign">(</span>var<span class="sign">,</span> <span class="squote">''</span><span class="sign">,</span> val<span class="sign">(</span>i<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">1279 </span>    end do
<span class="line_number">1280 </span>
<span class="line_number">1281 </span>    <span class="sign">!</span>add it<span class="sign">:</span>
<span class="line_number">1282 </span>    call json_value_add<span class="sign">(</span>me<span class="sign">,</span> var<span class="sign">)</span>
<span class="line_number">1283 </span>
<span class="line_number">1284 </span>    <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">1285 </span>    nullify<span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1286 </span>
<span class="line_number">1287 </span>    end subroutine <strong>json_value_add_integer_vec</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fadd5flogical"></a>
<a name="robo39"></a><h2>json_module/json_value_add_logical [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_add_logical</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Add a logical value to the structure.

    These routines are part of the public API that can be
        used to build a json structure using data.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/20/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1307 </span>    subroutine <strong>json_value_add_logical</strong><span class="sign">(</span>me<span class="sign">,</span> name<span class="sign">,</span> val<span class="sign">)</span>
<span class="line_number">1308 </span>
<span class="line_number">1309 </span>    implicit none
<span class="line_number">1310 </span>
<span class="line_number">1311 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer   <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">1312 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1313 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>          <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1314 </span>
<span class="line_number">1315 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> var
<span class="line_number">1316 </span>
<span class="line_number">1317 </span>    <span class="sign">!</span>create the variable<span class="sign">:</span>
<span class="line_number">1318 </span>    call <a href="#robo47">json_value_create</a><span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1319 </span>    call <a href="#robo67">to_logical</a><span class="sign">(</span>var<span class="sign">,</span>val<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">1320 </span>
<span class="line_number">1321 </span>    <span class="sign">!</span>add it<span class="sign">:</span>
<span class="line_number">1322 </span>    call json_value_add<span class="sign">(</span>me<span class="sign">,</span> var<span class="sign">)</span>
<span class="line_number">1323 </span>
<span class="line_number">1324 </span>    <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">1325 </span>    nullify<span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1326 </span>
<span class="line_number">1327 </span>    end subroutine <strong>json_value_add_logical</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fadd5flogical5fvec"></a>
<a name="robo40"></a><h2>json_module/json_value_add_logical_vec [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_add_logical_vec</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Add a logical vector to the structure.

    These routines are part of the public API that can be
        used to build a json structure using data.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/20/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1347 </span>    subroutine <strong>json_value_add_logical_vec</strong><span class="sign">(</span>me<span class="sign">,</span> name<span class="sign">,</span> val<span class="sign">)</span>
<span class="line_number">1348 </span>
<span class="line_number">1349 </span>    implicit none
<span class="line_number">1350 </span>
<span class="line_number">1351 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer       <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">1352 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>     <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1353 </span>    logical<span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1354 </span>
<span class="line_number">1355 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> var
<span class="line_number">1356 </span>    integer <span class="sign">:</span><span class="sign">:</span> i    <span class="sign">!</span>counter
<span class="line_number">1357 </span>
<span class="line_number">1358 </span>    <span class="sign">!</span>create the variable as an array<span class="sign">:</span>
<span class="line_number">1359 </span>    call <a href="#robo47">json_value_create</a><span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1360 </span>    call <a href="#robo65">to_array</a><span class="sign">(</span>var<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">1361 </span>
<span class="line_number">1362 </span>    <span class="sign">!</span>populate the array<span class="sign">:</span>
<span class="line_number">1363 </span>    do i<span class="sign">=</span>1<span class="sign">,</span>size<span class="sign">(</span>val<span class="sign">)</span>
<span class="line_number">1364 </span>        call json_value_add<span class="sign">(</span>var<span class="sign">,</span> <span class="squote">''</span><span class="sign">,</span> val<span class="sign">(</span>i<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">1365 </span>    end do
<span class="line_number">1366 </span>
<span class="line_number">1367 </span>    <span class="sign">!</span>add it<span class="sign">:</span>
<span class="line_number">1368 </span>    call json_value_add<span class="sign">(</span>me<span class="sign">,</span> var<span class="sign">)</span>
<span class="line_number">1369 </span>
<span class="line_number">1370 </span>    <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">1371 </span>    nullify<span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1372 </span>
<span class="line_number">1373 </span>    end subroutine <strong>json_value_add_logical_vec</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fadd5fmember"></a>
<a name="robo41"></a><h2>json_module/json_value_add_member [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_add_member</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Adds the member to the linked list
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1079 </span>    subroutine <strong>json_value_add_member</strong><span class="sign">(</span>this<span class="sign">,</span> member<span class="sign">)</span>
<span class="line_number">1080 </span>
<span class="line_number">1081 </span>    implicit none
<span class="line_number">1082 </span>
<span class="line_number">1083 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> this<span class="sign">,</span> member
<span class="line_number">1084 </span>
<span class="line_number">1085 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">1086 </span>
<span class="line_number">1087 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">1088 </span>
<span class="line_number">1089 </span>        nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">1090 </span>
<span class="line_number">1091 </span>        <span class="sign">!</span> associate the parent
<span class="line_number">1092 </span>        member <span class="sign">%</span> parent <span class="sign">=</span><span class="sign">&gt;</span> this
<span class="line_number">1093 </span>
<span class="line_number">1094 </span>        <span class="sign">!</span> add to linked list
<span class="line_number">1095 </span>        if <span class="sign">(</span>associated<span class="sign">(</span>this <span class="sign">%</span> children<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1096 </span>
<span class="line_number">1097 </span>            <span class="sign">!</span> get to the tail of the linked list
<span class="line_number">1098 </span>            p <span class="sign">=</span><span class="sign">&gt;</span> this <span class="sign">%</span> children
<span class="line_number">1099 </span>            do while <span class="sign">(</span>associated<span class="sign">(</span>p <span class="sign">%</span> next<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">1100 </span>                p <span class="sign">=</span><span class="sign">&gt;</span> p <span class="sign">%</span> next
<span class="line_number">1101 </span>            end do
<span class="line_number">1102 </span>
<span class="line_number">1103 </span>            p <span class="sign">%</span> next <span class="sign">=</span><span class="sign">&gt;</span> member
<span class="line_number">1104 </span>
<span class="line_number">1105 </span>            nullify<span class="sign">(</span>p<span class="sign">)</span>    <span class="sign">!</span>cleanup
<span class="line_number">1106 </span>
<span class="line_number">1107 </span>        else
<span class="line_number">1108 </span>
<span class="line_number">1109 </span>            this <span class="sign">%</span> children <span class="sign">=</span><span class="sign">&gt;</span> member
<span class="line_number">1110 </span>
<span class="line_number">1111 </span>        end if
<span class="line_number">1112 </span>
<span class="line_number">1113 </span>    end if
<span class="line_number">1114 </span>
<span class="line_number">1115 </span>    end subroutine <strong>json_value_add_member</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fadd5freal"></a>
<a name="robo42"></a><h2>json_module/json_value_add_real [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_add_real</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Add a real value to the structure.

    These routines are part of the public API that can be
        used to build a json structure using data.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/19/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1135 </span>    subroutine <strong>json_value_add_real</strong><span class="sign">(</span>me<span class="sign">,</span> name<span class="sign">,</span> val<span class="sign">)</span>
<span class="line_number">1136 </span>
<span class="line_number">1137 </span>    implicit none
<span class="line_number">1138 </span>
<span class="line_number">1139 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer   <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">1140 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1141 </span>    real<span class="sign">(</span>wp<span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>         <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1142 </span>
<span class="line_number">1143 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> var
<span class="line_number">1144 </span>
<span class="line_number">1145 </span>    <span class="sign">!</span>create the variable<span class="sign">:</span>
<span class="line_number">1146 </span>    call <a href="#robo47">json_value_create</a><span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1147 </span>    call <a href="#robo70">to_real</a><span class="sign">(</span>var<span class="sign">,</span>val<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">1148 </span>
<span class="line_number">1149 </span>    <span class="sign">!</span>add it<span class="sign">:</span>
<span class="line_number">1150 </span>    call json_value_add<span class="sign">(</span>me<span class="sign">,</span> var<span class="sign">)</span>
<span class="line_number">1151 </span>
<span class="line_number">1152 </span>    <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">1153 </span>    nullify<span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1154 </span>
<span class="line_number">1155 </span>    end subroutine <strong>json_value_add_real</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fadd5freal5fvec"></a>
<a name="robo43"></a><h2>json_module/json_value_add_real_vec [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_add_real_vec</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Add a real vector to the structure.

    These routines are part of the public API that can be
        used to build a json structure using data.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/20/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1175 </span>    subroutine <strong>json_value_add_real_vec</strong><span class="sign">(</span>me<span class="sign">,</span> name<span class="sign">,</span> val<span class="sign">)</span>
<span class="line_number">1176 </span>
<span class="line_number">1177 </span>    implicit none
<span class="line_number">1178 </span>
<span class="line_number">1179 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer         <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">1180 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>       <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1181 </span>    real<span class="sign">(</span>wp<span class="sign">)</span><span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1182 </span>
<span class="line_number">1183 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> var
<span class="line_number">1184 </span>    integer <span class="sign">:</span><span class="sign">:</span> i
<span class="line_number">1185 </span>
<span class="line_number">1186 </span>    <span class="sign">!</span>create the variable as an array<span class="sign">:</span>
<span class="line_number">1187 </span>    call <a href="#robo47">json_value_create</a><span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1188 </span>    call <a href="#robo65">to_array</a><span class="sign">(</span>var<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">1189 </span>
<span class="line_number">1190 </span>    <span class="sign">!</span>populate the array<span class="sign">:</span>
<span class="line_number">1191 </span>    do i<span class="sign">=</span>1<span class="sign">,</span>size<span class="sign">(</span>val<span class="sign">)</span>
<span class="line_number">1192 </span>        call json_value_add<span class="sign">(</span>var<span class="sign">,</span> <span class="squote">''</span><span class="sign">,</span> val<span class="sign">(</span>i<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">1193 </span>    end do
<span class="line_number">1194 </span>
<span class="line_number">1195 </span>    <span class="sign">!</span>add it<span class="sign">:</span>
<span class="line_number">1196 </span>    call json_value_add<span class="sign">(</span>me<span class="sign">,</span> var<span class="sign">)</span>
<span class="line_number">1197 </span>
<span class="line_number">1198 </span>    <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">1199 </span>    nullify<span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1200 </span>
<span class="line_number">1201 </span>    end subroutine <strong>json_value_add_real_vec</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fadd5fstring"></a>
<a name="robo44"></a><h2>json_module/json_value_add_string [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_add_string</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Add a character string the structure.

    These routines are part of the public API that can be
        used to build a json structure using data.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/19/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1393 </span>    subroutine <strong>json_value_add_string</strong><span class="sign">(</span>me<span class="sign">,</span> name<span class="sign">,</span> val<span class="sign">)</span>
<span class="line_number">1394 </span>
<span class="line_number">1395 </span>    implicit none
<span class="line_number">1396 </span>
<span class="line_number">1397 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer   <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">1398 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1399 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1400 </span>
<span class="line_number">1401 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer        <span class="sign">:</span><span class="sign">:</span> var
<span class="line_number">1402 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable    <span class="sign">:</span><span class="sign">:</span> str
<span class="line_number">1403 </span>
<span class="line_number">1404 </span>    <span class="sign">!</span>add escape characters if necessary<span class="sign">:</span>
<span class="line_number">1405 </span>    call <a href="#robo4">escape_string</a><span class="sign">(</span>val<span class="sign">,</span> str<span class="sign">)</span>
<span class="line_number">1406 </span>
<span class="line_number">1407 </span>    <span class="sign">!</span>create the variable<span class="sign">:</span>
<span class="line_number">1408 </span>    call <a href="#robo47">json_value_create</a><span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1409 </span>    call <a href="#robo71">to_string</a><span class="sign">(</span>var<span class="sign">,</span>str<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">1410 </span>
<span class="line_number">1411 </span>    <span class="sign">!</span>add it<span class="sign">:</span>
<span class="line_number">1412 </span>    call json_value_add<span class="sign">(</span>me<span class="sign">,</span> var<span class="sign">)</span>
<span class="line_number">1413 </span>
<span class="line_number">1414 </span>    <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">1415 </span>    nullify<span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1416 </span>
<span class="line_number">1417 </span>    end subroutine <strong>json_value_add_string</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fadd5fstring5fvec"></a>
<a name="robo45"></a><h2>json_module/json_value_add_string_vec [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_add_string_vec</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Add an array of character string to the structure.

    These routines are part of the public API that can be
        used to build a json structure using data.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/19/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1495 </span>    subroutine <strong>json_value_add_string_vec</strong><span class="sign">(</span>me<span class="sign">,</span> name<span class="sign">,</span> val<span class="sign">,</span> trim_str<span class="sign">,</span> adjustl_str<span class="sign">)</span>
<span class="line_number">1496 </span>
<span class="line_number">1497 </span>    implicit none
<span class="line_number">1498 </span>
<span class="line_number">1499 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer                <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">1500 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>              <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">1501 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>dimension<span class="sign">(</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">1502 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional              <span class="sign">:</span><span class="sign">:</span> trim_str
<span class="line_number">1503 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional              <span class="sign">:</span><span class="sign">:</span> adjustl_str
<span class="line_number">1504 </span>
<span class="line_number">1505 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> var
<span class="line_number">1506 </span>    integer <span class="sign">:</span><span class="sign">:</span> i
<span class="line_number">1507 </span>    logical <span class="sign">:</span><span class="sign">:</span> trim_string<span class="sign">,</span> adjustl_string
<span class="line_number">1508 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable <span class="sign">:</span><span class="sign">:</span> str
<span class="line_number">1509 </span>
<span class="line_number">1510 </span>    <span class="sign">!</span>if the string is to be trimmed or not<span class="sign">:</span>
<span class="line_number">1511 </span>    if <span class="sign">(</span>present<span class="sign">(</span>trim_str<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1512 </span>        trim_string <span class="sign">=</span> trim_str
<span class="line_number">1513 </span>    else
<span class="line_number">1514 </span>        trim_string <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">1515 </span>    end if
<span class="line_number">1516 </span>    if <span class="sign">(</span>present<span class="sign">(</span>adjustl_str<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1517 </span>        adjustl_string <span class="sign">=</span> adjustl_str
<span class="line_number">1518 </span>    else
<span class="line_number">1519 </span>        adjustl_string <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">1520 </span>    end if
<span class="line_number">1521 </span>
<span class="line_number">1522 </span>    <span class="sign">!</span>create the variable as an array<span class="sign">:</span>
<span class="line_number">1523 </span>    call <a href="#robo47">json_value_create</a><span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1524 </span>    call <a href="#robo65">to_array</a><span class="sign">(</span>var<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">1525 </span>
<span class="line_number">1526 </span>    <span class="sign">!</span>populate the array<span class="sign">:</span>
<span class="line_number">1527 </span>    do i<span class="sign">=</span>1<span class="sign">,</span>size<span class="sign">(</span>val<span class="sign">)</span>
<span class="line_number">1528 </span>
<span class="line_number">1529 </span>        <span class="sign">!</span>the string to write<span class="sign">:</span>
<span class="line_number">1530 </span>        str <span class="sign">=</span> val<span class="sign">(</span>i<span class="sign">)</span>
<span class="line_number">1531 </span>        if <span class="sign">(</span>adjustl_string<span class="sign">)</span> str <span class="sign">=</span> adjustl<span class="sign">(</span>str<span class="sign">)</span>
<span class="line_number">1532 </span>        if <span class="sign">(</span>trim_string<span class="sign">)</span>    str <span class="sign">=</span> trim<span class="sign">(</span>str<span class="sign">)</span>
<span class="line_number">1533 </span>
<span class="line_number">1534 </span>        <span class="sign">!</span>write it<span class="sign">:</span>
<span class="line_number">1535 </span>        call json_value_add<span class="sign">(</span>var<span class="sign">,</span> <span class="squote">''</span><span class="sign">,</span> str<span class="sign">)</span>
<span class="line_number">1536 </span>
<span class="line_number">1537 </span>        <span class="sign">!</span>cleanup
<span class="line_number">1538 </span>        deallocate<span class="sign">(</span>str<span class="sign">)</span>
<span class="line_number">1539 </span>
<span class="line_number">1540 </span>    end do
<span class="line_number">1541 </span>
<span class="line_number">1542 </span>    <span class="sign">!</span>add it<span class="sign">:</span>
<span class="line_number">1543 </span>    call json_value_add<span class="sign">(</span>me<span class="sign">,</span> var<span class="sign">)</span>
<span class="line_number">1544 </span>
<span class="line_number">1545 </span>    <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">1546 </span>    nullify<span class="sign">(</span>var<span class="sign">)</span>
<span class="line_number">1547 </span>
<span class="line_number">1548 </span>    end subroutine <strong>json_value_add_string_vec</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fcount"></a>
<a name="robo46"></a><h2>json_module/json_value_count [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_count</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Count the number of children.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1562 </span>    function <strong>json_value_count</strong><span class="sign">(</span>this<span class="sign">)</span> result<span class="sign">(</span>count<span class="sign">)</span>
<span class="line_number">1563 </span>
<span class="line_number">1564 </span>    implicit none
<span class="line_number">1565 </span>
<span class="line_number">1566 </span>    integer <span class="sign">:</span><span class="sign">:</span> count
<span class="line_number">1567 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">1568 </span>
<span class="line_number">1569 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">1570 </span>
<span class="line_number">1571 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">1572 </span>
<span class="line_number">1573 </span>        count <span class="sign">=</span> 0
<span class="line_number">1574 </span>        
<span class="line_number">1575 </span>        if <span class="sign">(</span>associated<span class="sign">(</span>this<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1576 </span>
<span class="line_number">1577 </span>            if <span class="sign">(</span>associated<span class="sign">(</span>this<span class="sign">%</span>children<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1578 </span>
<span class="line_number">1579 </span>                p <span class="sign">=</span><span class="sign">&gt;</span> this<span class="sign">%</span>children
<span class="line_number">1580 </span>
<span class="line_number">1581 </span>                do while <span class="sign">(</span>associated<span class="sign">(</span>p<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">1582 </span>                    count <span class="sign">=</span> count <span class="sign">+</span> 1
<span class="line_number">1583 </span>                    p <span class="sign">=</span><span class="sign">&gt;</span> p<span class="sign">%</span>next
<span class="line_number">1584 </span>                end do
<span class="line_number">1585 </span>
<span class="line_number">1586 </span>                nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">1587 </span>
<span class="line_number">1588 </span>            end if
<span class="line_number">1589 </span>            
<span class="line_number">1590 </span>        end if
<span class="line_number">1591 </span>        
<span class="line_number">1592 </span>    end if
<span class="line_number">1593 </span>
<span class="line_number">1594 </span>    end function <strong>json_value_count</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fcreate"></a>
<a name="robo47"></a><h2>json_module/json_value_create [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_create</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Allocate a <a href="#robo36">json_value</a> pointer variable.
    This should be called before adding data to it.
    Example:
        type(<a href="#robo36">json_value</a>),pointer :: var
        call <strong>json_value_create</strong>(var)
        call <a href="#robo70">to_real</a>(var,1.0d0)
</pre>
<p class="item_name">NOTES</p>
<pre>    This routine does not check for exceptions.
    The pointer should not already be allocated.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1012 </span>    subroutine <strong>json_value_create</strong><span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">1013 </span>
<span class="line_number">1014 </span>    implicit none
<span class="line_number">1015 </span>
<span class="line_number">1016 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">1017 </span>
<span class="line_number">1018 </span>    nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">1019 </span>    allocate<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">1020 </span>
<span class="line_number">1021 </span>    end subroutine <strong>json_value_create</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fdestroy"></a>
<a name="robo48"></a><h2>json_module/json_value_destroy [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_destroy</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Destroy a <a href="#robo36">json_value</a> linked-list structure.
</pre>
<p class="item_name">NOTES</p>
<pre>    This routine does not check for exceptions.
    I believe the original version of this routine was not
        properly freeing the memory.  It has been rewritten.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/22/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1043 </span>    recursive subroutine <strong>json_value_destroy</strong><span class="sign">(</span>this<span class="sign">)</span>
<span class="line_number">1044 </span>
<span class="line_number">1045 </span>    implicit none
<span class="line_number">1046 </span>
<span class="line_number">1047 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">1048 </span>
<span class="line_number">1049 </span>    if <span class="sign">(</span>associated<span class="sign">(</span>this<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1050 </span>
<span class="line_number">1051 </span>        if <span class="sign">(</span>allocated<span class="sign">(</span>this<span class="sign">%</span>name<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>this<span class="sign">%</span>name<span class="sign">)</span>
<span class="line_number">1052 </span>
<span class="line_number">1053 </span>        call this<span class="sign">%</span>data<span class="sign">%</span>destroy<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">1054 </span>
<span class="line_number">1055 </span>        if <span class="sign">(</span>associated<span class="sign">(</span>this<span class="sign">%</span>children<span class="sign">)</span><span class="sign">)</span>    call <strong>json_value_destroy</strong><span class="sign">(</span>this<span class="sign">%</span>children<span class="sign">)</span>
<span class="line_number">1056 </span>
<span class="line_number">1057 </span>        if <span class="sign">(</span>associated<span class="sign">(</span>this<span class="sign">%</span>next<span class="sign">)</span><span class="sign">)</span>        call <strong>json_value_destroy</strong><span class="sign">(</span>this<span class="sign">%</span>next<span class="sign">)</span>
<span class="line_number">1058 </span>
<span class="line_number">1059 </span>        deallocate<span class="sign">(</span>this<span class="sign">)</span>
<span class="line_number">1060 </span>
<span class="line_number">1061 </span>        nullify<span class="sign">(</span>this<span class="sign">)</span>
<span class="line_number">1062 </span>
<span class="line_number">1063 </span>    end if
<span class="line_number">1064 </span>
<span class="line_number">1065 </span>    end subroutine <strong>json_value_destroy</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fprint"></a>
<a name="robo49"></a><h2>json_module/json_value_print [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_print</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Print the JSON structure to a file
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1734 </span>    recursive subroutine <strong>json_value_print</strong><span class="sign">(</span>this<span class="sign">,</span>iunit<span class="sign">,</span>indent<span class="sign">,</span>need_comma<span class="sign">,</span>colon<span class="sign">,</span>str<span class="sign">)</span>
<span class="line_number">1735 </span>
<span class="line_number">1736 </span>    implicit none
<span class="line_number">1737 </span>
<span class="line_number">1738 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>  <span class="sign">:</span><span class="sign">:</span> this
<span class="line_number">1739 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>                   <span class="sign">:</span><span class="sign">:</span> iunit        <span class="sign">!</span>file unit to write to <span class="sign">(</span>6<span class="sign">=</span>console<span class="sign">)</span>
<span class="line_number">1740 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional          <span class="sign">:</span><span class="sign">:</span> indent
<span class="line_number">1741 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional          <span class="sign">:</span><span class="sign">:</span> need_comma
<span class="line_number">1742 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional          <span class="sign">:</span><span class="sign">:</span> colon
<span class="line_number">1743 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>optional <span class="sign">:</span><span class="sign">:</span> str <span class="sign">!</span>if iunit<span class="sign">=</span><span class="sign">=</span>0 and this is present<span class="sign">,</span> then the 
<span class="line_number">1744 </span>                                                               <span class="sign">!</span>structure is printed to this string<span class="sign">,</span> rather than a file<span class="sign">.</span>
<span class="line_number">1745 </span>                                                               <span class="sign">!</span>This mode is used by <a href="#robo50">json_value_to_string</a><span class="sign">.</span>
<span class="line_number">1746 </span>
<span class="line_number">1747 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> element
<span class="line_number">1748 </span>    integer <span class="sign">:</span><span class="sign">:</span> tab<span class="sign">,</span> i<span class="sign">,</span> count<span class="sign">,</span> spaces
<span class="line_number">1749 </span>    character<span class="sign">(</span>len<span class="sign">=</span>32<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> tmp    <span class="sign">!</span>for val to string conversions
<span class="line_number">1750 </span>    logical <span class="sign">:</span><span class="sign">:</span> print_comma
<span class="line_number">1751 </span>    logical <span class="sign">:</span><span class="sign">:</span> print_spaces
<span class="line_number">1752 </span>    logical <span class="sign">:</span><span class="sign">:</span> write_file<span class="sign">,</span> write_string
<span class="line_number">1753 </span>
<span class="line_number">1754 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">1755 </span>        
<span class="line_number">1756 </span>        <span class="sign">!</span>whether to write a string or a file <span class="sign">(</span>one or the other<span class="sign">)</span><span class="sign">:</span>
<span class="line_number">1757 </span>        write_string <span class="sign">=</span> <span class="sign">(</span>present<span class="sign">(</span>str<span class="sign">)</span> <span class="sign">.</span>and<span class="sign">.</span> iunit<span class="sign">=</span><span class="sign">=</span>0<span class="sign">)</span>
<span class="line_number">1758 </span>        write_file <span class="sign">=</span> <span class="sign">.</span>not<span class="sign">.</span> write_string
<span class="line_number">1759 </span>
<span class="line_number">1760 </span>        <span class="sign">!</span>if the comma will be printed after the value
<span class="line_number">1761 </span>        <span class="sign">!</span> <span class="sign">[</span>comma not printed for the last elements<span class="sign">]</span>
<span class="line_number">1762 </span>        if <span class="sign">(</span>present<span class="sign">(</span>need_comma<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1763 </span>            print_comma <span class="sign">=</span> need_comma
<span class="line_number">1764 </span>        else
<span class="line_number">1765 </span>            print_comma <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">1766 </span>        end if
<span class="line_number">1767 </span>        <span class="sign">!</span>if the colon was the last thing written
<span class="line_number">1768 </span>        if <span class="sign">(</span>present<span class="sign">(</span>colon<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1769 </span>            print_spaces <span class="sign">=</span> <span class="sign">.</span>not<span class="sign">.</span> colon
<span class="line_number">1770 </span>        else
<span class="line_number">1771 </span>            print_spaces <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">1772 </span>        end if
<span class="line_number">1773 </span>
<span class="line_number">1774 </span>        if <span class="sign">(</span>present<span class="sign">(</span>indent<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1775 </span>            tab <span class="sign">=</span> indent
<span class="line_number">1776 </span>        else
<span class="line_number">1777 </span>            tab <span class="sign">=</span> 0
<span class="line_number">1778 </span>        end if
<span class="line_number">1779 </span>
<span class="line_number">1780 </span>        if <span class="sign">(</span>print_spaces<span class="sign">)</span> then
<span class="line_number">1781 </span>            spaces <span class="sign">=</span> tab <span class="sign">*</span> 2
<span class="line_number">1782 </span>        else
<span class="line_number">1783 </span>            spaces <span class="sign">=</span> 0
<span class="line_number">1784 </span>        end if
<span class="line_number">1785 </span>        
<span class="line_number">1786 </span>        nullify<span class="sign">(</span>element<span class="sign">)</span>
<span class="line_number">1787 </span>
<span class="line_number">1788 </span>        <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> this<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">1789 </span>
<span class="line_number">1790 </span>            select case <span class="sign">(</span>this<span class="sign">%</span>data<span class="sign">%</span>var_type<span class="sign">)</span>
<span class="line_number">1791 </span>
<span class="line_number">1792 </span>            case <span class="sign">(</span>json_object<span class="sign">)</span>
<span class="line_number">1793 </span>                
<span class="line_number">1794 </span>                call write_it<span class="sign">(</span> repeat<span class="sign">(</span>space<span class="sign">,</span> spaces<span class="sign">)</span><span class="sign">/</span><span class="sign">/</span><span class="squote">'{'</span> <span class="sign">)</span>
<span class="line_number">1795 </span>                 
<span class="line_number">1796 </span>                count <span class="sign">=</span> <a href="#robo46">json_value_count</a><span class="sign">(</span>this<span class="sign">)</span>
<span class="line_number">1797 </span>                do i <span class="sign">=</span> 1<span class="sign">,</span> count
<span class="line_number">1798 </span>
<span class="line_number">1799 </span>                    <span class="sign">!</span> get the element
<span class="line_number">1800 </span>                    call json_value_get<span class="sign">(</span>this<span class="sign">,</span> i<span class="sign">,</span> element<span class="sign">)</span>
<span class="line_number">1801 </span>
<span class="line_number">1802 </span>                    <span class="sign">!</span> print the name
<span class="line_number">1803 </span>                    if <span class="sign">(</span>allocated<span class="sign">(</span>element<span class="sign">%</span>name<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1804 </span>                        call write_it<span class="sign">(</span>repeat<span class="sign">(</span>space<span class="sign">,</span> spaces<span class="sign">)</span><span class="sign">/</span><span class="sign">/</span><span class="squote">'"'</span><span class="sign">/</span><span class="sign">/</span> trim<span class="sign">(</span>element <span class="sign">%</span> name<span class="sign">)</span><span class="sign">/</span><span class="sign">/</span><span class="squote">'": '</span><span class="sign">,</span>advance<span class="sign">=</span><span class="sign">.</span>false<span class="sign">.</span><span class="sign">)</span>
<span class="line_number">1805 </span>                    else
<span class="line_number">1806 </span>                        call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_value_print</strong>: element%name not allocated'</span><span class="sign">)</span>
<span class="line_number">1807 </span>                        call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">1808 </span>                        return
<span class="line_number">1809 </span>                    end if
<span class="line_number">1810 </span>
<span class="line_number">1811 </span>                    <span class="sign">!</span> recursive print of the element
<span class="line_number">1812 </span>                    call <strong>json_value_print</strong><span class="sign">(</span>element<span class="sign">,</span> iunit<span class="sign">=</span>iunit<span class="sign">,</span> indent<span class="sign">=</span>tab <span class="sign">+</span> 1<span class="sign">,</span> need_comma<span class="sign">=</span>i<span class="sign">&lt;</span>count<span class="sign">,</span> colon<span class="sign">=</span><span class="sign">.</span>true<span class="sign">.</span><span class="sign">,</span> str<span class="sign">=</span>str<span class="sign">)</span>
<span class="line_number">1813 </span>
<span class="line_number">1814 </span>                end do
<span class="line_number">1815 </span>
<span class="line_number">1816 </span>                call write_it<span class="sign">(</span> repeat<span class="sign">(</span>space<span class="sign">,</span> spaces<span class="sign">)</span><span class="sign">/</span><span class="sign">/</span><span class="squote">'}'</span><span class="sign">,</span> comma<span class="sign">=</span>print_comma <span class="sign">)</span>
<span class="line_number">1817 </span>
<span class="line_number">1818 </span>            case <span class="sign">(</span>json_array<span class="sign">)</span>
<span class="line_number">1819 </span>
<span class="line_number">1820 </span>                call write_it<span class="sign">(</span> <span class="squote">'['</span> <span class="sign">)</span>
<span class="line_number">1821 </span>                count <span class="sign">=</span> <a href="#robo46">json_value_count</a><span class="sign">(</span>this<span class="sign">)</span>
<span class="line_number">1822 </span>
<span class="line_number">1823 </span>                do i <span class="sign">=</span> 1<span class="sign">,</span> count
<span class="line_number">1824 </span>
<span class="line_number">1825 </span>                    <span class="sign">!</span> get the element
<span class="line_number">1826 </span>                    call json_value_get<span class="sign">(</span>this<span class="sign">,</span> i<span class="sign">,</span> element<span class="sign">)</span>
<span class="line_number">1827 </span>
<span class="line_number">1828 </span>                    <span class="sign">!</span> recursive print of the element
<span class="line_number">1829 </span>                    call <strong>json_value_print</strong><span class="sign">(</span>element<span class="sign">,</span> iunit<span class="sign">=</span>iunit<span class="sign">,</span> indent<span class="sign">=</span>tab <span class="sign">+</span> 1<span class="sign">,</span> need_comma<span class="sign">=</span>i<span class="sign">&lt;</span>count<span class="sign">,</span> str<span class="sign">=</span>str<span class="sign">)</span>
<span class="line_number">1830 </span>
<span class="line_number">1831 </span>                end do
<span class="line_number">1832 </span>
<span class="line_number">1833 </span>                call write_it<span class="sign">(</span> repeat<span class="sign">(</span>space<span class="sign">,</span> tab <span class="sign">*</span> 2<span class="sign">)</span><span class="sign">/</span><span class="sign">/</span><span class="squote">']'</span><span class="sign">,</span> comma<span class="sign">=</span>print_comma <span class="sign">)</span> <span class="sign">!</span>indent the closing array character
<span class="line_number">1834 </span>
<span class="line_number">1835 </span>            case <span class="sign">(</span>json_null<span class="sign">)</span>
<span class="line_number">1836 </span>
<span class="line_number">1837 </span>                call write_it<span class="sign">(</span> repeat<span class="sign">(</span>space<span class="sign">,</span> spaces<span class="sign">)</span><span class="sign">/</span><span class="sign">/</span><span class="squote">'null'</span><span class="sign">,</span> comma<span class="sign">=</span>print_comma <span class="sign">)</span>
<span class="line_number">1838 </span>
<span class="line_number">1839 </span>            case <span class="sign">(</span>json_string<span class="sign">)</span>
<span class="line_number">1840 </span>
<span class="line_number">1841 </span>                if <span class="sign">(</span>allocated<span class="sign">(</span>this<span class="sign">%</span>data<span class="sign">%</span>str_value<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1842 </span>                    call write_it<span class="sign">(</span> repeat<span class="sign">(</span>space<span class="sign">,</span> spaces<span class="sign">)</span><span class="sign">/</span><span class="sign">/</span><span class="squote">'"'</span><span class="sign">/</span><span class="sign">/</span> trim<span class="sign">(</span>this<span class="sign">%</span>data<span class="sign">%</span>str_value<span class="sign">)</span><span class="sign">/</span><span class="sign">/</span><span class="squote">'"'</span><span class="sign">,</span> comma<span class="sign">=</span>print_comma <span class="sign">)</span>
<span class="line_number">1843 </span>                else
<span class="line_number">1844 </span>                    call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_value_print</strong>: this%value_string not allocated'</span><span class="sign">)</span>
<span class="line_number">1845 </span>                    call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">1846 </span>                    return
<span class="line_number">1847 </span>                end if
<span class="line_number">1848 </span>
<span class="line_number">1849 </span>            case <span class="sign">(</span>json_logical<span class="sign">)</span>
<span class="line_number">1850 </span>
<span class="line_number">1851 </span>                if <span class="sign">(</span>this<span class="sign">%</span>data<span class="sign">%</span>log_value<span class="sign">)</span> then
<span class="line_number">1852 </span>                    call write_it<span class="sign">(</span> repeat<span class="sign">(</span>space<span class="sign">,</span> spaces<span class="sign">)</span><span class="sign">/</span><span class="sign">/</span> <span class="squote">'true'</span><span class="sign">,</span> comma<span class="sign">=</span>print_comma <span class="sign">)</span>
<span class="line_number">1853 </span>                else
<span class="line_number">1854 </span>                    call write_it<span class="sign">(</span> repeat<span class="sign">(</span>space<span class="sign">,</span> spaces<span class="sign">)</span><span class="sign">/</span><span class="sign">/</span><span class="squote">'false'</span><span class="sign">,</span> comma<span class="sign">=</span>print_comma <span class="sign">)</span>
<span class="line_number">1855 </span>                end if
<span class="line_number">1856 </span>
<span class="line_number">1857 </span>            case <span class="sign">(</span>json_integer<span class="sign">)</span>
<span class="line_number">1858 </span>
<span class="line_number">1859 </span>                call <a href="#robo17">integer_to_string</a><span class="sign">(</span>this<span class="sign">%</span>data<span class="sign">%</span>int_value<span class="sign">,</span>tmp<span class="sign">)</span>
<span class="line_number">1860 </span>
<span class="line_number">1861 </span>                call write_it<span class="sign">(</span> repeat<span class="sign">(</span>space<span class="sign">,</span> spaces<span class="sign">)</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>tmp<span class="sign">)</span><span class="sign">,</span> comma<span class="sign">=</span>print_comma <span class="sign">)</span>
<span class="line_number">1862 </span>
<span class="line_number">1863 </span>            case <span class="sign">(</span>json_real<span class="sign">)</span>
<span class="line_number">1864 </span>
<span class="line_number">1865 </span>                call <a href="#robo61">real_to_string</a><span class="sign">(</span>this<span class="sign">%</span>data<span class="sign">%</span>dbl_value<span class="sign">,</span>tmp<span class="sign">)</span>
<span class="line_number">1866 </span>
<span class="line_number">1867 </span>                call write_it<span class="sign">(</span> repeat<span class="sign">(</span>space<span class="sign">,</span> spaces<span class="sign">)</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>tmp<span class="sign">)</span><span class="sign">,</span> comma<span class="sign">=</span>print_comma <span class="sign">)</span>
<span class="line_number">1868 </span>
<span class="line_number">1869 </span>            case default
<span class="line_number">1870 </span>
<span class="line_number">1871 </span>                call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>json_value_print</strong>: unknown data type'</span><span class="sign">)</span>
<span class="line_number">1872 </span>
<span class="line_number">1873 </span>            end select
<span class="line_number">1874 </span>
<span class="line_number">1875 </span>        <span class="sign">!</span>end associate
<span class="line_number">1876 </span>
<span class="line_number">1877 </span>        call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">1878 </span>
<span class="line_number">1879 </span>    end if
<span class="line_number">1880 </span>
<span class="line_number">1881 </span>    contains
<span class="line_number">1882 </span>
<span class="line_number">1883 </span>        <span class="sign">!</span> cleanup routine
<span class="line_number">1884 </span>        subroutine cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">1885 </span>        implicit none
<span class="line_number">1886 </span>
<span class="line_number">1887 </span>        if <span class="sign">(</span>associated<span class="sign">(</span>element<span class="sign">)</span><span class="sign">)</span> nullify<span class="sign">(</span>element<span class="sign">)</span>
<span class="line_number">1888 </span>
<span class="line_number">1889 </span>        end subroutine cleanup
<span class="line_number">1890 </span>    
<span class="line_number">1891 </span>        <span class="sign">!</span> write the string to the file <span class="sign">(</span>or the output string<span class="sign">)</span>
<span class="line_number">1892 </span>        subroutine write_it<span class="sign">(</span>s<span class="sign">,</span>advance<span class="sign">,</span>comma<span class="sign">)</span>
<span class="line_number">1893 </span>
<span class="line_number">1894 </span>        implicit none
<span class="line_number">1895 </span>
<span class="line_number">1896 </span>        character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> s
<span class="line_number">1897 </span>        logical<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional <span class="sign">:</span><span class="sign">:</span> advance
<span class="line_number">1898 </span>        logical<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional <span class="sign">:</span><span class="sign">:</span> comma
<span class="line_number">1899 </span>       
<span class="line_number">1900 </span>        logical <span class="sign">:</span><span class="sign">:</span> add_line_break<span class="sign">,</span> add_comma
<span class="line_number">1901 </span>        character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable <span class="sign">:</span><span class="sign">:</span> s2
<span class="line_number">1902 </span>        
<span class="line_number">1903 </span>        if <span class="sign">(</span>present<span class="sign">(</span>comma<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1904 </span>            add_comma <span class="sign">=</span> comma
<span class="line_number">1905 </span>        else
<span class="line_number">1906 </span>            add_comma <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span> <span class="sign">!</span>default is not to add comma
<span class="line_number">1907 </span>        end if
<span class="line_number">1908 </span>         
<span class="line_number">1909 </span>        if <span class="sign">(</span>present<span class="sign">(</span>advance<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">1910 </span>            add_line_break <span class="sign">=</span> advance
<span class="line_number">1911 </span>        else
<span class="line_number">1912 </span>            add_line_break <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span> <span class="sign">!</span>default is to advance
<span class="line_number">1913 </span>        end if
<span class="line_number">1914 </span>        
<span class="line_number">1915 </span>        <span class="sign">!</span>string to print<span class="sign">:</span>
<span class="line_number">1916 </span>        s2 <span class="sign">=</span> s
<span class="line_number">1917 </span>        if <span class="sign">(</span>add_comma<span class="sign">)</span> s2 <span class="sign">=</span> s2 <span class="sign">/</span><span class="sign">/</span> <span class="squote">','</span>
<span class="line_number">1918 </span>        
<span class="line_number">1919 </span>        if <span class="sign">(</span>write_file<span class="sign">)</span> then
<span class="line_number">1920 </span>        
<span class="line_number">1921 </span>            if <span class="sign">(</span>add_line_break<span class="sign">)</span> then
<span class="line_number">1922 </span>                write<span class="sign">(</span>iunit<span class="sign">,</span>fmt<span class="sign">=</span><span class="squote">'(A)'</span><span class="sign">)</span> s2
<span class="line_number">1923 </span>            else
<span class="line_number">1924 </span>                write<span class="sign">(</span>iunit<span class="sign">,</span>fmt<span class="sign">=</span><span class="squote">'(A)'</span><span class="sign">,</span>advance<span class="sign">=</span><span class="squote">'NO'</span><span class="sign">)</span> s2
<span class="line_number">1925 </span>            end if
<span class="line_number">1926 </span>            
<span class="line_number">1927 </span>        else    <span class="sign">!</span>write string
<span class="line_number">1928 </span>        
<span class="line_number">1929 </span>            str <span class="sign">=</span> str <span class="sign">/</span><span class="sign">/</span> s2
<span class="line_number">1930 </span>            if <span class="sign">(</span>add_line_break<span class="sign">)</span> str <span class="sign">=</span> str <span class="sign">/</span><span class="sign">/</span> newline
<span class="line_number">1931 </span>            
<span class="line_number">1932 </span>        end if
<span class="line_number">1933 </span>        
<span class="line_number">1934 </span>        <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">1935 </span>        if <span class="sign">(</span>allocated<span class="sign">(</span>s2<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>s2<span class="sign">)</span>
<span class="line_number">1936 </span>        
<span class="line_number">1937 </span>        end subroutine write_it
<span class="line_number">1938 </span>
<span class="line_number">1939 </span>    end subroutine <strong>json_value_print</strong>
</pre>

<hr />
<a name="json5fmodule2fjson5fvalue5fto5fstring"></a>
<a name="robo50"></a><h2>json_module/json_value_to_string [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>json_value_to_string</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Print the JSON structure to an allocatable string.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 2/12/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">1710 </span>    subroutine <strong>json_value_to_string</strong><span class="sign">(</span>me<span class="sign">,</span>str<span class="sign">)</span>
<span class="line_number">1711 </span>
<span class="line_number">1712 </span>    implicit none
<span class="line_number">1713 </span>    
<span class="line_number">1714 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>        <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">1715 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span><span class="sign">,</span>allocatable   <span class="sign">:</span><span class="sign">:</span> str
<span class="line_number">1716 </span>    
<span class="line_number">1717 </span>    str <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">1718 </span>    call <a href="#robo49">json_value_print</a><span class="sign">(</span>me<span class="sign">,</span> iunit<span class="sign">=</span>0<span class="sign">,</span> str<span class="sign">=</span>str<span class="sign">)</span>
<span class="line_number">1719 </span>    
<span class="line_number">1720 </span>    end subroutine <strong>json_value_to_string</strong>
</pre>

<hr />
<a name="json5fmodule2fload5fjson5ffile"></a>
<a name="robo51"></a><h2>json_module/load_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>load_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%load_file(filename)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Load the JSON file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/9/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">406 </span>    subroutine <strong>load_json_file</strong><span class="sign">(</span>me<span class="sign">,</span> filename<span class="sign">)</span>
<span class="line_number">407 </span>
<span class="line_number">408 </span>    implicit none
<span class="line_number">409 </span>
<span class="line_number">410 </span>    class<span class="sign">(</span><a href="#robo22">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">411 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> filename
<span class="line_number">412 </span>
<span class="line_number">413 </span>    call <a href="#robo35">json_parse</a><span class="sign">(</span>filename<span class="sign">,</span> me<span class="sign">%</span>p<span class="sign">)</span>
<span class="line_number">414 </span>
<span class="line_number">415 </span>    end subroutine <strong>load_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fparse5farray"></a>
<a name="robo52"></a><h2>json_module/parse_array [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>parse_array</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3549 </span>    recursive subroutine <strong>parse_array</strong><span class="sign">(</span>unit<span class="sign">,</span> array<span class="sign">)</span>
<span class="line_number">3550 </span>
<span class="line_number">3551 </span>    implicit none
<span class="line_number">3552 </span>
<span class="line_number">3553 </span>    integer<span class="sign">,</span> intent<span class="sign">(</span>in<span class="sign">)</span>       <span class="sign">:</span><span class="sign">:</span> unit
<span class="line_number">3554 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> array
<span class="line_number">3555 </span>
<span class="line_number">3556 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> element
<span class="line_number">3557 </span>    logical <span class="sign">:</span><span class="sign">:</span> eof
<span class="line_number">3558 </span>    character<span class="sign">(</span>len<span class="sign">=</span>1<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> c
<span class="line_number">3559 </span>
<span class="line_number">3560 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">3561 </span>        nullify<span class="sign">(</span>element<span class="sign">)</span>
<span class="line_number">3562 </span>
<span class="line_number">3563 </span>        <span class="sign">!</span> try to parse an element value
<span class="line_number">3564 </span>        call <a href="#robo47">json_value_create</a><span class="sign">(</span>element<span class="sign">)</span>
<span class="line_number">3565 </span>        call <a href="#robo57">parse_value</a><span class="sign">(</span>unit<span class="sign">,</span> element<span class="sign">)</span>
<span class="line_number">3566 </span>        if <span class="sign">(</span>exception_thrown<span class="sign">)</span> return
<span class="line_number">3567 </span>
<span class="line_number">3568 </span>        <span class="sign">!</span> parse value will disassociate an empty array value
<span class="line_number">3569 </span>        if <span class="sign">(</span>associated<span class="sign">(</span>element<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3570 </span>            call json_value_add<span class="sign">(</span>array<span class="sign">,</span> element<span class="sign">)</span>
<span class="line_number">3571 </span>            nullify<span class="sign">(</span>element<span class="sign">)</span>    <span class="sign">!</span>cleanup
<span class="line_number">3572 </span>        end if
<span class="line_number">3573 </span>
<span class="line_number">3574 </span>        <span class="sign">!</span> popped the next character
<span class="line_number">3575 </span>        c <span class="sign">=</span> <a href="#robo58">pop_char</a><span class="sign">(</span>unit<span class="sign">,</span> eof <span class="sign">=</span> eof<span class="sign">,</span> skip_ws <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span><span class="sign">)</span>
<span class="line_number">3576 </span>
<span class="line_number">3577 </span>        if <span class="sign">(</span>eof<span class="sign">)</span> then
<span class="line_number">3578 </span>            return
<span class="line_number">3579 </span>        else if <span class="sign">(</span><span class="squote">','</span> <span class="sign">=</span><span class="sign">=</span> c<span class="sign">)</span> then
<span class="line_number">3580 </span>            <span class="sign">!</span> parse the next element
<span class="line_number">3581 </span>            call <strong>parse_array</strong><span class="sign">(</span>unit<span class="sign">,</span> array<span class="sign">)</span>
<span class="line_number">3582 </span>            if <span class="sign">(</span>exception_thrown<span class="sign">)</span> return
<span class="line_number">3583 </span>        else if <span class="sign">(</span><span class="squote">']'</span> <span class="sign">=</span><span class="sign">=</span> c<span class="sign">)</span> then
<span class="line_number">3584 </span>            <span class="sign">!</span> end of array
<span class="line_number">3585 </span>            return
<span class="line_number">3586 </span>        end if
<span class="line_number">3587 </span>
<span class="line_number">3588 </span>    end if
<span class="line_number">3589 </span>
<span class="line_number">3590 </span>    end subroutine <strong>parse_array</strong>
</pre>

<hr />
<a name="json5fmodule2fparse5ffor5fchars"></a>
<a name="robo53"></a><h2>json_module/parse_for_chars [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>parse_for_chars</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3700 </span>    subroutine <strong>parse_for_chars</strong><span class="sign">(</span>unit<span class="sign">,</span> chars<span class="sign">)</span>
<span class="line_number">3701 </span>
<span class="line_number">3702 </span>    implicit none
<span class="line_number">3703 </span>
<span class="line_number">3704 </span>    integer<span class="sign">,</span> intent<span class="sign">(</span>in<span class="sign">)</span>            <span class="sign">:</span><span class="sign">:</span> unit
<span class="line_number">3705 </span>    character<span class="sign">(</span>len <span class="sign">=</span> <span class="sign">*</span><span class="sign">)</span><span class="sign">,</span> intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> chars
<span class="line_number">3706 </span>
<span class="line_number">3707 </span>    integer <span class="sign">:</span><span class="sign">:</span> i<span class="sign">,</span> length
<span class="line_number">3708 </span>    logical <span class="sign">:</span><span class="sign">:</span> eof
<span class="line_number">3709 </span>    character<span class="sign">(</span>len<span class="sign">=</span>1<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> c
<span class="line_number">3710 </span>
<span class="line_number">3711 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">3712 </span>
<span class="line_number">3713 </span>        length <span class="sign">=</span> len_trim<span class="sign">(</span>chars<span class="sign">)</span>
<span class="line_number">3714 </span>
<span class="line_number">3715 </span>        do i <span class="sign">=</span> 1<span class="sign">,</span> length
<span class="line_number">3716 </span>            c <span class="sign">=</span> <a href="#robo58">pop_char</a><span class="sign">(</span>unit<span class="sign">,</span> eof <span class="sign">=</span> eof<span class="sign">,</span> skip_ws <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span><span class="sign">)</span>
<span class="line_number">3717 </span>            if <span class="sign">(</span>eof<span class="sign">)</span> then
<span class="line_number">3718 </span>                call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_for_chars</strong>: Unexpected end of file while parsing array.'</span><span class="sign">)</span>
<span class="line_number">3719 </span>                return
<span class="line_number">3720 </span>            else if <span class="sign">(</span>c <span class="sign">/</span><span class="sign">=</span> chars<span class="sign">(</span>i<span class="sign">:</span>i<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3721 </span>                call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_for_chars</strong>: Unexpected character.: "'</span><span class="sign">/</span><span class="sign">/</span>c<span class="sign">/</span><span class="sign">/</span><span class="squote">'" '</span><span class="sign">/</span><span class="sign">/</span>chars<span class="sign">(</span>i<span class="sign">:</span>i<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">3722 </span>                return
<span class="line_number">3723 </span>            end if
<span class="line_number">3724 </span>        end do
<span class="line_number">3725 </span>
<span class="line_number">3726 </span>    end if
<span class="line_number">3727 </span>
<span class="line_number">3728 </span>    end subroutine <strong>parse_for_chars</strong>
</pre>

<hr />
<a name="json5fmodule2fparse5fnumber"></a>
<a name="robo54"></a><h2>json_module/parse_number [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<p class="item_name">DESCRIPTION</p>
<pre>    Read a numerical value from the file.
    The routine will determine if it is an integer or a double, and
    allocate the type accordingly.
</pre>
<p class="item_name">NOTES</p>
<pre>    Complete rewrite of the original FSON routine, which had some problems.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/20/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3749 </span>    subroutine <strong>parse_number</strong><span class="sign">(</span>unit<span class="sign">,</span> value<span class="sign">)</span>
<span class="line_number">3750 </span>
<span class="line_number">3751 </span>    implicit none
<span class="line_number">3752 </span>
<span class="line_number">3753 </span>    integer<span class="sign">,</span> intent<span class="sign">(</span>in<span class="sign">)</span>       <span class="sign">:</span><span class="sign">:</span> unit
<span class="line_number">3754 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> value
<span class="line_number">3755 </span>
<span class="line_number">3756 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable <span class="sign">:</span><span class="sign">:</span> str
<span class="line_number">3757 </span>    character<span class="sign">(</span>len<span class="sign">=</span>1<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> c
<span class="line_number">3758 </span>    logical <span class="sign">:</span><span class="sign">:</span> eof
<span class="line_number">3759 </span>    real<span class="sign">(</span>wp<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> rval
<span class="line_number">3760 </span>    integer <span class="sign">:</span><span class="sign">:</span> ival
<span class="line_number">3761 </span>    logical <span class="sign">:</span><span class="sign">:</span> first
<span class="line_number">3762 </span>    logical <span class="sign">:</span><span class="sign">:</span> is_integer
<span class="line_number">3763 </span>
<span class="line_number">3764 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">3765 </span>
<span class="line_number">3766 </span>        str <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">3767 </span>        first <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">3768 </span>        is_integer <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>    <span class="sign">!</span>assume it may be an integer<span class="sign">,</span>unless otherwise determined
<span class="line_number">3769 </span>
<span class="line_number">3770 </span>        <span class="sign">!</span>read one character at a time and accumulate the string<span class="sign">:</span>
<span class="line_number">3771 </span>        do
<span class="line_number">3772 </span>
<span class="line_number">3773 </span>            <span class="sign">!</span>get the next character<span class="sign">:</span>
<span class="line_number">3774 </span>            c <span class="sign">=</span> <a href="#robo58">pop_char</a><span class="sign">(</span>unit<span class="sign">,</span> eof <span class="sign">=</span> eof<span class="sign">,</span> skip_ws <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span><span class="sign">)</span>
<span class="line_number">3775 </span>
<span class="line_number">3776 </span>            if <span class="sign">(</span>eof<span class="sign">)</span> then
<span class="line_number">3777 </span>                call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_number</strong>: Unexpected end of file while parsing number.'</span><span class="sign">)</span>
<span class="line_number">3778 </span>                return
<span class="line_number">3779 </span>            else
<span class="line_number">3780 </span>
<span class="line_number">3781 </span>                select case <span class="sign">(</span>c<span class="sign">)</span>
<span class="line_number">3782 </span>                case<span class="sign">(</span><span class="squote">'-'</span><span class="sign">,</span><span class="squote">'+'</span><span class="sign">)</span>    <span class="sign">!</span>note<span class="sign">:</span> allowing a <span class="squote">'+'</span> as the first character here<span class="sign">.</span>
<span class="line_number">3783 </span>
<span class="line_number">3784 </span>                    if <span class="sign">(</span>is_integer <span class="sign">.</span>and<span class="sign">.</span> <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> first<span class="sign">)</span><span class="sign">)</span> is_integer <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">3785 </span>
<span class="line_number">3786 </span>                    <span class="sign">!</span>add it to the string<span class="sign">:</span>
<span class="line_number">3787 </span>                    str <span class="sign">=</span> str <span class="sign">/</span><span class="sign">/</span> c
<span class="line_number">3788 </span>
<span class="line_number">3789 </span>                case<span class="sign">(</span><span class="squote">'.'</span><span class="sign">,</span><span class="squote">'E'</span><span class="sign">,</span><span class="squote">'e'</span><span class="sign">)</span>    <span class="sign">!</span>can be present in real numbers
<span class="line_number">3790 </span>
<span class="line_number">3791 </span>                    if <span class="sign">(</span>is_integer<span class="sign">)</span> is_integer <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">3792 </span>
<span class="line_number">3793 </span>                    <span class="sign">!</span>add it to the string<span class="sign">:</span>
<span class="line_number">3794 </span>                    str <span class="sign">=</span> str <span class="sign">/</span><span class="sign">/</span> c
<span class="line_number">3795 </span>
<span class="line_number">3796 </span>                case<span class="sign">(</span><span class="squote">'0'</span><span class="sign">:</span><span class="squote">'9'</span><span class="sign">)</span>    <span class="sign">!</span>valid characters for numbers
<span class="line_number">3797 </span>
<span class="line_number">3798 </span>                    <span class="sign">!</span>add it to the string<span class="sign">:</span>
<span class="line_number">3799 </span>                    str <span class="sign">=</span> str <span class="sign">/</span><span class="sign">/</span> c
<span class="line_number">3800 </span>
<span class="line_number">3801 </span>                case default
<span class="line_number">3802 </span>
<span class="line_number">3803 </span>                    <span class="sign">!</span>push back the last character read<span class="sign">:</span>
<span class="line_number">3804 </span>                    call <a href="#robo60">push_char</a><span class="sign">(</span>c<span class="sign">)</span>
<span class="line_number">3805 </span>
<span class="line_number">3806 </span>                    <span class="sign">!</span>string to value<span class="sign">:</span>
<span class="line_number">3807 </span>                    if <span class="sign">(</span>is_integer<span class="sign">)</span> then
<span class="line_number">3808 </span>                        ival <span class="sign">=</span> <a href="#robo63">string_to_integer</a><span class="sign">(</span>str<span class="sign">)</span>
<span class="line_number">3809 </span>                        call <a href="#robo66">to_integer</a><span class="sign">(</span>value<span class="sign">,</span>ival<span class="sign">)</span>
<span class="line_number">3810 </span>                    else
<span class="line_number">3811 </span>                        rval <span class="sign">=</span> <a href="#robo62">string_to_double</a><span class="sign">(</span>str<span class="sign">)</span>
<span class="line_number">3812 </span>                        call <a href="#robo70">to_real</a><span class="sign">(</span>value<span class="sign">,</span>rval<span class="sign">)</span>
<span class="line_number">3813 </span>                    end if
<span class="line_number">3814 </span>
<span class="line_number">3815 </span>                    exit    <span class="sign">!</span>finished
<span class="line_number">3816 </span>
<span class="line_number">3817 </span>                end select
<span class="line_number">3818 </span>
<span class="line_number">3819 </span>            end if
<span class="line_number">3820 </span>            if <span class="sign">(</span>first<span class="sign">)</span> first <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">3821 </span>
<span class="line_number">3822 </span>        end do
<span class="line_number">3823 </span>
<span class="line_number">3824 </span>        <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">3825 </span>        if <span class="sign">(</span>allocated<span class="sign">(</span>str<span class="sign">)</span><span class="sign">)</span> deallocate<span class="sign">(</span>str<span class="sign">)</span>
<span class="line_number">3826 </span>
<span class="line_number">3827 </span>    end if
<span class="line_number">3828 </span>
<span class="line_number">3829 </span>    end subroutine <strong>parse_number</strong>
</pre>

<hr />
<a name="json5fmodule2fparse5fobject"></a>
<a name="robo55"></a><h2>json_module/parse_object [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>parse_object</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3446 </span>    recursive subroutine <strong>parse_object</strong><span class="sign">(</span>unit<span class="sign">,</span> parent<span class="sign">)</span>
<span class="line_number">3447 </span>
<span class="line_number">3448 </span>    implicit none
<span class="line_number">3449 </span>
<span class="line_number">3450 </span>    integer<span class="sign">,</span> intent<span class="sign">(</span>in<span class="sign">)</span>       <span class="sign">:</span><span class="sign">:</span> unit
<span class="line_number">3451 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> parent
<span class="line_number">3452 </span>
<span class="line_number">3453 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> pair
<span class="line_number">3454 </span>    logical <span class="sign">:</span><span class="sign">:</span> eof
<span class="line_number">3455 </span>    character<span class="sign">(</span>len<span class="sign">=</span>1<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> c
<span class="line_number">3456 </span>
<span class="line_number">3457 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">3458 </span>
<span class="line_number">3459 </span>        <span class="sign">!</span>the routine is being called incorrectly<span class="sign">.</span>
<span class="line_number">3460 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> associated<span class="sign">(</span>parent<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3461 </span>            call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_object</strong>: parent pointer not associated.'</span><span class="sign">)</span>
<span class="line_number">3462 </span>        end if
<span class="line_number">3463 </span>
<span class="line_number">3464 </span>        nullify<span class="sign">(</span>pair<span class="sign">)</span>    <span class="sign">!</span>probably not necessary
<span class="line_number">3465 </span>
<span class="line_number">3466 </span>        <span class="sign">!</span> pair name
<span class="line_number">3467 </span>        c <span class="sign">=</span> <a href="#robo58">pop_char</a><span class="sign">(</span>unit<span class="sign">,</span> eof <span class="sign">=</span> eof<span class="sign">,</span> skip_ws <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span><span class="sign">)</span>
<span class="line_number">3468 </span>        if <span class="sign">(</span>eof<span class="sign">)</span> then
<span class="line_number">3469 </span>            call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_object</strong>: Unexpected end of file while parsing start of object.'</span><span class="sign">)</span>
<span class="line_number">3470 </span>            call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3471 </span>            return
<span class="line_number">3472 </span>        else if <span class="sign">(</span><span class="squote">'}'</span> <span class="sign">=</span><span class="sign">=</span> c<span class="sign">)</span> then
<span class="line_number">3473 </span>            <span class="sign">!</span> end of an empty object
<span class="line_number">3474 </span>            call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3475 </span>            return
<span class="line_number">3476 </span>        else if <span class="sign">(</span><span class="squote">'"'</span> <span class="sign">=</span><span class="sign">=</span> c<span class="sign">)</span> then
<span class="line_number">3477 </span>            call <a href="#robo47">json_value_create</a><span class="sign">(</span>pair<span class="sign">)</span>
<span class="line_number">3478 </span>            call <a href="#robo56">parse_string</a><span class="sign">(</span>unit<span class="sign">,</span> pair <span class="sign">%</span> name<span class="sign">)</span>
<span class="line_number">3479 </span>            if <span class="sign">(</span>exception_thrown<span class="sign">)</span> return
<span class="line_number">3480 </span>        else
<span class="line_number">3481 </span>            call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_object</strong>: Expecting string: "'</span><span class="sign">/</span><span class="sign">/</span>c<span class="sign">/</span><span class="sign">/</span><span class="squote">'"'</span><span class="sign">)</span>
<span class="line_number">3482 </span>            call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3483 </span>            return
<span class="line_number">3484 </span>        end if
<span class="line_number">3485 </span>
<span class="line_number">3486 </span>        <span class="sign">!</span> pair value
<span class="line_number">3487 </span>        c <span class="sign">=</span> <a href="#robo58">pop_char</a><span class="sign">(</span>unit<span class="sign">,</span> eof <span class="sign">=</span> eof<span class="sign">,</span> skip_ws <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span><span class="sign">)</span>
<span class="line_number">3488 </span>        if <span class="sign">(</span>eof<span class="sign">)</span> then
<span class="line_number">3489 </span>            call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_object</strong>: Unexpected end of file while parsing object member.'</span><span class="sign">)</span>
<span class="line_number">3490 </span>            call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3491 </span>            return
<span class="line_number">3492 </span>        else if <span class="sign">(</span><span class="squote">':'</span> <span class="sign">=</span><span class="sign">=</span> c<span class="sign">)</span> then
<span class="line_number">3493 </span>            <span class="sign">!</span> parse the value
<span class="line_number">3494 </span>            call <a href="#robo57">parse_value</a><span class="sign">(</span>unit<span class="sign">,</span> pair<span class="sign">)</span>
<span class="line_number">3495 </span>            if <span class="sign">(</span>exception_thrown<span class="sign">)</span> return
<span class="line_number">3496 </span>            call json_value_add<span class="sign">(</span>parent<span class="sign">,</span> pair<span class="sign">)</span>
<span class="line_number">3497 </span>        else
<span class="line_number">3498 </span>            call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_object</strong>: Expecting : and then a value: '</span><span class="sign">/</span><span class="sign">/</span>c<span class="sign">)</span>
<span class="line_number">3499 </span>            call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3500 </span>            return
<span class="line_number">3501 </span>        end if
<span class="line_number">3502 </span>
<span class="line_number">3503 </span>        <span class="sign">!</span> another possible pair
<span class="line_number">3504 </span>        c <span class="sign">=</span> <a href="#robo58">pop_char</a><span class="sign">(</span>unit<span class="sign">,</span> eof <span class="sign">=</span> eof<span class="sign">,</span> skip_ws <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span><span class="sign">)</span>
<span class="line_number">3505 </span>        if <span class="sign">(</span>eof<span class="sign">)</span> then
<span class="line_number">3506 </span>            call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3507 </span>            return
<span class="line_number">3508 </span>        else if <span class="sign">(</span><span class="squote">','</span> <span class="sign">=</span><span class="sign">=</span> c<span class="sign">)</span> then
<span class="line_number">3509 </span>            <span class="sign">!</span> read the next member
<span class="line_number">3510 </span>            call <strong>parse_object</strong><span class="sign">(</span>unit <span class="sign">=</span> unit<span class="sign">,</span> parent <span class="sign">=</span> parent<span class="sign">)</span>
<span class="line_number">3511 </span>        else if <span class="sign">(</span><span class="squote">'}'</span> <span class="sign">=</span><span class="sign">=</span> c<span class="sign">)</span> then
<span class="line_number">3512 </span>            call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3513 </span>            return
<span class="line_number">3514 </span>        else
<span class="line_number">3515 </span>            call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_object</strong>: Expecting end of object: '</span><span class="sign">/</span><span class="sign">/</span>c<span class="sign">)</span>
<span class="line_number">3516 </span>            call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3517 </span>            return
<span class="line_number">3518 </span>        end if
<span class="line_number">3519 </span>
<span class="line_number">3520 </span>        call cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3521 </span>
<span class="line_number">3522 </span>    end if
<span class="line_number">3523 </span>
<span class="line_number">3524 </span>    contains
<span class="line_number">3525 </span>
<span class="line_number">3526 </span>        <span class="sign">!</span>cleanup routine<span class="sign">:</span>
<span class="line_number">3527 </span>        subroutine cleanup<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3528 </span>        
<span class="line_number">3529 </span>        implicit none
<span class="line_number">3530 </span>
<span class="line_number">3531 </span>        if <span class="sign">(</span>associated<span class="sign">(</span>pair<span class="sign">)</span><span class="sign">)</span> nullify<span class="sign">(</span>pair<span class="sign">)</span>
<span class="line_number">3532 </span>
<span class="line_number">3533 </span>        end subroutine cleanup
<span class="line_number">3534 </span>
<span class="line_number">3535 </span>    end subroutine <strong>parse_object</strong>
</pre>

<hr />
<a name="json5fmodule2fparse5fstring"></a>
<a name="robo56"></a><h2>json_module/parse_string [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>parse_string</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Parses a string while reading a json file
</pre>
<p class="item_name">HISTORY</p>
<pre>    JW : 6/16/2014 : added hex validation.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3607 </span>    subroutine <strong>parse_string</strong><span class="sign">(</span>unit<span class="sign">,</span> string<span class="sign">)</span>
<span class="line_number">3608 </span>
<span class="line_number">3609 </span>    implicit none
<span class="line_number">3610 </span>
<span class="line_number">3611 </span>    integer<span class="sign">,</span> intent<span class="sign">(</span>in<span class="sign">)</span>                      <span class="sign">:</span><span class="sign">:</span> unit
<span class="line_number">3612 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">:</span><span class="sign">)</span><span class="sign">,</span>allocatable<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> string
<span class="line_number">3613 </span>
<span class="line_number">3614 </span>    logical <span class="sign">:</span><span class="sign">:</span> eof<span class="sign">,</span> is_hex<span class="sign">,</span> escape
<span class="line_number">3615 </span>    character<span class="sign">(</span>len<span class="sign">=</span>1<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> c<span class="sign">,</span> last
<span class="line_number">3616 </span>    character<span class="sign">(</span>len<span class="sign">=</span>4<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> hex
<span class="line_number">3617 </span>    integer <span class="sign">:</span><span class="sign">:</span> i
<span class="line_number">3618 </span>
<span class="line_number">3619 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">3620 </span>
<span class="line_number">3621 </span>        <span class="sign">!</span>initialize<span class="sign">:</span>
<span class="line_number">3622 </span>        string <span class="sign">=</span> <span class="squote">''</span> 
<span class="line_number">3623 </span>        last <span class="sign">=</span> space
<span class="line_number">3624 </span>        is_hex <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">3625 </span>        escape <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">3626 </span>        i <span class="sign">=</span> 0
<span class="line_number">3627 </span>        
<span class="line_number">3628 </span>        do
<span class="line_number">3629 </span>        
<span class="line_number">3630 </span>            <span class="sign">!</span>get the next character from the file<span class="sign">:</span>
<span class="line_number">3631 </span>            c <span class="sign">=</span> <a href="#robo58">pop_char</a><span class="sign">(</span>unit<span class="sign">,</span> eof <span class="sign">=</span> eof<span class="sign">,</span> skip_ws <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span><span class="sign">)</span>
<span class="line_number">3632 </span>        
<span class="line_number">3633 </span>            if <span class="sign">(</span>eof<span class="sign">)</span> then
<span class="line_number">3634 </span>            
<span class="line_number">3635 </span>                call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_string</strong>: Expecting end of string'</span><span class="sign">)</span>
<span class="line_number">3636 </span>                return
<span class="line_number">3637 </span>                
<span class="line_number">3638 </span>            else if <span class="sign">(</span><span class="squote">'"'</span> <span class="sign">=</span><span class="sign">=</span> c <span class="sign">.</span>and<span class="sign">.</span> last <span class="sign">/</span><span class="sign">=</span> backslash<span class="sign">)</span> then
<span class="line_number">3639 </span>            
<span class="line_number">3640 </span>                if <span class="sign">(</span>is_hex<span class="sign">)</span> call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_string</strong>: incomplete hex string: \u'</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>hex<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">3641 </span>                exit
<span class="line_number">3642 </span>                    
<span class="line_number">3643 </span>            else
<span class="line_number">3644 </span>            
<span class="line_number">3645 </span>                <span class="sign">!</span>append to string<span class="sign">:</span>
<span class="line_number">3646 </span>                string <span class="sign">=</span> string<span class="sign">/</span><span class="sign">/</span>c    
<span class="line_number">3647 </span>                
<span class="line_number">3648 </span>                <span class="sign">!</span>hex validation<span class="sign">:</span>
<span class="line_number">3649 </span>                if <span class="sign">(</span>is_hex<span class="sign">)</span> then  <span class="sign">!</span>accumulate the four characters after <span class="squote">'\u'</span>
<span class="line_number">3650 </span>                    
<span class="line_number">3651 </span>                    i<span class="sign">=</span>i<span class="sign">+</span>1
<span class="line_number">3652 </span>                    hex<span class="sign">(</span>i<span class="sign">:</span>i<span class="sign">)</span> <span class="sign">=</span> c
<span class="line_number">3653 </span>                    if <span class="sign">(</span>i<span class="sign">=</span><span class="sign">=</span>4<span class="sign">)</span> then
<span class="line_number">3654 </span>                        if <span class="sign">(</span><a href="#robo72">valid_json_hex</a><span class="sign">(</span>hex<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3655 </span>                            i <span class="sign">=</span> 0
<span class="line_number">3656 </span>                            hex <span class="sign">=</span> <span class="squote">''</span>
<span class="line_number">3657 </span>                            is_hex <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>                            
<span class="line_number">3658 </span>                        else
<span class="line_number">3659 </span>                            call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_string</strong>: invalid hex string: \u'</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>hex<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">3660 </span>                            exit
<span class="line_number">3661 </span>                        end if
<span class="line_number">3662 </span>                    end if
<span class="line_number">3663 </span>                    
<span class="line_number">3664 </span>                else
<span class="line_number">3665 </span>                    
<span class="line_number">3666 </span>                    <span class="sign">!</span>when the <span class="squote">'\u'</span> string is encountered<span class="sign">,</span> then
<span class="line_number">3667 </span>                    <span class="sign">!</span>  start accumulating the hex string <span class="sign">(</span>should be the next 4 characters<span class="sign">)</span>
<span class="line_number">3668 </span>                    if <span class="sign">(</span>escape<span class="sign">)</span> then
<span class="line_number">3669 </span>                        escape <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">3670 </span>                        is_hex <span class="sign">=</span> <span class="sign">(</span>c<span class="sign">=</span><span class="sign">=</span><span class="squote">'u'</span><span class="sign">)</span>    <span class="sign">!</span>the next four characters are the hex string
<span class="line_number">3671 </span>                    else
<span class="line_number">3672 </span>                        escape <span class="sign">=</span> <span class="sign">(</span>c<span class="sign">=</span><span class="sign">=</span>backslash<span class="sign">)</span>
<span class="line_number">3673 </span>                    end if
<span class="line_number">3674 </span>                    
<span class="line_number">3675 </span>                end if
<span class="line_number">3676 </span>                
<span class="line_number">3677 </span>                <span class="sign">!</span>update for next char<span class="sign">:</span>
<span class="line_number">3678 </span>                last <span class="sign">=</span> c
<span class="line_number">3679 </span>                
<span class="line_number">3680 </span>            end if
<span class="line_number">3681 </span>            
<span class="line_number">3682 </span>        end do
<span class="line_number">3683 </span>
<span class="line_number">3684 </span>    end if
<span class="line_number">3685 </span>
<span class="line_number">3686 </span>    end subroutine <strong>parse_string</strong>
</pre>

<hr />
<a name="json5fmodule2fparse5fvalue"></a>
<a name="robo57"></a><h2>json_module/parse_value [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>parse_value</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3087 </span>    recursive subroutine <strong>parse_value</strong><span class="sign">(</span>unit<span class="sign">,</span> value<span class="sign">)</span>
<span class="line_number">3088 </span>
<span class="line_number">3089 </span>    implicit none
<span class="line_number">3090 </span>
<span class="line_number">3091 </span>    integer<span class="sign">,</span> intent<span class="sign">(</span>in<span class="sign">)</span>       <span class="sign">:</span><span class="sign">:</span> unit
<span class="line_number">3092 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> pointer <span class="sign">:</span><span class="sign">:</span> value
<span class="line_number">3093 </span>
<span class="line_number">3094 </span>    logical <span class="sign">:</span><span class="sign">:</span> eof
<span class="line_number">3095 </span>    character<span class="sign">(</span>len<span class="sign">=</span>1<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> c
<span class="line_number">3096 </span>
<span class="line_number">3097 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">3098 </span>
<span class="line_number">3099 </span>        <span class="sign">!</span>the routine is being called incorrectly<span class="sign">.</span>
<span class="line_number">3100 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> associated<span class="sign">(</span>value<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3101 </span>            call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_value</strong>: value pointer not associated.'</span><span class="sign">)</span>
<span class="line_number">3102 </span>        end if
<span class="line_number">3103 </span>
<span class="line_number">3104 </span>        <span class="sign">!</span> pop the next non whitespace character off the file
<span class="line_number">3105 </span>        c <span class="sign">=</span> <a href="#robo58">pop_char</a><span class="sign">(</span>unit<span class="sign">,</span> eof <span class="sign">=</span> eof<span class="sign">,</span> skip_ws <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span><span class="sign">)</span>
<span class="line_number">3106 </span>
<span class="line_number">3107 </span>        if <span class="sign">(</span>eof<span class="sign">)</span> then
<span class="line_number">3108 </span>            return
<span class="line_number">3109 </span>        else
<span class="line_number">3110 </span>            select case <span class="sign">(</span>c<span class="sign">)</span>
<span class="line_number">3111 </span>            case <span class="sign">(</span><span class="squote">'{'</span><span class="sign">)</span>
<span class="line_number">3112 </span>
<span class="line_number">3113 </span>                <span class="sign">!</span> start object
<span class="line_number">3114 </span>                call <a href="#robo69">to_object</a><span class="sign">(</span>value<span class="sign">)</span>    <span class="sign">!</span>allocate class
<span class="line_number">3115 </span>                call <a href="#robo55">parse_object</a><span class="sign">(</span>unit<span class="sign">,</span> value<span class="sign">)</span>
<span class="line_number">3116 </span>
<span class="line_number">3117 </span>            case <span class="sign">(</span><span class="squote">'['</span><span class="sign">)</span>
<span class="line_number">3118 </span>
<span class="line_number">3119 </span>                <span class="sign">!</span> start array
<span class="line_number">3120 </span>                call <a href="#robo65">to_array</a><span class="sign">(</span>value<span class="sign">)</span>    <span class="sign">!</span>allocate class
<span class="line_number">3121 </span>                call <a href="#robo52">parse_array</a><span class="sign">(</span>unit<span class="sign">,</span> value<span class="sign">)</span>
<span class="line_number">3122 </span>
<span class="line_number">3123 </span>            case <span class="sign">(</span><span class="squote">']'</span><span class="sign">)</span>
<span class="line_number">3124 </span>
<span class="line_number">3125 </span>                <span class="sign">!</span> end an empty array
<span class="line_number">3126 </span>                call <a href="#robo60">push_char</a><span class="sign">(</span>c<span class="sign">)</span>
<span class="line_number">3127 </span>                nullify<span class="sign">(</span>value<span class="sign">)</span>
<span class="line_number">3128 </span>
<span class="line_number">3129 </span>            case <span class="sign">(</span><span class="squote">'"'</span><span class="sign">)</span>
<span class="line_number">3130 </span>
<span class="line_number">3131 </span>                <span class="sign">!</span> string
<span class="line_number">3132 </span>                call <a href="#robo71">to_string</a><span class="sign">(</span>value<span class="sign">)</span>    <span class="sign">!</span>allocate class
<span class="line_number">3133 </span>
<span class="line_number">3134 </span>                 <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> value<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3135 </span>                    <span class="sign">!</span>select type <span class="sign">(</span>value<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3136 </span>                    select case <span class="sign">(</span>value<span class="sign">%</span>data<span class="sign">%</span>var_type<span class="sign">)</span>
<span class="line_number">3137 </span>                    <span class="sign">!</span>type is <span class="sign">(</span>json_string<span class="sign">)</span>
<span class="line_number">3138 </span>                    case <span class="sign">(</span>json_string<span class="sign">)</span>
<span class="line_number">3139 </span>                        call <a href="#robo56">parse_string</a><span class="sign">(</span>unit<span class="sign">,</span> value<span class="sign">%</span>data<span class="sign">%</span>str_value<span class="sign">)</span>
<span class="line_number">3140 </span>                    end select
<span class="line_number">3141 </span>                <span class="sign">!</span>end associate
<span class="line_number">3142 </span>
<span class="line_number">3143 </span>            case <span class="sign">(</span><span class="squote">'t'</span><span class="sign">)</span>
<span class="line_number">3144 </span>
<span class="line_number">3145 </span>                <span class="sign">!</span>true
<span class="line_number">3146 </span>                call <a href="#robo53">parse_for_chars</a><span class="sign">(</span>unit<span class="sign">,</span> <span class="squote">'rue'</span><span class="sign">)</span>
<span class="line_number">3147 </span>                if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> call <a href="#robo67">to_logical</a><span class="sign">(</span>value<span class="sign">,</span><span class="sign">.</span>true<span class="sign">.</span><span class="sign">)</span>    <span class="sign">!</span>allocate class and set value
<span class="line_number">3148 </span>
<span class="line_number">3149 </span>            case <span class="sign">(</span><span class="squote">'f'</span><span class="sign">)</span>
<span class="line_number">3150 </span>
<span class="line_number">3151 </span>                <span class="sign">!</span>false
<span class="line_number">3152 </span>                call <a href="#robo53">parse_for_chars</a><span class="sign">(</span>unit<span class="sign">,</span> <span class="squote">'alse'</span><span class="sign">)</span>
<span class="line_number">3153 </span>                if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> call <a href="#robo67">to_logical</a><span class="sign">(</span>value<span class="sign">,</span><span class="sign">.</span>false<span class="sign">.</span><span class="sign">)</span>    <span class="sign">!</span>allocate class and set value
<span class="line_number">3154 </span>
<span class="line_number">3155 </span>            case <span class="sign">(</span><span class="squote">'n'</span><span class="sign">)</span>
<span class="line_number">3156 </span>
<span class="line_number">3157 </span>                call <a href="#robo53">parse_for_chars</a><span class="sign">(</span>unit<span class="sign">,</span> <span class="squote">'ull'</span><span class="sign">)</span>
<span class="line_number">3158 </span>                if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> call <a href="#robo68">to_null</a><span class="sign">(</span>value<span class="sign">)</span>    <span class="sign">!</span>allocate class
<span class="line_number">3159 </span>
<span class="line_number">3160 </span>            case<span class="sign">(</span><span class="squote">'-'</span><span class="sign">,</span> <span class="squote">'0'</span><span class="sign">:</span> <span class="squote">'9'</span><span class="sign">)</span>
<span class="line_number">3161 </span>
<span class="line_number">3162 </span>                call <a href="#robo60">push_char</a><span class="sign">(</span>c<span class="sign">)</span>
<span class="line_number">3163 </span>                call <a href="#robo54">parse_number</a><span class="sign">(</span>unit<span class="sign">,</span> value<span class="sign">)</span>
<span class="line_number">3164 </span>
<span class="line_number">3165 </span>            case default
<span class="line_number">3166 </span>
<span class="line_number">3167 </span>                call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>parse_value</strong>: Unexpected character while parsing value. "'</span><span class="sign">/</span><span class="sign">/</span>c<span class="sign">/</span><span class="sign">/</span><span class="squote">'"'</span><span class="sign">)</span>
<span class="line_number">3168 </span>
<span class="line_number">3169 </span>            end select
<span class="line_number">3170 </span>        end if
<span class="line_number">3171 </span>
<span class="line_number">3172 </span>    end if
<span class="line_number">3173 </span>
<span class="line_number">3174 </span>    end subroutine <strong>parse_value</strong>
</pre>

<hr />
<a name="json5fmodule2fpop5fchar"></a>
<a name="robo58"></a><h2>json_module/pop_char [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>pop_char</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Get the next character from the file.
</pre>
<p class="item_name">NOTES</p>
<pre>    This routine ignores non-printing ascii characters (iachar&lt;=31) that
    are in strings.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3847 </span>    recursive function <strong>pop_char</strong><span class="sign">(</span>unit<span class="sign">,</span> eof<span class="sign">,</span> skip_ws<span class="sign">)</span> result<span class="sign">(</span>popped<span class="sign">)</span>
<span class="line_number">3848 </span>    
<span class="line_number">3849 </span>    implicit none
<span class="line_number">3850 </span>
<span class="line_number">3851 </span>    character<span class="sign">(</span>len<span class="sign">=</span>1<span class="sign">)</span>              <span class="sign">:</span><span class="sign">:</span> popped
<span class="line_number">3852 </span>    integer<span class="sign">,</span> intent<span class="sign">(</span>in<span class="sign">)</span>           <span class="sign">:</span><span class="sign">:</span> unit
<span class="line_number">3853 </span>    logical<span class="sign">,</span> intent<span class="sign">(</span>out<span class="sign">)</span>          <span class="sign">:</span><span class="sign">:</span> eof
<span class="line_number">3854 </span>    logical<span class="sign">,</span> intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span> optional <span class="sign">:</span><span class="sign">:</span> skip_ws
<span class="line_number">3855 </span>
<span class="line_number">3856 </span>    integer <span class="sign">:</span><span class="sign">:</span> ios
<span class="line_number">3857 </span>    character<span class="sign">(</span>len<span class="sign">=</span>1<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> c
<span class="line_number">3858 </span>    logical <span class="sign">:</span><span class="sign">:</span> ignore
<span class="line_number">3859 </span>
<span class="line_number">3860 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">3861 </span>
<span class="line_number">3862 </span>        eof <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">3863 </span>        if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span>present<span class="sign">(</span>skip_ws<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3864 </span>            ignore <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>
<span class="line_number">3865 </span>        else
<span class="line_number">3866 </span>            ignore <span class="sign">=</span> skip_ws
<span class="line_number">3867 </span>        end if
<span class="line_number">3868 </span>
<span class="line_number">3869 </span>        do
<span class="line_number">3870 </span>
<span class="line_number">3871 </span>            if <span class="sign">(</span>pushed_index <span class="sign">&gt;</span> 0<span class="sign">)</span> then
<span class="line_number">3872 </span>
<span class="line_number">3873 </span>                <span class="sign">!</span> there is a character pushed back on<span class="sign">,</span> most likely from the number parsing
<span class="line_number">3874 </span>                c <span class="sign">=</span> pushed_char<span class="sign">(</span>pushed_index<span class="sign">:</span>pushed_index<span class="sign">)</span>
<span class="line_number">3875 </span>                pushed_index <span class="sign">=</span> pushed_index <span class="sign">-</span> 1
<span class="line_number">3876 </span>
<span class="line_number">3877 </span>            else
<span class="line_number">3878 </span>
<span class="line_number">3879 </span>                read <span class="sign">(</span>unit <span class="sign">=</span> unit<span class="sign">,</span> fmt <span class="sign">=</span> <span class="squote">'(A)'</span><span class="sign">,</span> advance <span class="sign">=</span> <span class="squote">'NO'</span><span class="sign">,</span> iostat <span class="sign">=</span> ios<span class="sign">)</span> c
<span class="line_number">3880 </span>                char_count <span class="sign">=</span> char_count <span class="sign">+</span> 1    <span class="sign">!</span>character count in the current line
<span class="line_number">3881 </span>
<span class="line_number">3882 </span>                if <span class="sign">(</span>IS_IOSTAT_EOR<span class="sign">(</span>ios<span class="sign">)</span><span class="sign">)</span> then            <span class="sign">!</span>JW <span class="sign">:</span> use intrinsic
<span class="line_number">3883 </span>
<span class="line_number">3884 </span>                    char_count <span class="sign">=</span> 0
<span class="line_number">3885 </span>                    line_count <span class="sign">=</span> line_count <span class="sign">+</span> 1
<span class="line_number">3886 </span>                    cycle
<span class="line_number">3887 </span>
<span class="line_number">3888 </span>                else if <span class="sign">(</span>IS_IOSTAT_END<span class="sign">(</span>ios<span class="sign">)</span><span class="sign">)</span> then        <span class="sign">!</span>JW <span class="sign">:</span> use intrinsic
<span class="line_number">3889 </span>
<span class="line_number">3890 </span>                    char_count <span class="sign">=</span> 0
<span class="line_number">3891 </span>                    eof <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">3892 </span>                    exit
<span class="line_number">3893 </span>
<span class="line_number">3894 </span>                end if
<span class="line_number">3895 </span>
<span class="line_number">3896 </span>            end if
<span class="line_number">3897 </span>
<span class="line_number">3898 </span>            if <span class="sign">(</span>iachar<span class="sign">(</span>c<span class="sign">)</span> <span class="sign">&lt;</span><span class="sign">=</span> 31<span class="sign">)</span> then            <span class="sign">!</span>JW <span class="sign">:</span> fixed so it will read spaces in the string <span class="sign">(</span>was 32<span class="sign">)</span>
<span class="line_number">3899 </span>
<span class="line_number">3900 </span>                <span class="sign">!</span> non printing ascii characters
<span class="line_number">3901 </span>                cycle
<span class="line_number">3902 </span>
<span class="line_number">3903 </span>            else if <span class="sign">(</span>ignore <span class="sign">.</span>and<span class="sign">.</span> c <span class="sign">=</span><span class="sign">=</span> space<span class="sign">)</span> then
<span class="line_number">3904 </span>
<span class="line_number">3905 </span>                cycle
<span class="line_number">3906 </span>
<span class="line_number">3907 </span>            else
<span class="line_number">3908 </span>
<span class="line_number">3909 </span>                popped <span class="sign">=</span> c
<span class="line_number">3910 </span>                exit
<span class="line_number">3911 </span>
<span class="line_number">3912 </span>            end if
<span class="line_number">3913 </span>
<span class="line_number">3914 </span>        end do
<span class="line_number">3915 </span>
<span class="line_number">3916 </span>    end if
<span class="line_number">3917 </span>
<span class="line_number">3918 </span>    end function <strong>pop_char</strong>
</pre>

<hr />
<a name="json5fmodule2fprint5fjson5ffile"></a>
<a name="robo59"></a><h2>json_module/print_json_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>print_json_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%print_file()
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Print the JSON file.
    Prints to the specified file unit (if not present, then prints to the console)
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/9/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">436 </span>    subroutine <strong>print_json_file</strong><span class="sign">(</span>me<span class="sign">,</span> iunit<span class="sign">)</span>
<span class="line_number">437 </span>
<span class="line_number">438 </span>    use<span class="sign">,</span> intrinsic <span class="sign">:</span><span class="sign">:</span> iso_fortran_env<span class="sign">,</span>    only<span class="sign">:</span> output_unit
<span class="line_number">439 </span>
<span class="line_number">440 </span>    implicit none
<span class="line_number">441 </span>
<span class="line_number">442 </span>    class<span class="sign">(</span><a href="#robo22">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">443 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional <span class="sign">:</span><span class="sign">:</span> iunit
<span class="line_number">444 </span>
<span class="line_number">445 </span>    integer <span class="sign">:</span><span class="sign">:</span> i
<span class="line_number">446 </span>
<span class="line_number">447 </span>    if <span class="sign">(</span>present<span class="sign">(</span>iunit<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">448 </span>        i <span class="sign">=</span> iunit
<span class="line_number">449 </span>    else
<span class="line_number">450 </span>        i <span class="sign">=</span> output_unit
<span class="line_number">451 </span>    end if
<span class="line_number">452 </span>
<span class="line_number">453 </span>    call <a href="#robo49">json_value_print</a><span class="sign">(</span>me<span class="sign">%</span>p<span class="sign">,</span>iunit<span class="sign">=</span>i<span class="sign">)</span>
<span class="line_number">454 </span>
<span class="line_number">455 </span>    end subroutine <strong>print_json_file</strong>
</pre>

<hr />
<a name="json5fmodule2fpush5fchar"></a>
<a name="robo60"></a><h2>json_module/push_char [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>push_char</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3932 </span>    subroutine <strong>push_char</strong><span class="sign">(</span>c<span class="sign">)</span>
<span class="line_number">3933 </span>    
<span class="line_number">3934 </span>    implicit none
<span class="line_number">3935 </span>
<span class="line_number">3936 </span>    character<span class="sign">(</span>len<span class="sign">=</span>1<span class="sign">)</span><span class="sign">,</span> intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> c
<span class="line_number">3937 </span>
<span class="line_number">3938 </span>    character<span class="sign">(</span>len<span class="sign">=</span>32<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> istr
<span class="line_number">3939 </span>
<span class="line_number">3940 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">3941 </span>
<span class="line_number">3942 </span>        pushed_index <span class="sign">=</span> pushed_index <span class="sign">+</span> 1
<span class="line_number">3943 </span>
<span class="line_number">3944 </span>        if <span class="sign">(</span>pushed_index<span class="sign">&gt;</span>0 <span class="sign">.</span>and<span class="sign">.</span> pushed_index<span class="sign">&lt;</span><span class="sign">=</span>len<span class="sign">(</span>pushed_char<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3945 </span>            pushed_char<span class="sign">(</span>pushed_index<span class="sign">:</span>pushed_index<span class="sign">)</span> <span class="sign">=</span> c
<span class="line_number">3946 </span>        else
<span class="line_number">3947 </span>            call <a href="#robo17">integer_to_string</a><span class="sign">(</span>pushed_index<span class="sign">,</span>istr<span class="sign">)</span>
<span class="line_number">3948 </span>            call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>push_char</strong>: invalid valid of pushed_index: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>istr<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">3949 </span>        end if
<span class="line_number">3950 </span>
<span class="line_number">3951 </span>    end if
<span class="line_number">3952 </span>
<span class="line_number">3953 </span>    end subroutine <strong>push_char</strong>
</pre>

<hr />
<a name="json5fmodule2freal5fto5fstring"></a>
<a name="robo61"></a><h2>json_module/real_to_string [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>real_to_string</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Convert a real value to a string.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/4/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">4004 </span>    subroutine <strong>real_to_string</strong><span class="sign">(</span>rval<span class="sign">,</span>str<span class="sign">)</span>
<span class="line_number">4005 </span>
<span class="line_number">4006 </span>    implicit none
<span class="line_number">4007 </span>
<span class="line_number">4008 </span>    real<span class="sign">(</span>wp<span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>          <span class="sign">:</span><span class="sign">:</span> rval
<span class="line_number">4009 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> str
<span class="line_number">4010 </span>
<span class="line_number">4011 </span>    integer <span class="sign">:</span><span class="sign">:</span> istat
<span class="line_number">4012 </span>
<span class="line_number">4013 </span>    write<span class="sign">(</span>str<span class="sign">,</span>fmt<span class="sign">=</span>real_fmt<span class="sign">,</span>iostat<span class="sign">=</span>istat<span class="sign">)</span> rval
<span class="line_number">4014 </span>
<span class="line_number">4015 </span>    if <span class="sign">(</span>istat<span class="sign">=</span><span class="sign">=</span>0<span class="sign">)</span> then
<span class="line_number">4016 </span>        str <span class="sign">=</span> adjustl<span class="sign">(</span>str<span class="sign">)</span>
<span class="line_number">4017 </span>    else
<span class="line_number">4018 </span>        str <span class="sign">=</span> repeat<span class="sign">(</span><span class="squote">'*'</span><span class="sign">,</span>len<span class="sign">(</span>str<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">4019 </span>    end if
<span class="line_number">4020 </span>
<span class="line_number">4021 </span>    end subroutine <strong>real_to_string</strong>
</pre>

<hr />
<a name="json5fmodule2fstring5fto5fdouble"></a>
<a name="robo62"></a><h2>json_module/string_to_double [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>string_to_double</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Convert a string into a double.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 1/19/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2155 </span>    function <strong>string_to_double</strong><span class="sign">(</span>str<span class="sign">)</span> result<span class="sign">(</span>rval<span class="sign">)</span>
<span class="line_number">2156 </span>
<span class="line_number">2157 </span>    implicit none
<span class="line_number">2158 </span>
<span class="line_number">2159 </span>    real<span class="sign">(</span>wp<span class="sign">)</span>                    <span class="sign">:</span><span class="sign">:</span> rval
<span class="line_number">2160 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> str
<span class="line_number">2161 </span>
<span class="line_number">2162 </span>    integer <span class="sign">:</span><span class="sign">:</span> ierr
<span class="line_number">2163 </span>
<span class="line_number">2164 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">2165 </span>
<span class="line_number">2166 </span>        read<span class="sign">(</span>str<span class="sign">,</span>fmt<span class="sign">=</span>real_fmt<span class="sign">,</span>iostat<span class="sign">=</span>ierr<span class="sign">)</span> rval    <span class="sign">!</span>string to double
<span class="line_number">2167 </span>
<span class="line_number">2168 </span>        if <span class="sign">(</span>ierr<span class="sign">/</span><span class="sign">=</span>0<span class="sign">)</span> then    <span class="sign">!</span>if there was an error
<span class="line_number">2169 </span>            rval <span class="sign">=</span> 0<span class="sign">.</span>0_wp
<span class="line_number">2170 </span>            call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>string_to_double</strong>: string cannot be converted to a double: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>str<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2171 </span>        end if
<span class="line_number">2172 </span>
<span class="line_number">2173 </span>    end if
<span class="line_number">2174 </span>
<span class="line_number">2175 </span>    end function <strong>string_to_double</strong>
</pre>

<hr />
<a name="json5fmodule2fstring5fto5finteger"></a>
<a name="robo63"></a><h2>json_module/string_to_integer [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>string_to_integer</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Convert a string into an integer.
</pre>
<p class="item_name">NOTES</p>
<pre>    Replacement for the parse_integer function in the original code.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/10/2013 : Rewrote routine.  Added error checking.
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">2118 </span>    function <strong>string_to_integer</strong><span class="sign">(</span>str<span class="sign">)</span> result<span class="sign">(</span>ival<span class="sign">)</span>
<span class="line_number">2119 </span>
<span class="line_number">2120 </span>    implicit none
<span class="line_number">2121 </span>
<span class="line_number">2122 </span>    integer                     <span class="sign">:</span><span class="sign">:</span> ival
<span class="line_number">2123 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> str
<span class="line_number">2124 </span>
<span class="line_number">2125 </span>    integer <span class="sign">:</span><span class="sign">:</span> ierr
<span class="line_number">2126 </span>
<span class="line_number">2127 </span>    if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> exception_thrown<span class="sign">)</span> then
<span class="line_number">2128 </span>
<span class="line_number">2129 </span>        read<span class="sign">(</span>str<span class="sign">,</span><span class="sign">*</span><span class="sign">,</span>iostat<span class="sign">=</span>ierr<span class="sign">)</span> ival        <span class="sign">!</span>string to integer
<span class="line_number">2130 </span>
<span class="line_number">2131 </span>        if <span class="sign">(</span>ierr<span class="sign">/</span><span class="sign">=</span>0<span class="sign">)</span> then                   <span class="sign">!</span>if there was an error
<span class="line_number">2132 </span>            ival <span class="sign">=</span> 0
<span class="line_number">2133 </span>            call <a href="#robo64">throw_exception</a><span class="sign">(</span><span class="squote">'Error in <strong>string_to_integer</strong>: string cannot be converted to an integer: '</span><span class="sign">/</span><span class="sign">/</span>trim<span class="sign">(</span>str<span class="sign">)</span><span class="sign">)</span>
<span class="line_number">2134 </span>        end if
<span class="line_number">2135 </span>
<span class="line_number">2136 </span>    end if
<span class="line_number">2137 </span>
<span class="line_number">2138 </span>    end function <strong>string_to_integer</strong>
</pre>

<hr />
<a name="json5fmodule2fthrow5fexception"></a>
<a name="robo64"></a><h2>json_module/throw_exception [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>throw_exception</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Throw an exception in the JSON module.
    This routine sets the error flag, and prevents any subsequent routine
    from doing anything, until <a href="#robo19">json_clear_exceptions</a> is called.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 12/4/2013
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">897 </span>    subroutine <strong>throw_exception</strong><span class="sign">(</span>msg<span class="sign">)</span>
<span class="line_number">898 </span>
<span class="line_number">899 </span>    <span class="sign">!</span>use ifcore<span class="sign">,</span>    only<span class="sign">:</span> tracebackqq    <span class="sign">!</span>Intel routine
<span class="line_number">900 </span>
<span class="line_number">901 </span>    implicit none
<span class="line_number">902 </span>
<span class="line_number">903 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> msg    <span class="sign">!</span>the error message
<span class="line_number">904 </span>
<span class="line_number">905 </span>    exception_thrown <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>
<span class="line_number">906 </span>    err_message <span class="sign">=</span> trim<span class="sign">(</span>msg<span class="sign">)</span>
<span class="line_number">907 </span>
<span class="line_number">908 </span>    <span class="sign">!</span>if <span class="sign">(</span>print_tracebacks<span class="sign">)</span> then
<span class="line_number">909 </span>    <span class="sign">!</span>
<span class="line_number">910 </span>    <span class="sign">!</span>    <span class="sign">!</span>This is a feature of the Intel Fortran Compiler<span class="sign">:</span>
<span class="line_number">911 </span>    <span class="sign">!</span>    <span class="sign">!</span>Throw a traceback and return control to the user<span class="sign">.</span>
<span class="line_number">912 </span>    <span class="sign">!</span>    call tracebackqq<span class="sign">(</span>string<span class="sign">=</span>trim<span class="sign">(</span>msg<span class="sign">)</span><span class="sign">,</span> user_exit_code<span class="sign">=</span><span class="sign">-</span>1<span class="sign">)</span>
<span class="line_number">913 </span>    <span class="sign">!</span>
<span class="line_number">914 </span>    <span class="sign">!</span>    <span class="sign">!</span>write<span class="comment">(*,'(A)') trim(msg)        !gfortran version
<span class="line_number">915 </span>    !    !stop
<span class="line_number">916 </span>    !
<span class="line_number">917 </span>    !end if
<span class="line_number">918 </span>
<span class="line_number">919 </span>    end subroutine <strong>throw_exception</strong>
</pre>

<hr />
<a name="json5fmodule2fto5farray"></a>
<a name="robo65"></a><h2>json_module/to_array [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>to_array</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Change the variable to an array.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3416 </span>    subroutine <strong>to_array</strong><span class="sign">(</span>me<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">3417 </span>
<span class="line_number">3418 </span>    implicit none
<span class="line_number">3419 </span>
<span class="line_number">3420 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> intent<span class="sign">(</span>inout<span class="sign">)</span>        <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">3421 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional   <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">3422 </span>
<span class="line_number">3423 </span>    <span class="sign">!</span>set type and value<span class="sign">:</span>
<span class="line_number">3424 </span>    <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> me<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3425 </span>        call me<span class="sign">%</span>data<span class="sign">%</span>destroy<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3426 </span>        me<span class="sign">%</span>data<span class="sign">%</span>var_type <span class="sign">=</span> json_array
<span class="line_number">3427 </span>    <span class="sign">!</span>end associate
<span class="line_number">3428 </span>
<span class="line_number">3429 </span>    <span class="sign">!</span>name<span class="sign">:</span>
<span class="line_number">3430 </span>    if <span class="sign">(</span>present<span class="sign">(</span>name<span class="sign">)</span><span class="sign">)</span> me<span class="sign">%</span>name <span class="sign">=</span> trim<span class="sign">(</span>name<span class="sign">)</span>
<span class="line_number">3431 </span>
<span class="line_number">3432 </span>    end subroutine <strong>to_array</strong>
</pre>

<hr />
<a name="json5fmodule2fto5finteger"></a>
<a name="robo66"></a><h2>json_module/to_integer [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>to_integer</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Change the variable to an integer.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3231 </span>    subroutine <strong>to_integer</strong><span class="sign">(</span>me<span class="sign">,</span>val<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">3232 </span>
<span class="line_number">3233 </span>    implicit none
<span class="line_number">3234 </span>
<span class="line_number">3235 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> intent<span class="sign">(</span>inout<span class="sign">)</span>        <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">3236 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional   <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">3237 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional            <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">3238 </span>
<span class="line_number">3239 </span>    <span class="sign">!</span>set type and value<span class="sign">:</span>
<span class="line_number">3240 </span>    <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> me<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3241 </span>        call me<span class="sign">%</span>data<span class="sign">%</span>destroy<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3242 </span>        me<span class="sign">%</span>data<span class="sign">%</span>var_type <span class="sign">=</span> json_integer
<span class="line_number">3243 </span>        allocate<span class="sign">(</span>me<span class="sign">%</span>data<span class="sign">%</span>int_value<span class="sign">)</span>
<span class="line_number">3244 </span>        if <span class="sign">(</span>present<span class="sign">(</span>val<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3245 </span>            me<span class="sign">%</span>data<span class="sign">%</span>int_value <span class="sign">=</span> val
<span class="line_number">3246 </span>        else
<span class="line_number">3247 </span>            me<span class="sign">%</span>data<span class="sign">%</span>int_value <span class="sign">=</span> 0    <span class="sign">!</span>default value
<span class="line_number">3248 </span>        end if
<span class="line_number">3249 </span>    <span class="sign">!</span>end associate
<span class="line_number">3250 </span>
<span class="line_number">3251 </span>    <span class="sign">!</span>name<span class="sign">:</span>
<span class="line_number">3252 </span>    if <span class="sign">(</span>present<span class="sign">(</span>name<span class="sign">)</span><span class="sign">)</span> me<span class="sign">%</span>name <span class="sign">=</span> trim<span class="sign">(</span>name<span class="sign">)</span>
<span class="line_number">3253 </span>
<span class="line_number">3254 </span>    end subroutine <strong>to_integer</strong>
</pre>

<hr />
<a name="json5fmodule2fto5flogical"></a>
<a name="robo67"></a><h2>json_module/to_logical [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>to_logical</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Change the variable to a logical.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3191 </span>    subroutine <strong>to_logical</strong><span class="sign">(</span>me<span class="sign">,</span>val<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">3192 </span>
<span class="line_number">3193 </span>    implicit none
<span class="line_number">3194 </span>
<span class="line_number">3195 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> intent<span class="sign">(</span>inout<span class="sign">)</span>        <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">3196 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional   <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">3197 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional            <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">3198 </span>
<span class="line_number">3199 </span>    <span class="sign">!</span>set type and value<span class="sign">:</span>
<span class="line_number">3200 </span>    <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> me<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3201 </span>        call me<span class="sign">%</span>data<span class="sign">%</span>destroy<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3202 </span>        me<span class="sign">%</span>data<span class="sign">%</span>var_type <span class="sign">=</span> json_logical
<span class="line_number">3203 </span>        allocate<span class="sign">(</span>me<span class="sign">%</span>data<span class="sign">%</span>log_value<span class="sign">)</span>
<span class="line_number">3204 </span>        if <span class="sign">(</span>present<span class="sign">(</span>val<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3205 </span>            me<span class="sign">%</span>data<span class="sign">%</span>log_value <span class="sign">=</span> val
<span class="line_number">3206 </span>        else
<span class="line_number">3207 </span>            me<span class="sign">%</span>data<span class="sign">%</span>log_value <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>    <span class="sign">!</span>default value
<span class="line_number">3208 </span>        end if
<span class="line_number">3209 </span>    <span class="sign">!</span>end associate
<span class="line_number">3210 </span>
<span class="line_number">3211 </span>    <span class="sign">!</span>name<span class="sign">:</span>
<span class="line_number">3212 </span>    if <span class="sign">(</span>present<span class="sign">(</span>name<span class="sign">)</span><span class="sign">)</span> me<span class="sign">%</span>name <span class="sign">=</span> trim<span class="sign">(</span>name<span class="sign">)</span>
<span class="line_number">3213 </span>
<span class="line_number">3214 </span>    end subroutine <strong>to_logical</strong>
</pre>

<hr />
<a name="json5fmodule2fto5fnull"></a>
<a name="robo68"></a><h2>json_module/to_null [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>to_null</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Change the variable to a null.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3350 </span>    subroutine <strong>to_null</strong><span class="sign">(</span>me<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">3351 </span>
<span class="line_number">3352 </span>    implicit none
<span class="line_number">3353 </span>
<span class="line_number">3354 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> intent<span class="sign">(</span>inout<span class="sign">)</span>        <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">3355 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional   <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">3356 </span>
<span class="line_number">3357 </span>    <span class="sign">!</span>set type and value<span class="sign">:</span>
<span class="line_number">3358 </span>    <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> me<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3359 </span>        call me<span class="sign">%</span>data<span class="sign">%</span>destroy<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3360 </span>        me<span class="sign">%</span>data<span class="sign">%</span>var_type <span class="sign">=</span> json_null
<span class="line_number">3361 </span>    <span class="sign">!</span>end associate
<span class="line_number">3362 </span>
<span class="line_number">3363 </span>    <span class="sign">!</span>name<span class="sign">:</span>
<span class="line_number">3364 </span>    if <span class="sign">(</span>present<span class="sign">(</span>name<span class="sign">)</span><span class="sign">)</span> me<span class="sign">%</span>name <span class="sign">=</span> trim<span class="sign">(</span>name<span class="sign">)</span>
<span class="line_number">3365 </span>
<span class="line_number">3366 </span>    end subroutine <strong>to_null</strong>
</pre>

<hr />
<a name="json5fmodule2fto5fobject"></a>
<a name="robo69"></a><h2>json_module/to_object [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>to_object</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Change the variable to an object.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3383 </span>    subroutine <strong>to_object</strong><span class="sign">(</span>me<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">3384 </span>
<span class="line_number">3385 </span>    implicit none
<span class="line_number">3386 </span>
<span class="line_number">3387 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> intent<span class="sign">(</span>inout<span class="sign">)</span>        <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">3388 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional   <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">3389 </span>
<span class="line_number">3390 </span>    <span class="sign">!</span>set type and value<span class="sign">:</span>
<span class="line_number">3391 </span>    <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> me<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3392 </span>        call me<span class="sign">%</span>data<span class="sign">%</span>destroy<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3393 </span>        me<span class="sign">%</span>data<span class="sign">%</span>var_type <span class="sign">=</span> json_object
<span class="line_number">3394 </span>    <span class="sign">!</span>end associate
<span class="line_number">3395 </span>
<span class="line_number">3396 </span>    <span class="sign">!</span>name<span class="sign">:</span>
<span class="line_number">3397 </span>    if <span class="sign">(</span>present<span class="sign">(</span>name<span class="sign">)</span><span class="sign">)</span> me<span class="sign">%</span>name <span class="sign">=</span> trim<span class="sign">(</span>name<span class="sign">)</span>
<span class="line_number">3398 </span>
<span class="line_number">3399 </span>    end subroutine <strong>to_object</strong>
</pre>

<hr />
<a name="json5fmodule2fto5freal"></a>
<a name="robo70"></a><h2>json_module/to_real [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>to_real</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Change the variable to a double.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3271 </span>    subroutine <strong>to_real</strong><span class="sign">(</span>me<span class="sign">,</span>val<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">3272 </span>
<span class="line_number">3273 </span>    implicit none
<span class="line_number">3274 </span>
<span class="line_number">3275 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> intent<span class="sign">(</span>inout<span class="sign">)</span>        <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">3276 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional   <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">3277 </span>    real<span class="sign">(</span>wp<span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional           <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">3278 </span>
<span class="line_number">3279 </span>    <span class="sign">!</span>set type and value<span class="sign">:</span>
<span class="line_number">3280 </span>    <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> me<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3281 </span>        call me<span class="sign">%</span>data<span class="sign">%</span>destroy<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3282 </span>        me<span class="sign">%</span>data<span class="sign">%</span>var_type <span class="sign">=</span> json_real
<span class="line_number">3283 </span>        allocate<span class="sign">(</span>me<span class="sign">%</span>data<span class="sign">%</span>dbl_value<span class="sign">)</span>
<span class="line_number">3284 </span>        if <span class="sign">(</span>present<span class="sign">(</span>val<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3285 </span>            me<span class="sign">%</span>data<span class="sign">%</span>dbl_value <span class="sign">=</span> val
<span class="line_number">3286 </span>        else
<span class="line_number">3287 </span>            me<span class="sign">%</span>data<span class="sign">%</span>dbl_value <span class="sign">=</span> 0<span class="sign">.</span>0_wp    <span class="sign">!</span>default value
<span class="line_number">3288 </span>        end if
<span class="line_number">3289 </span>    <span class="sign">!</span>end associate
<span class="line_number">3290 </span>
<span class="line_number">3291 </span>    <span class="sign">!</span>name<span class="sign">:</span>
<span class="line_number">3292 </span>    if <span class="sign">(</span>present<span class="sign">(</span>name<span class="sign">)</span><span class="sign">)</span> me<span class="sign">%</span>name <span class="sign">=</span> trim<span class="sign">(</span>name<span class="sign">)</span>
<span class="line_number">3293 </span>
<span class="line_number">3294 </span>    end subroutine <strong>to_real</strong>
</pre>

<hr />
<a name="json5fmodule2fto5fstring"></a>
<a name="robo71"></a><h2>json_module/to_string [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>to_string</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Change the variable to a string.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">3311 </span>    subroutine <strong>to_string</strong><span class="sign">(</span>me<span class="sign">,</span>val<span class="sign">,</span>name<span class="sign">)</span>
<span class="line_number">3312 </span>
<span class="line_number">3313 </span>    implicit none
<span class="line_number">3314 </span>
<span class="line_number">3315 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span> intent<span class="sign">(</span>inout<span class="sign">)</span>        <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">3316 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional   <span class="sign">:</span><span class="sign">:</span> name
<span class="line_number">3317 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span><span class="sign">,</span>optional   <span class="sign">:</span><span class="sign">:</span> val
<span class="line_number">3318 </span>
<span class="line_number">3319 </span>    <span class="sign">!</span>set type and value<span class="sign">:</span>
<span class="line_number">3320 </span>    <span class="sign">!</span>associate <span class="sign">(</span>d <span class="sign">=</span><span class="sign">&gt;</span> me<span class="sign">%</span>data<span class="sign">)</span>
<span class="line_number">3321 </span>        call me<span class="sign">%</span>data<span class="sign">%</span>destroy<span class="sign">(</span><span class="sign">)</span>
<span class="line_number">3322 </span>        me<span class="sign">%</span>data<span class="sign">%</span>var_type <span class="sign">=</span> json_string
<span class="line_number">3323 </span>        if <span class="sign">(</span>present<span class="sign">(</span>val<span class="sign">)</span><span class="sign">)</span> then
<span class="line_number">3324 </span>            me<span class="sign">%</span>data<span class="sign">%</span>str_value <span class="sign">=</span> val
<span class="line_number">3325 </span>        else
<span class="line_number">3326 </span>            me<span class="sign">%</span>data<span class="sign">%</span>str_value <span class="sign">=</span> <span class="squote">''</span>    <span class="sign">!</span>default value
<span class="line_number">3327 </span>        end if
<span class="line_number">3328 </span>    <span class="sign">!</span>end associate
<span class="line_number">3329 </span>
<span class="line_number">3330 </span>    <span class="sign">!</span>name<span class="sign">:</span>
<span class="line_number">3331 </span>    if <span class="sign">(</span>present<span class="sign">(</span>name<span class="sign">)</span><span class="sign">)</span> me<span class="sign">%</span>name <span class="sign">=</span> trim<span class="sign">(</span>name<span class="sign">)</span>
<span class="line_number">3332 </span>
<span class="line_number">3333 </span>    end subroutine <strong>to_string</strong>
</pre>

<hr />
<a name="json5fmodule2fvalid5fjson5fhex"></a>
<a name="robo72"></a><h2>json_module/valid_json_hex [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>valid_json_hex</strong>
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Returns true if the string is a valid 4-digit hex string.
</pre>
<p class="item_name">EXAMPLE</p>
<pre>    <strong>valid_json_hex</strong>('0000')  !returns true
    <strong>valid_json_hex</strong>('ABC4')  !returns true    
    <strong>valid_json_hex</strong>('AB')    !returns false (&lt; 4 characters)
    <strong>valid_json_hex</strong>('WXYZ')  !returns false (invalid characters)
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 6/14/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">4044 </span>    function <strong>valid_json_hex</strong><span class="sign">(</span>str<span class="sign">)</span> result<span class="sign">(</span>valid<span class="sign">)</span>
<span class="line_number">4045 </span>
<span class="line_number">4046 </span>    implicit none
<span class="line_number">4047 </span>
<span class="line_number">4048 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> str
<span class="line_number">4049 </span>    logical <span class="sign">:</span><span class="sign">:</span> valid
<span class="line_number">4050 </span>    
<span class="line_number">4051 </span>    integer <span class="sign">:</span><span class="sign">:</span> n<span class="sign">,</span>i
<span class="line_number">4052 </span>    
<span class="line_number">4053 </span>    <span class="sign">!</span>an array of the valid hex characters<span class="sign">:</span>
<span class="line_number">4054 </span>    character<span class="sign">(</span>len<span class="sign">=</span>1<span class="sign">)</span><span class="sign">,</span>dimension<span class="sign">(</span>16<span class="sign">)</span><span class="sign">,</span>parameter <span class="sign">:</span><span class="sign">:</span> valid_chars <span class="sign">=</span> <span class="sign">&amp;</span>
<span class="line_number">4055 </span>        <span class="sign">[</span><span class="squote">'0'</span><span class="sign">,</span><span class="squote">'1'</span><span class="sign">,</span><span class="squote">'2'</span><span class="sign">,</span><span class="squote">'3'</span><span class="sign">,</span><span class="squote">'4'</span><span class="sign">,</span><span class="squote">'5'</span><span class="sign">,</span><span class="squote">'6'</span><span class="sign">,</span><span class="squote">'7'</span><span class="sign">,</span><span class="squote">'8'</span><span class="sign">,</span><span class="squote">'9'</span><span class="sign">,</span><span class="squote">'A'</span><span class="sign">,</span><span class="squote">'B'</span><span class="sign">,</span><span class="squote">'C'</span><span class="sign">,</span><span class="squote">'D'</span><span class="sign">,</span><span class="squote">'E'</span><span class="sign">,</span><span class="squote">'F'</span><span class="sign">]</span>
<span class="line_number">4056 </span>
<span class="line_number">4057 </span>    <span class="sign">!</span>initialize
<span class="line_number">4058 </span>    valid <span class="sign">=</span> <span class="sign">.</span>false<span class="sign">.</span>   
<span class="line_number">4059 </span>    
<span class="line_number">4060 </span>    <span class="sign">!</span>check all the characters in the string<span class="sign">:</span>
<span class="line_number">4061 </span>    n <span class="sign">=</span> len<span class="sign">(</span>str<span class="sign">)</span>
<span class="line_number">4062 </span>    if <span class="sign">(</span>n<span class="sign">=</span><span class="sign">=</span>4<span class="sign">)</span> then
<span class="line_number">4063 </span>        do i<span class="sign">=</span>1<span class="sign">,</span>n
<span class="line_number">4064 </span>            if <span class="sign">(</span><span class="sign">.</span>not<span class="sign">.</span> any<span class="sign">(</span>str<span class="sign">(</span>i<span class="sign">:</span>i<span class="sign">)</span><span class="sign">=</span><span class="sign">=</span>valid_chars<span class="sign">)</span><span class="sign">)</span> return
<span class="line_number">4065 </span>        end do
<span class="line_number">4066 </span>        valid <span class="sign">=</span> <span class="sign">.</span>true<span class="sign">.</span>    <span class="sign">!</span>all are in the set<span class="sign">,</span> so it is OK
<span class="line_number">4067 </span>    end if
<span class="line_number">4068 </span>
<span class="line_number">4069 </span>    end function <strong>valid_json_hex</strong>
</pre>

<hr />
<a name="json5fmodule2fvariable5finfo5fin5ffile"></a>
<a name="robo73"></a><h2>json_module/variable_info_in_file [ Functions ]</h2>

<p>[ <a href="#robo_top_of_doc">Top</a> ] [ <a href="#robo0">json_module</a> ] [ <a href="./robo_functions.html#robo_top_of_doc">Functions</a> ]</p>
<p class="item_name">NAME</p>
<pre>    <strong>variable_info_in_file</strong>
</pre>
<p class="item_name">USAGE</p>
<pre>    call me%info(path,found,var_type,n_children)
</pre>
<p class="item_name">DESCRIPTION</p>
<pre>    Returns information about a variable in a file.
</pre>
<p class="item_name">AUTHOR</p>
<pre>    Jacob Williams : 2/3/2014
</pre>
<p class="item_name">SOURCE</p>
<pre class="source"><span class="line_number">475 </span>    subroutine <strong>variable_info_in_file</strong><span class="sign">(</span>me<span class="sign">,</span>path<span class="sign">,</span>found<span class="sign">,</span>var_type<span class="sign">,</span>n_children<span class="sign">)</span>
<span class="line_number">476 </span>
<span class="line_number">477 </span>    implicit none
<span class="line_number">478 </span>
<span class="line_number">479 </span>    class<span class="sign">(</span><a href="#robo22">json_file</a><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>inout<span class="sign">)</span> <span class="sign">:</span><span class="sign">:</span> me
<span class="line_number">480 </span>    character<span class="sign">(</span>len<span class="sign">=</span><span class="sign">*</span><span class="sign">)</span><span class="sign">,</span>intent<span class="sign">(</span>in<span class="sign">)</span>    <span class="sign">:</span><span class="sign">:</span> path
<span class="line_number">481 </span>    logical<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>            <span class="sign">:</span><span class="sign">:</span> found
<span class="line_number">482 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>            <span class="sign">:</span><span class="sign">:</span> var_type
<span class="line_number">483 </span>    integer<span class="sign">,</span>intent<span class="sign">(</span>out<span class="sign">)</span>            <span class="sign">:</span><span class="sign">:</span> n_children
<span class="line_number">484 </span>
<span class="line_number">485 </span>    type<span class="sign">(</span><a href="#robo36">json_value</a><span class="sign">)</span><span class="sign">,</span>pointer <span class="sign">:</span><span class="sign">:</span> p
<span class="line_number">486 </span>
<span class="line_number">487 </span>    <span class="sign">!</span>initialize<span class="sign">:</span>
<span class="line_number">488 </span>    nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">489 </span>
<span class="line_number">490 </span>    <span class="sign">!</span>get a pointer to the variable <span class="sign">(</span>if it is there<span class="sign">)</span><span class="sign">:</span>
<span class="line_number">491 </span>    call me<span class="sign">%</span>get<span class="sign">(</span>path<span class="sign">,</span>p<span class="sign">,</span>found<span class="sign">)</span>
<span class="line_number">492 </span>
<span class="line_number">493 </span>    if <span class="sign">(</span>found<span class="sign">)</span> then
<span class="line_number">494 </span>
<span class="line_number">495 </span>        <span class="sign">!</span>get info<span class="sign">:</span>
<span class="line_number">496 </span>        call <a href="#robo33">json_info</a><span class="sign">(</span>p<span class="sign">,</span>var_type<span class="sign">,</span>n_children<span class="sign">)</span>
<span class="line_number">497 </span>
<span class="line_number">498 </span>    else
<span class="line_number">499 </span>
<span class="line_number">500 </span>        <span class="sign">!</span>set to dummy values<span class="sign">:</span>
<span class="line_number">501 </span>        var_type <span class="sign">=</span> json_unknown
<span class="line_number">502 </span>        n_children <span class="sign">=</span> 0
<span class="line_number">503 </span>
<span class="line_number">504 </span>    end if
<span class="line_number">505 </span>
<span class="line_number">506 </span>    <span class="sign">!</span>cleanup<span class="sign">:</span>
<span class="line_number">507 </span>    nullify<span class="sign">(</span>p<span class="sign">)</span>
<span class="line_number">508 </span>
<span class="line_number">509 </span>    end subroutine <strong>variable_info_in_file</strong>
</pre>

</div> <!-- content -->
<div id="footer">
<p>Generated from ./src/json_module.f90 with <a href="http://www.xs4all.nl/~rfsber/Robo/robodoc.html">ROBODoc</a> V4.99.38 on Thu Jun 19 2014 19:38:24
</p>
</div> <!-- footer -->
</body>
</html>
